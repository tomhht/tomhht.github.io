<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="GitHub, IT, ICT, å¤§æ•°æ®, Linux, Ubuntu, CentOS, äº‘è®¡ç®—, æœºå™¨å­¦ä¹ , æ·±åº¦å­¦ä¹ , Kubernetes, Docker, OpenStack">
<meta name="description" content="">
<meta name="theme-color" content="#000">
<title>Ubuntuå’ŒCentOSä¿®æ”¹grub | hello, world</title>
<link rel="shortcut icon" href="/favicon.ico?v=1600250902206">
<link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet" href="/media/css/mist.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/androidstudio.css"
  rel="stylesheet">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



  <meta name="description" content="Ubuntuå’ŒCentOSä¿®æ”¹grub" />
  <meta name="keywords" content="Linux,Grub,é…ç½®,å¼€æœº,å¯åŠ¨é¡¹,å¯åŠ¨æ—¶é—´,Ubuntu,CentOS" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">hello, world</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout mist bg-color">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper  right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active">æ–‡ç« ç›®å½•</span>
            <span id="metaSideBar" class="sidebar-title-item">ç«™ç‚¹æ¦‚è§ˆ</span>
          </div>
        </div>
      
      <div class="sidebar-body mist" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">Tom</p>
    
    <div class="site-description right-motion">
      
      
      
        <p>ç¬¬ä¸€æ¬¡æœ‰è‡ªå·±çš„åšå®¢</p>
      
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">16</span>
        <span class="site-item-stat-name">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">92</span>
        <span class="site-item-stat-name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">92</span>
        <span class="site-item-stat-name">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
  

  


</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper auto-number auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li><a href="#%E4%BF%AE%E6%94%B9%E4%BD%8D%E7%BD%AE">ä¿®æ”¹ä½ç½®</a></li>
<li><a href="#%E7%94%9F%E6%95%88%E6%96%B9%E6%B3%95">ç”Ÿæ•ˆæ–¹æ³•</a></li>
<li><a href="#troubleshooting">Troubleshooting</a>
<ul>
<li><a href="#%E6%8F%8F%E8%BF%B0">æè¿°</a></li>
<li><a href="#%E8%A7%A3%E5%86%B3">è§£å†³</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // ä¿å­˜liå…ƒç´ 
      if (elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // å¤„ç†ä¸æ˜¯ä»#ä¸€çº§æ ‡é¢˜å¼€å§‹ç›®å½•
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <header class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://tomhht.github.io/post/ubuntu-he-centos-xiu-gai-grub/">
      Ubuntuå’ŒCentOSä¿®æ”¹grub
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span>å‘å¸ƒäº</span>
      <span>2020-08-31</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show">åˆ†ç±»äº</span>
      
      
      <a href="https://tomhht.github.io/tag/mTyB0fhtc/">
        <span>Linux</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/SaVkQAc9U4/">
        <span>Grub</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/Bwz1BaTtzi/">
        <span>é…ç½®</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/SziKjUrpjt/">
        <span>å¼€æœº</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/rBmg59Vjxj/">
        <span>å¯åŠ¨é¡¹</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/cWawItHFUb/">
        <span>å¯åŠ¨æ—¶é—´</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/pelgqi16au/">
        <span>Ubuntu</span>
      </a>ã€
      
      
      
      <a href="https://tomhht.github.io/tag/qjvKbAF653/">
        <span>CentOS</span>
      </a>
      
      
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>2åˆ†é’Ÿ</span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>254<span class="pc-show">å­—æ•°</span></span>
    </span>
    
    
    
    <span id="/post/ubuntu-he-centos-xiu-gai-grub/" data-flag-title="Ubuntuå’ŒCentOSä¿®æ”¹grub" class="meta-item pc-show leancloud_visitors">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-eye"></i>
      <span>æµè§ˆé‡ï¼š<span class="leancloud-visitors-count"></span></span>
    </span>
    
  </div>
</header>
            <div class="post-body next-md-body" id="post_body">
              <p>grubçš„ä¿®æ”¹ä½ç½®å’Œç”Ÿæ•ˆæ–¹æ³•ã€‚</p>
<!-- more -->
<h1 id="ä¿®æ”¹ä½ç½®">ä¿®æ”¹ä½ç½®</h1>
<pre><code>sudo vim /etc/default/grub
</code></pre>
<h1 id="ç”Ÿæ•ˆæ–¹æ³•">ç”Ÿæ•ˆæ–¹æ³•</h1>
<pre><code>sudo grub2-mkconfig â€“o /etc/grub2.cfg  #CentOS
sudo update-grub2  #Ubuntu
</code></pre>
<h1 id="troubleshooting">Troubleshooting</h1>
<h2 id="æè¿°">æè¿°</h2>
<p>CentOSæŒ‰ä¸Šé¢æ“ä½œä¿®æ”¹<code>GRUB_TIMEOUT=0</code>åï¼Œæ— è®ºæ€æ ·éƒ½ä¸ç”Ÿæ•ˆï¼Œæ— æ³•è·³è¿‡boot menuå€’è®¡æ—¶5ç§’çš„é­”å’’ã€‚å°è¯•è¿‡<code>GRUB_TIMEOUT_STYLE=&quot;hidden&quot; GRUB_HIDDEN_TIMEOUT_QUIET=true GRUB_ENABLE_BLSCFG=false</code>ç­‰å„ç§é€‰é¡¹ï¼Œå‡æ— æ•ˆã€‚<code>sudo ls -l /boot/grub2/</code>æŸ¥çœ‹<code>grub.cfg</code>ï¼Œä¿®æ”¹æ—¶é—´çº¹ä¸æœªåŠ¨ï¼Œåˆç€ç©å„¿å‘¢ã€‚<br /></p>
<h2 id="è§£å†³">è§£å†³</h2>
<p><code>sudo vim /etc/grub2.cfg</code>å‘ç°ï¼š</p>
<pre><code> 63 if [ x$feature_timeout_style = xy ] ; then
 64   set timeout_style=menu
 65   set timeout=5
 66 # Fallback normal timeout code in case the timeout_style feature is
 67 # unavailable.
 68 else
 69   set timeout=5
 70 fi
 71 ### END /etc/grub.d/00_header ###
</code></pre>
<p>æ„Ÿè§‰é—®é¢˜å‡ºåœ¨<code>/etc/grub.d/00_header</code>ï¼Œç ”ç©¶headeråŠå¤©ï¼Œæ²¡æ‡‚ğŸ˜… <br /><br>
è€Œ<code>/etc/grub2.cfg</code>å¼€ç¯‡å°±å†™ç€<code># DO NOT EDIT THIS FILE</code>ï¼Œå¯å®åœ¨æ²¡è¾™äº†ï¼Œè¯•ç€æ”¹äº†ä¸Šé¢65è¡Œçš„timeoutï¼Œç›´æ¥æ”¹æˆ0ï¼š</p>
<pre><code>65   set timeout=0
</code></pre>
<p>ä¿å­˜é€€å‡ºé‡å¯ï¼ŒæˆåŠŸäº†ã€‚è¿™éƒ½æ˜¯ä»€ä¹ˆé¬¼ã€‚ğŸ™ƒ</p>
<hr>
<p>å‚è€ƒé“¾æ¥ï¼š<br>
<a href="https://blog.csdn.net/whatday/article/details/106123164">https://blog.csdn.net/whatday/article/details/106123164</a><br>
<a href="https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/">https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/</a></p>

            </div>
            <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
      Tom
    </li>
    <li class="post-copyright-link">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://tomhht.github.io/post/ubuntu-he-centos-xiu-gai-grub/" title="Ubuntuå’ŒCentOSä¿®æ”¹grub">https://tomhht.github.io/post/ubuntu-he-centos-xiu-gai-grub/</a>
    </li>
    <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
      æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://tomhht.github.io/tag/mTyB0fhtc/"># Linux</a>
    
      <a href="https://tomhht.github.io/tag/SaVkQAc9U4/"># Grub</a>
    
      <a href="https://tomhht.github.io/tag/Bwz1BaTtzi/"># é…ç½®</a>
    
      <a href="https://tomhht.github.io/tag/SziKjUrpjt/"># å¼€æœº</a>
    
      <a href="https://tomhht.github.io/tag/rBmg59Vjxj/"># å¯åŠ¨é¡¹</a>
    
      <a href="https://tomhht.github.io/tag/cWawItHFUb/"># å¯åŠ¨æ—¶é—´</a>
    
      <a href="https://tomhht.github.io/tag/pelgqi16au/"># Ubuntu</a>
    
      <a href="https://tomhht.github.io/tag/qjvKbAF653/"># CentOS</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="Ubuntuå’ŒCentOSç«¯å£è®¾ç½®" href="https://tomhht.github.io/post/ubuntu-he-centos-duan-kou-she-zhi/">Ubuntuå’ŒCentOSç«¯å£è®¾ç½®</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="Ubuntuå’ŒCentOSç«¯å£è®¾ç½®" href="https://tomhht.github.io/post/ubuntu-he-centos-duan-kou-she-zhi/">ä¸Šä¸€ç¯‡</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="åœ¨Ubuntu 20.04å’ŒCentOS 8ä¸Šä½¿ç”¨kubeadméƒ¨ç½²Kubernetesé›†ç¾¤" href="https://tomhht.github.io/post/zai-ubuntu-2004-shang-shi-yong-kubeadm-bu-shu-kubernetes-ji-qun/">åœ¨Ubuntu 20.04å’ŒCentOS 8ä¸Šä½¿ç”¨kubeadméƒ¨ç½²Kubernetesé›†ç¾¤</a>
        <a class="nav-mobile-next" title="åœ¨Ubuntu 20.04å’ŒCentOS 8ä¸Šä½¿ç”¨kubeadméƒ¨ç½²Kubernetesé›†ç¾¤" href="https://tomhht.github.io/post/zai-ubuntu-2004-shang-shi-yong-kubeadm-bu-shu-kubernetes-ji-qun/">ä¸‹ä¸€ç¯‡</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
            
  <script src="https://cdn.jsdelivr.net/npm/valine@1.4.4/dist/Valine.min.js"></script>
<div id="vcomments" style="padding: 10px 0px 0px 0px"></div>

<style>
  .v .veditor {
    min-height: 10rem;
    background-image: url('https://upimage.alexhchu.com/2020/04/21/47eda59424daa.gif');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: right;
    background-color: rgba(255, 255, 255, 0);
    resize: none;
  }

  .v .vwrap {
    border: 1px solid #000 !important;
  }

  .v .vbtn {
    padding: .4rem 1.2rem !important;
    border-color: #fff !important;
    background-color: #49b1f5 !important;
    color: #fff !important;
    font-size: .7rem !important;
  }

  .v .vcards .vcard .vh .vmeta .vat {
    padding: 0 .8rem !important;
    border: 1px solid #00c4b6 !important;
    border-radius: 5px !important;
    color: #00c4b6 !important;
  }
</style>
<script>
  new Valine({
    el: '#vcomments',
    appId: 'H5IdY03w9utJHHdlEjpEAh0M-gzGzoHsz',
    appKey: '7Sfj9DI3gkrM2T0LFSWIzSU1',
    avatar: '',
    placeholder: '',
    pageSize: '',
    lang: 'zh-cn',
    visitor: 'true' === 'true',
    highlight: 'true' === 'true',
    avatarForce: 'true' === 'false',
  });
</script>

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2019-2020 Theme By <a href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
  </footer>
  
  
    <div class="drawer-box left" id="drawer_box">
      <span class="muse-line muse-line-first"></span>
      <span class="muse-line muse-line-middle"></span>
      <span class="muse-line muse-line-last"></span>
    </div>
  
  <div class="mist back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
  </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'true'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }
  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

</script>
    <div class="light-box" id="light_box"></div>
<script>
  let imgs = document.querySelectorAll('.post-body img');
  let lightBox = document.querySelector('#light_box');
  lightBox.addEventListener('mousedown', (e) => {
    e.preventDefault()
  })
  lightBox.addEventListener('mousewheel', (e) => {
    e.preventDefault()
  })
  let width = window.innerWidth * 0.8;
  lightBox.onclick = () => {
    let img = lightBox.querySelector('img');
    lightBox.style = '';
    img && img.remove();
  }
  imgs.forEach(item => {
    item.onclick = function (e) {
      let lightImg = document.createElement('img');
      lightImg.src = this.src;
      lightBox.style = `height: 100%; opacity: 1; background-color: rgba(0, 0, 0, 0.5);cursor: zoom-out;`;
      lightImg.style = `width: ${width}px; border: 1px solid #fff; border-radius: 2px;`;
      lightImg.onclick = function () {
        lightBox.style = '';
        this.remove();
      }
      lightBox.append(lightImg);
    }
  })
</script>
  </div>
</body>
<input hidden id="copy" />
<script>
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })
</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 500
  });
</script>

<!-- <div class="search-mask" id="search_mask">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input type="text" placeholder="æœç´¢">
      </div>
      <i class="fa fa-times-circle"></i>
    </div>
    <div class="result">
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/gan-diao-win10-wan-gu-bu-hua-de-mou-kuai-su-fang-wen-gu-ding-xiang/"" data-c="
          &lt;p&gt;å¿«é€Ÿè®¿é—®é‡Œæœ‰ä¸ªDocumentsæ­»æ´»æ— æ³•å–æ¶ˆå›ºå®šï¼Œç‚¹äº†åˆè¯´ä¸å­˜åœ¨ï¼Œè®©åˆ åˆåˆ ä¸äº†ï¼Œleseã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;æ„Ÿè°¢å‚è€ƒé“¾æ¥çš„ä½œè€…ï¼Œè¯¥æ–¹æ³•æ•ˆè‹¥æ¡´é¼“ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„äº‹é¡¹ï¼šè¯¥æ–¹æ³•ä¼šåˆ é™¤å¿«é€Ÿè®¿é—®é‡Œçš„æ‰€æœ‰å†…å®¹ï¼Œè€ƒè™‘æ¸…æ¥šå†åŠ¨æ‰‹ã€‚ï¼ˆæˆ‘çš„æœ¬æ¥å°±åªæœ‰æˆ‘çš„ç”µè„‘å’Œçƒ¦äººçš„é‚£é¡¹ï¼Œæ‰€ä»¥æœæ–­killï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;æ‹·è´&lt;code&gt;%APPDATA%\Microsoft\Windows\Recent\AutomaticDestinations&lt;/code&gt;è‡³ è¿è¡Œ æˆ– æ–‡ä»¶å¤¹åœ°å€æ ï¼Œå›è½¦ï¼›&lt;/li&gt;
&lt;li&gt;åˆ é™¤å…¶ä¸­æ–‡ä»¶&lt;code&gt;f01b4d95cf55d32a.automaticDestinations-ms&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;DONEï¼Œæ•´ä¸ªä¸–ç•Œéƒ½æ¸…å‡€äº†ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/yin0hao/article/details/88052343&#34;&gt;Windows 10 å¿«é€Ÿè®¿é—®å¼‚å¸¸:æ— æ³•å–æ¶ˆå›ºå®š,çš„è§£å†³æ–¹æ³•&lt;/a&gt;&lt;/p&gt;
">å¹²æ‰Win10é¡½å›ºä¸åŒ–çš„æŸå¿«é€Ÿè®¿é—®å›ºå®šé¡¹</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/an-zhuang-prometheus-operator/"" data-c="
          &lt;p&gt;ä¼—æ‰€å‘¨çŸ¥çš„åŸå› æå¾—å®‰è£…èµ·æ¥å¤ªå¤æ‚äº†ï¼Œå¹¶ä¸”helmçš„prometheus operatorçš„charté¡¹ç›®è¿˜è¿ç§»è¿‡ï¼Œæ›´æœ‰ç‚¹äº‘é‡Œé›¾é‡Œã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;åˆ›å»ºä¸“ç”¨namespace&#34;&gt;åˆ›å»ºä¸“ç”¨namespace&lt;/h1&gt;
&lt;p&gt;å…ˆåˆ›å»ºä¸ªnamespaceæ¥ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create namespace monitoring
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å•ç‹¬å®‰è£…crd&#34;&gt;å•ç‹¬å®‰è£…CRD&lt;/h1&gt;
&lt;p&gt;CRDå°±æ˜¯Custom Resource Definitionã€‚&lt;br&gt;
æœ¬æ¥åº”è¯¥æ˜¯&lt;code&gt;helm install kube-prometheus-stack&lt;/code&gt;çš„æ—¶å€™å°±èƒ½è£…ï¼Œbut as you know..&lt;br&gt;
é€šè¿‡ç§‘å­¦ä¸Šç½‘ï¼Œå…ˆä¸‹è½½yamlå†è¯´ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# æ•´é½ç‚¹å„¿
mkdir -p ~/helm/prometheus-operator
cd ~/helm/prometheus-operator

# ä¸‹è½½yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_alertmanagers.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_podmonitors.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_probes.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_prometheuses.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_prometheusrules.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_servicemonitors.yaml
curl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_thanosrulers.yaml

# å®‰è£…
kubectl apply -f .
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å®‰è£…-kube-prometheus-stack&#34;&gt;å®‰è£… kube-prometheus-stack&lt;/h1&gt;
&lt;p&gt;kube-prometheus-stackåŸºäºprometheus-operatoråˆ¶ä½œï¼Œå¹¶é›†æˆäº†ä¾èµ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stable/kube-state-metrics&lt;/li&gt;
&lt;li&gt;stable/prometheus-node-exporter&lt;/li&gt;
&lt;li&gt;grafana/grafana&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# å®‰è£…
helm install kube-prometheus-stack prometheus-community/kube-prometheus-stack --set prometheusOperator.createCustomResource=false -n monitoring
# æŸ¥çœ‹å®‰è£…æƒ…å†µ
kubectl -n monitoring get deployments
NAME                                       READY   UP-TO-DATE   AVAILABLE   AGE
kube-prometheus-stack-grafana              1/1     1            1           4h30m
kube-prometheus-stack-kube-state-metrics   1/1     1            1           4h30m
kube-prometheus-stack-operator             1/1     1            1           4h30m

kubectl -n monitoring get pods -owide
NAME                                                        READY   STATUS    RESTARTS   AGE     IP                NODE           NOMINATED NODE   READINESS GATES
alertmanager-kube-prometheus-stack-alertmanager-0           2/2     Running   2          4h14m   10.244.1.32       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-grafana-8b85d667c-5w8sn               2/2     Running   4          4h32m   10.244.2.23       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-kube-state-metrics-5cf575d8f8-6m7jt   1/1     Running   1          4h32m   10.244.1.33       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-operator-65fbd96bdb-9zhmz             2/2     Running   6          4h32m   10.244.2.21       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-68sxv        1/1     Running   2          4h32m   192.168.127.133   mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-864w9        1/1     Running   1          4h32m   192.168.127.132   ubuntuserver   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-nr274        1/1     Running   1          4h32m   192.168.127.134   mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
prometheus-kube-prometheus-stack-prometheus-0               3/3     Running   6          4h14m   10.244.2.22       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;é‡åˆ°é—®é¢˜å¾€åçœ‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;å®‰è£…è¿‡ç¨‹çš„troubleshooting&#34;&gt;å®‰è£…è¿‡ç¨‹çš„Troubleshooting&lt;/h1&gt;
&lt;p&gt;å®‰è£…è¿‡ç¨‹å„ç§æŠ¥é”™ï¼Œå½“ç„¶ä¸»è¦æ˜¯é•œåƒpullä¸ä¸‹æ¥ï¼Œå°¤å…¶æ˜¯&lt;code&gt;quay.io&lt;/code&gt;çš„é•œåƒã€‚(æˆ‘çš„æŒºå¥‡æ€ªï¼Œå±…ç„¶è‡ªå·±pullæˆåŠŸäº†å‡ ä¸ª&lt;code&gt;quay.io&lt;/code&gt;)&lt;/p&gt;
&lt;h2 id=&#34;æ’æŸ¥é—®é¢˜&#34;&gt;æ’æŸ¥é—®é¢˜&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring describe pods prometheus-kube-prometheus-stack-prometheus-0

Events:
  Type     Reason   Age                    From                  Message
  ----     ------   ----                   ----                  -------
  Normal   Pulling  60m (x4 over 83m)      kubelet, mini-centos  Pulling image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot;
  Warning  Failed   58m (x4 over 79m)      kubelet, mini-centos  Failed to pull image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot;: rpc error: code = Unknown desc = context canceled
  Warning  Failed   58m (x4 over 79m)      kubelet, mini-centos  Error: ErrImagePull
  Normal   Pulling  58m (x5 over 100m)     kubelet, mini-centos  Pulling image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;
  Normal   Pulled   47m                    kubelet, mini-centos  Successfully pulled image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot; in 1m11.597994512s
  Warning  Failed   22m (x11 over 83m)     kubelet, mini-centos  Error: ErrImagePull
  Normal   BackOff  13m (x130 over 56m)    kubelet, mini-centos  Back-off pulling image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;
  Warning  Failed   8m15s (x145 over 56m)  kubelet, mini-centos  Error: ImagePullBackOff
  Warning  Failed   3m13s (x14 over 83m)   kubelet, mini-centos  Failed to pull image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;: rpc error: code = Unknown desc = context canceled
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è§£å†³&#34;&gt;è§£å†³&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;google prometheus v2.18.2&lt;/code&gt;å±…ç„¶å‘ç°&lt;code&gt;docker hub&lt;/code&gt;é‡Œæœ‰ï¼Œäºæ˜¯åœ¨&lt;code&gt;mini-centos&lt;/code&gt;ä¸»æœºä¸Šï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker pull prom/prometheus:v2.18.2
v2.18.2: Pulling from prom/prometheus
0f8c40e1270f: Already exists 
626a2a3fee8c: Already exists 
dde61fbb486b: Already exists 
22b936665674: Downloading [=================================================&amp;gt; ]  20.66MB/20.76MB
b9cb37b79bc0: Download complete 
a14008f52cd5: Download complete 
c89901a55493: Waiting 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°±å®šè¿™å„¿äº†ï¼Œé‚ç¥­èµ·é‡å¯dockerå¤§æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡å¯å®Œåï¼Œæ¥ç€ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker pull prom/prometheus:v2.18.2
v2.18.2: Pulling from prom/prometheus
0f8c40e1270f: Already exists 
626a2a3fee8c: Already exists 
dde61fbb486b: Already exists 
22b936665674: Pull complete 
b9cb37b79bc0: Pull complete 
a14008f52cd5: Pull complete 
c89901a55493: Pull complete 
6caddd047c54: Pull complete 
ddd1779460e5: Pull complete 
f65cc1a7f25d: Pull complete 
4be7bc9429a7: Pull complete 
2d296d78b122: Pull complete 
Digest: sha256:4d3303d1eb424e345cf48969bb7575d4d58472ad783ac41ea07fba92686f7ef5
Status: Downloaded newer image for prom/prometheus:v2.18.2
docker.io/prom/prometheus:v2.18.2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†æ£€æŸ¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get pods -owide
NAME                                                        READY   STATUS    RESTARTS   AGE     IP                NODE           NOMINATED NODE   READINESS GATES
alertmanager-kube-prometheus-stack-alertmanager-0           2/2     Running   2          4h14m   10.244.1.32       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-grafana-8b85d667c-5w8sn               2/2     Running   4          4h32m   10.244.2.23       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-kube-state-metrics-5cf575d8f8-6m7jt   1/1     Running   1          4h32m   10.244.1.33       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-operator-65fbd96bdb-9zhmz             2/2     Running   6          4h32m   10.244.2.21       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-68sxv        1/1     Running   2          4h32m   192.168.127.133   mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-864w9        1/1     Running   1          4h32m   192.168.127.132   ubuntuserver   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
kube-prometheus-stack-prometheus-node-exporter-nr274        1/1     Running   1          4h32m   192.168.127.134   mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
prometheus-kube-prometheus-stack-prometheus-0               3/3     Running   6          4h14m   10.244.2.22       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¨éƒ½readyäº†ã€‚&lt;br&gt;
å¦‚æœ‰å…¶ä»–pullé—®é¢˜ï¼Œåº”è¯¥å¯ä»¥å¦‚æ³•ç‚®åˆ¶ã€‚&lt;/p&gt;
&lt;h1 id=&#34;æš´éœ²æœåŠ¡&#34;&gt;æš´éœ²æœåŠ¡&lt;/h1&gt;
&lt;h2 id=&#34;æŸ¥çœ‹æœåŠ¡&#34;&gt;æŸ¥çœ‹æœåŠ¡&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get svc
NAME                                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
alertmanager-operated                            ClusterIP   None             &amp;lt;none&amp;gt;        9093/TCP,9094/TCP,9094/UDP   4h16m
kube-prometheus-stack-alertmanager               ClusterIP   10.101.245.140   &amp;lt;none&amp;gt;        9093/TCP                     4h34m
kube-prometheus-stack-grafana                    ClusterIP   10.106.193.98    &amp;lt;none&amp;gt;        80/TCP                       4h34m
kube-prometheus-stack-kube-state-metrics         ClusterIP   10.108.208.70    &amp;lt;none&amp;gt;        8080/TCP                     4h34m
kube-prometheus-stack-operator                   ClusterIP   10.110.217.187   &amp;lt;none&amp;gt;        8080/TCP,443/TCP             4h34m
kube-prometheus-stack-prometheus                 ClusterIP   10.104.189.224   &amp;lt;none&amp;gt;        9090/TCP                     4h34m
kube-prometheus-stack-prometheus-node-exporter   ClusterIP   10.102.189.12    &amp;lt;none&amp;gt;        9100/TCP                     4h34m
prometheus-operated                              ClusterIP   None             &amp;lt;none&amp;gt;        9090/TCP                     4h16m
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ”¹nodeport&#34;&gt;æ”¹NodePort&lt;/h2&gt;
&lt;p&gt;æŠŠä¸‹é¢æœåŠ¡çš„typeæ”¹æˆNodePortï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring edit svc kube-prometheus-stack-prometheus
kubectl -n monitoring edit svc kube-prometheus-stack-alertmanager
kubectl -n monitoring edit svc kube-prometheus-stack-grafana

kubectl -n monitoring get svc
NAME                                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
alertmanager-operated                            ClusterIP   None             &amp;lt;none&amp;gt;        9093/TCP,9094/TCP,9094/UDP   4h51m
kube-prometheus-stack-alertmanager               NodePort    10.101.245.140   &amp;lt;none&amp;gt;        9093:31386/TCP               5h9m
kube-prometheus-stack-grafana                    NodePort    10.106.193.98    &amp;lt;none&amp;gt;        80:30835/TCP                 5h9m
kube-prometheus-stack-kube-state-metrics         ClusterIP   10.108.208.70    &amp;lt;none&amp;gt;        8080/TCP                     5h9m
kube-prometheus-stack-operator                   ClusterIP   10.110.217.187   &amp;lt;none&amp;gt;        8080/TCP,443/TCP             5h9m
kube-prometheus-stack-prometheus                 NodePort    10.104.189.224   &amp;lt;none&amp;gt;        9090:30098/TCP               5h9m
kube-prometheus-stack-prometheus-node-exporter   ClusterIP   10.102.189.12    &amp;lt;none&amp;gt;        9100/TCP                     5h9m
prometheus-operated                              ClusterIP   None             &amp;lt;none&amp;gt;        9090/TCP                     4h51m
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;è®¿é—®prometheus&#34;&gt;è®¿é—®prometheus&lt;/h1&gt;
&lt;p&gt;æ‰“å¼€http://192.168.127.132:30098/targetsï¼Œä¸€éƒ¨åˆ†upä¸€éƒ¨åˆ†downï¼Œç‚¹Unhealthy&lt;br&gt;
&lt;img src=&#34;https://tomhht.github.io/post-images/1600245194725.png&#34; alt=&#34;unhealthy&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³downçš„éƒ¨åˆ†&#34;&gt;è§£å†³downçš„éƒ¨åˆ†&lt;/h2&gt;
&lt;h3 id=&#34;etcdçš„down&#34;&gt;etcdçš„down&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æäº†1.5å¤©ï¼Œæœåˆ°çš„å„ç§èµ„æ–™éƒ½æ— æ³•é€‚ç”¨ï¼Œç»“åˆå„å®¶ä¹‹è¨€ï¼Œå†æ— æ•°æ¬¡å°è¯•æ‰å‹‰å¼ºæœ‰ç»“æœã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/etcd.yaml
# æ‰¾åˆ°
- --listen-client-urls=https://127.0.0.1:2379,https://192.168.127.132:2379
# ä¿®æ”¹ä¸º
- --listen-client-urls=https://0.0.0.0:2379,http://0.0.0.0:2379
# é‡å¯å…¨éƒ¨containerï¼ˆå®é™…ä¸Šæ˜¯åœæ­¢å‘½ä»¤ï¼Œk8sä¼šè‡ªåŠ¨å…¨éƒ¨å¯åŠ¨ï¼‰
docker stop $(docker ps -q)
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;æŒºå¥‡è‘©çš„ä¸€ç‚¹æ˜¯ï¼Œdownå˜ä¸ºupåï¼Œæˆ‘åˆæ”¹å›åŸé…ç½®ï¼Œå†é‡å¯å…¨éƒ¨containerï¼Œä¾ç„¶ä¿æŒupçŠ¶æ€ï¼Œå­˜ç–‘ingã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;kube-schedulerçš„down&#34;&gt;kube-schedulerçš„down&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/kube-scheduler.yaml
//æ”¹ä¸º- --bind-address=0.0.0.0
//åˆ è¡Œ- --port=0
//ç¨ç­‰å‡ ç§’å³å¯
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªè¦ç‰¹åˆ«æ„Ÿè°¢åº¦å¨˜å¸®æˆ‘æœåˆ°çš„&lt;a href=&#34;https://llovewxm1314.blog.csdn.net/article/details/108458197&#34;&gt;è§£å†³kubernetes:v1.18.6-1.19.0 get cs127.0.0.1 connection refusedé”™è¯¯&lt;/a&gt;ã€‚ä¸€ä¸ªportä½ è¯´ä½ é»˜è®¤ç­‰äº0å¹²å•¥ï¼Œä½ è‡ªå·±éƒ½unhealthyä½ è¯´prometheuså“ªå„¿èƒ½ç›‘æ§å¾—åˆ°ã€‚æ„Ÿè°¢åŸä½œè€…ï¼Œnä¸ªå°æ—¶åç»ˆäºç ´æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;kube-controller-managerçš„down&#34;&gt;kube-controller-managerçš„down&lt;/h3&gt;
&lt;p&gt;ä¿®æ”¹å¥—è·¯åŒkube-schedulerã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/kube-controller-manager.yaml
//æ”¹ä¸º- --bind-address=0.0.0.0
//åˆ è¡Œ- --port=0
//ç¨ç­‰å‡ ç§’å³å¯
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;node-exporterçš„down&#34;&gt;node-exporterçš„down&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring edit ds kube-prometheus-stack-prometheus-node-exporter
//åˆ æ‰ hostNetwork: true ä¸€è¡Œ
//ç¨ç­‰å‡ ç§’å³å¯
//è¿˜æ²¡å°è¯•helmç»™å‚æ•°çš„æ–¹å¼ï¼Œæœ‰æœºä¼šè¯•è¯•override the hostNetwork setting using a values file with -f option
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;ç‰¹åˆ«æ„Ÿè°¢googleæ¥çš„&lt;a href=&#34;https://vividcode.io/fix-context-deadline-exceeded-error-in-prometheus-operator/&#34;&gt;Fix Context Deadline Exceeded Error in Prometheus Operator&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;kube-proxyçš„downå°šæœªæå®š&#34;&gt;kube-proxyçš„downï¼ˆå°šæœªæå®šï¼‰&lt;/h3&gt;
&lt;p&gt;æš‚æ—¶è·³è¿‡ï¼Œå¿«å´©æºƒäº†ï¼ˆäººï¼‰ï¼Œä¸‹é¢çš„æ–¹æ³•ç”¨äº†æ ¹æœ¬ä¸è¡Œï¼Œgoogle bing baidué½ä¸Šé˜µï¼Œå‰å‰ååå¾—æäº†1å¤©ã€‚å¥½å¿ƒçš„å“ªä½ï¼Œè¯·å¸®å¿™ç•™è¨€æä¾›è§£å†³åŠæ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å¯èƒ½ç”¨å¾—åˆ°çš„æŒ‡ä»¤
kubectl -n kube-system edit cm kube-proxy  //æ”¹metricsBindAddress: ä¸º 0.0.0.0:10249
kubectl delete pod -l k8s-app=kube-proxy -n kube-system
// æŒ‰ä¸Šé¢çš„æ“ä½œï¼Œå®Œå…¨æ²¡æ•ˆæœï¼Œæ™•
sudo netstat -ntlp | grep kube
sudo ss -ntlp | grep kube
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ç¬¬ä¸€ä¸ªå¼€å§‹æçš„ï¼Œç»“æœå…¶ä»–éƒ½æå®šäº†ï¼Œå®ƒè¿˜å²¿ç„¶ä¸åŠ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;grafanaç¯‡ç« &#34;&gt;Grafanaç¯‡ç« &lt;/h1&gt;
&lt;p&gt;kube-prometheus-stacké‡Œå·²ç»è‡ªå¸¦Grafanaï¼Œå› æ­¤æ— éœ€å®‰è£…ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è®¿é—®grafana&#34;&gt;è®¿é—®grafana&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get svc //æ‰¾åˆ°grafanaçš„ç«¯å£ï¼Œç„¶åæµè§ˆå™¨è®¿é—®http://IP:PORT
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ç”¨æˆ·å/å¯†ç æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;br&gt;
ä¸€å †è¯´&lt;code&gt;admin/admin&lt;/code&gt;çš„ï¼Œç„¶è€Œè¿™ä¸ªç¯å¢ƒä¸é€‚ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ç”¨æˆ·åï¼šadmin
å¯†ç ï¼šprom-operator
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;ç‰¹åˆ«æ„Ÿè°¢&lt;a href=&#34;https://devstack.in/2020/05/25/deploy-prometheus-operator-with-helm3-and-private-registry/&#34;&gt;Deploy Prometheus Operator with Helm3 and Private Registry&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ¼‚äº®&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://tomhht.github.io/post-images/1600249518889.png&#34; alt=&#34;UI&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;strong&gt;åœ¨Manageé‡Œéšä¾¿é€‰ä¸€ä¸ª&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://tomhht.github.io/post-images/1600250887179.png&#34; alt=&#34;magic&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://tomhht.github.io/post-images/1600249787073.png&#34; alt=&#34;gorgeous&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack&#34;&gt;https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/prometheus-operator/prometheus-operator&#34;&gt;https://github.com/prometheus-operator/prometheus-operator&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/prometheus-operator/kube-prometheus&#34;&gt;https://github.com/prometheus-operator/kube-prometheus&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.bookstack.cn/read/kubernetes-learning-0.2.0/docs-58.Prometheus%20Operator.md&#34;&gt;https://www.bookstack.cn/read/kubernetes-learning-0.2.0/docs-58.Prometheus%20Operator.md&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.qikqiak.com/post/prometheus-operator-monitor-etcd/&#34;&gt;https://www.qikqiak.com/post/prometheus-operator-monitor-etcd/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.fleeto.us/post/node-downtime/&#34;&gt;https://blog.fleeto.us/post/node-downtime/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://llovewxm1314.blog.csdn.net/article/details/108458197&#34;&gt;è§£å†³kubernetes:v1.18.6-1.19.0 get cs127.0.0.1 connection refusedé”™è¯¯&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://vividcode.io/fix-context-deadline-exceeded-error-in-prometheus-operator/&#34;&gt;Fix Context Deadline Exceeded Error in Prometheus Operator&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://devstack.in/2020/05/25/deploy-prometheus-operator-with-helm3-and-private-registry/&#34;&gt;Deploy Prometheus Operator with Helm3 and Private Registry&lt;/a&gt;&lt;br&gt;
ç¨åé˜…è¯»ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.qikqiak.com/post/k8s-hpa-usage/&#34;&gt;Kubernetes HPA ä½¿ç”¨è¯¦è§£&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.51cto.com/14143894/2438026&#34;&gt;Kubernetesè¿ç»´ä¹‹ä½¿ç”¨Prometheuså…¨æ–¹ä½ç›‘æ§K8S&lt;/a&gt;&lt;/p&gt;
">helmå®‰è£…kube-prometheus-stack</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/zui-xiao-hua-an-zhuang-centos-hou-de-she-zhi/"" data-c="
          &lt;p&gt;æœ€å°åŒ–å®‰è£…centos 8åçš„è®¾ç½®ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;æ›´æ¢å›½å†…æº&#34;&gt;æ›´æ¢å›½å†…æº&lt;/h1&gt;
&lt;p&gt;å‚è€ƒ&lt;a href=&#34;/post/pei-zhi-ubuntu-he-centos-qing-hua-yuan&#34;&gt;é…ç½®æ¸…åæº&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;å®‰è£…epel&#34;&gt;å®‰è£…epel&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo yum install epel-release
# æ›´æ¢æ¸…åæº
sudo sed -e &#39;s!^metalink=!#metalink=!g&#39; \
    -e &#39;s!^#baseurl=!baseurl=!g&#39; \
    -e &#39;s!//download\.fedoraproject\.org/pub!//mirrors.tuna.tsinghua.edu.cn!g&#39; \
    -e &#39;s!http://mirrors\.tuna!https://mirrors.tuna!g&#39; \
    -i /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel-testing.repo
sudo yum makecache
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ›´æ–°è½¯ä»¶&#34;&gt;æ›´æ–°è½¯ä»¶&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;yum check-update
sudo yum upgrade
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;è®¾ç½®æ—¶åŒºå’Œntp&#34;&gt;è®¾ç½®æ—¶åŒºå’ŒNTP&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;timedatectl set-timezone Asia/Shanghai
sudo yum install chrony
sudo systemctl enable --now chronyd
timedatectl status
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;è‡ªåŠ¨è¡¥å…¨&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo yum install bash-completion
source ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å®‰è£…wget&#34;&gt;å®‰è£…wget&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo yum -y install wget
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å…¶ä»–æœ‰ç”¨çš„è®°å½•&#34;&gt;å…¶ä»–æœ‰ç”¨çš„è®°å½•&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;# æ‰¾ç¨‹åºæ‰€å±çš„åŒ…
yum whatprovides netstat
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/fengdejiyixx/p/11592417.html&#34;&gt;Centoså’ŒUbuntuç³»ç»Ÿæœ€å°åŒ–å®‰è£…åŸºç¡€å‘½ä»¤&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://linuxconfig.org/ubuntu-20-04-server-installation&#34;&gt;Ubuntu 20.04 Server Installation&lt;/a&gt;&lt;/p&gt;
">æœ€å°åŒ–å®‰è£…centoså’Œubuntuä¹‹åçš„é…ç½®</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/shi-yong-virsh-shan-chu-kvm-xu-ni-ji/"" data-c="
          &lt;p&gt;å‘ç°libvirt/imagesä¸‹æœ‰ä¸ªqcow2æ–‡ä»¶æŒºå¤§ï¼Œäºæ˜¯æƒ³ç”¨virshå®‰å…¨åˆ æ‰ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;åˆ—å‡ºè™šæ‹Ÿæœº&#34;&gt;åˆ—å‡ºè™šæ‹Ÿæœº&lt;/h1&gt;
&lt;p&gt;å¼€å§‹æ²¡ç”¨sudoï¼Œç»“æœå•¥éƒ½æ²¡æœ‰ï¼Œæ˜æ˜è®°å¾—ä¹‹å‰æè¿‡ä¿©å‘¢ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo virsh list --all
 Id    Name                           State
----------------------------------------------------
 -     vm1                            shut off
 -     vm2                            shut off
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ£€æŸ¥è™šæ‹Ÿæœºé…ç½®&#34;&gt;æ£€æŸ¥è™šæ‹Ÿæœºé…ç½®&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo virsh dumpxml vm1 | grep &#39;source file&#39;
    &amp;lt;source file=&#39;/var/lib/libvirt/images/cirros-0.5.1-x86_64-disk.img&#39;/&amp;gt;
    &amp;lt;source file=&#39;/var/lib/libvirt/images/vm1.qcow2&#39;/&amp;gt; #è¦åˆ è¿™ä¸ª
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ç¼–è¾‘é…ç½®&#34;&gt;ç¼–è¾‘é…ç½®&lt;/h1&gt;
&lt;p&gt;ç¡®ä¿è¯¥è™šæ‹Ÿæœºæœªè¿è¡Œã€‚åˆ é™¤é…ç½®ä¸­æŒ‚è½½&lt;code&gt;vm1.qcow2&lt;/code&gt;çš„æ®µè½ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo virsh edit vm1
# åˆ é™¤è¿™æ®µ
    &amp;lt;disk type=&#39;file&#39; device=&#39;disk&#39;&amp;gt;
      &amp;lt;driver name=&#39;qemu&#39; type=&#39;qcow2&#39;/&amp;gt;
      &amp;lt;source file=&#39;/var/lib/libvirt/images/vm1.qcow2&#39;/&amp;gt;
      &amp;lt;target dev=&#39;hda&#39; bus=&#39;ide&#39;/&amp;gt;
      &amp;lt;address type=&#39;drive&#39; controller=&#39;0&#39; bus=&#39;0&#39; target=&#39;0&#39; unit=&#39;1&#39;/&amp;gt;
    &amp;lt;/disk&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;åˆ é™¤æ–‡ä»¶&#34;&gt;åˆ é™¤æ–‡ä»¶&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo rm /var/lib/libvirt/images/vm1.qcow2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æå®šã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://huataihuang.gitbooks.io/cloud-atlas/content/virtual/kvm/startup/in_action/delete_a_running_vm_on_kvm.html&#34;&gt;ä½¿ç”¨virshåˆ é™¤è¿è¡Œçš„KVM VM Â· Cloud Atlas&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/5111134452a8&#34;&gt;KVMç£ç›˜æ‰©å®¹å’Œæ·»åŠ &lt;/a&gt;&lt;/p&gt;
">ä½¿ç”¨virshåˆ é™¤kvmè™šæ‹Ÿæœº</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/zai-ubuntu-shang-yong-snap-an-zhuang-helm/"" data-c="
          &lt;p&gt;å‘½ä»¤æŒºç®€å•ï¼Œå°±æ˜¯é€Ÿåº¦å¾ˆæ„Ÿäººã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo snap install helm --classic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£…è¿‡æ…¢çš„è§£å†³åŠæ³•è¿˜æ²¡å°è¯•ï¼Œå‚è€ƒé“¾æ¥å…ˆè®°å½•ä¸‹æ¥äº†ï¼Œå…ˆè°¢è°¢åŸä½œè€…ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ®å®˜æ–¹è¯´æ˜ï¼ŒHelm 3å·²ç»ä¸éœ€è¦Tilleräº†ï¼Œæ‰€ä»¥å…¶ä»–å‚è€ƒèµ„æ–™ä¸Šå®‰è£…Tillerçš„æ­¥éª¤ç›´æ¥è·³è¿‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;é…ç½®&#34;&gt;é…ç½®&lt;/h1&gt;
&lt;h2 id=&#34;è‡ªåŠ¨è¡¥å…¨&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;echo &#39;source &amp;lt;(helm completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc
source ~/.bashrc #ä½¿é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://helm.sh/&#34;&gt;Helmå®˜æ–¹&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://kuricat.com/gist/snap-install-too-slow-zmbjy&#34;&gt;snap install è¿‡æ…¢ çš„è§£å†³æ–¹æ³• @Kurisu&lt;/a&gt;&lt;/p&gt;
">åœ¨Ubuntuä¸Šç”¨snapå®‰è£…Helm</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/pei-zhi-nfs/"" data-c="
          &lt;p&gt;å­¦ä¹ nfsçš„é…ç½®ï¼Œå¹¶æµ‹è¯•k8séƒ¨ç½²mysqlæŒ‚è½½nfsçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;é…ç½®nfs&#34;&gt;é…ç½®nfs&lt;/h1&gt;
&lt;h2 id=&#34;ubuntu&#34;&gt;Ubuntu&lt;/h2&gt;
&lt;p&gt;å…ˆå°†å‚è€ƒé“¾æ¥æ”¾è¿™å„¿ã€‚&lt;a href=&#34;https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-20-04&#34;&gt;How To Set Up an NFS Mount on Ubuntu 20.04&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;centos&#34;&gt;CentOS&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://qizhanming.com/blog/2018/08/08/how-to-install-nfs-on-centos-7&#34;&gt;CentOS 7 ä¸‹ yum å®‰è£…å’Œé…ç½® NFS&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;k8sæµ‹è¯•é‡åˆ°çš„é—®é¢˜&#34;&gt;k8sæµ‹è¯•é‡åˆ°çš„é—®é¢˜&lt;/h1&gt;
&lt;h2 id=&#34;é•œåƒpullä¸ä¸‹æ¥&#34;&gt;é•œåƒpullä¸ä¸‹æ¥&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜æè¿°&lt;/strong&gt;&lt;br&gt;
æµ‹è¯•mysqlæŒ‚è½½nfså¤±è´¥äº†næ¬¡ï¼Œä¸€å¼€å§‹æ˜¯é•œåƒpullä¸ä¸‹æ¥ã€‚&lt;br&gt;
&lt;strong&gt;è§£å†³&lt;/strong&gt;&lt;br&gt;
åæ¥æ·»åŠ é˜¿é‡Œäº‘åŠ é€Ÿå™¨åé‡å¯nodeä¸Šçš„docker &lt;code&gt;sudo systemctl restart docker.service&lt;/code&gt;è§£å†³äº†pullçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;podé‡åˆ°backoffçš„é”™è¯¯&#34;&gt;podé‡åˆ°backoffçš„é”™è¯¯&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜æè¿°&lt;/strong&gt;&lt;br&gt;
pullä¸‹æ¥äº†è¿˜æ˜¯è¿è¡Œå¤±è´¥ï¼Œpodæ€»æ˜¯æ˜¾ç¤ºbackoff &lt;code&gt;Back-off restarting failed container&lt;/code&gt;çš„é”™è¯¯ï¼Œé€šè¿‡&lt;code&gt;kubectl logs &amp;lt;mysql podçš„åå­—&amp;gt;&lt;/code&gt;å‘ç°&lt;code&gt;chown: changing ownership of &#39;/var/lib/mysql/&#39;: Operation not permitted&lt;/code&gt;é”™è¯¯ã€‚&lt;br&gt;
&lt;strong&gt;è§£å†³&lt;/strong&gt;&lt;br&gt;
nfsé…ç½®æ–‡ä»¶&lt;code&gt;/etc/exports&lt;/code&gt;é‡Œï¼ŒåŠ ä¸Šäº†&lt;code&gt;no_root_squash&lt;/code&gt;çš„é€‰é¡¹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-20-04&#34;&gt;How To Set Up an NFS Mount on Ubuntu 20.04&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://qizhanming.com/blog/2018/08/08/how-to-install-nfs-on-centos-7&#34;&gt;CentOS 7 ä¸‹ yum å®‰è£…å’Œé…ç½® NFS&lt;/a&gt;&lt;/p&gt;
">k8sæµ‹è¯•mysqlæŒ‚è½½nfsé‡åˆ°çš„é—®é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/kubernetes-busybox-nslookup-ti-shi-wu-fa-jie-xi-de-wen-ti/"" data-c="
          &lt;p&gt;ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬çš„busyboxä¼šå‡ºç°nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜ã€‚ä½¿ç”¨1.28.3ç‰ˆæœ¬å³å¯è§£å†³ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;ç—‡çŠ¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl run busybox --rm -it --image=busybox /bin/sh
/ # nslookup httpd-svc
Server:		10.96.0.10
Address:	10.96.0.10:53

** server can&#39;t find httpd-svc.default.svc.cluster.local: NXDOMAIN

*** Can&#39;t find httpd-svc.svc.cluster.local: No answer
*** Can&#39;t find httpd-svc.cluster.local: No answer
*** Can&#39;t find httpd-svc.default.svc.cluster.local: No answer
*** Can&#39;t find httpd-svc.svc.cluster.local: No answer
*** Can&#39;t find httpd-svc.cluster.local: No answer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£å†³ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl run busybox --rm -it --image=busybox:1.28.3 /bin/sh
If you don&#39;t see a command prompt, try pressing enter.
/ # nslookup httpd-svc
Server:    10.96.0.10
Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local

Name:      httpd-svc
Address 1: 10.108.142.200 httpd-svc.default.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/vincenshen/p/9751193.html&#34;&gt;https://www.cnblogs.com/vincenshen/p/9751193.html&lt;/a&gt;&lt;/p&gt;
">Kubernetes busybox nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/di-yi-ci-zheng-shi-kai-che/"" data-c="
          &lt;p&gt;æ‹¿äº†æœ¬å¤§åŠå¹´äº†ï¼Œæ˜¨å¤©ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;å¤ªåˆºæ¿€äº†ã€‚ç”»é¾™ã€å‰è¹­ã€æ²¹åˆç¦»é—¨ï¼Œåº”æœ‰å°½æœ‰ã€‚ç§‘ä¸‰è€ƒäº†3æ¬¡æ‰è¿‡ï¼Œè€ƒè¿‡åæŠ½å¥–ä¸­äº†ä¸€ä¸ªé™ªç»ƒæœºä¼šï¼Œè·Ÿç€æ•™ç»ƒå¼€äº†è¶Ÿæ˜“å¿ï¼ˆåŒç»ƒçš„è¿˜æœ‰å…¶ä»–å­¦å‘˜ï¼‰ã€‚è¿™å°±æ˜¯ä¹‹å‰å…¨éƒ¨çš„å¼€è½¦ç»å†äº†ã€‚&lt;br /&gt;&lt;br&gt;
æ˜¨å¤©å› ä¸ºè¦æ¥ä¾„å­ï¼Œå­¦æ ¡åœ¨ä¸€ä¸ªé¸Ÿä¸æ‹‰å±çš„åœ°æ–¹ï¼Œçº¦ä¸åˆ°è½¦ï¼Œæ‰€ä»¥ç¡¬ç€å¤´çš®æŠŠå®¶é‡Œçš„è½¦å¼€å‡ºæ¥äº†ã€‚é¦–å…ˆæ‰¾åœ°æ–¹æ‰å¤´ï¼Œå…‰é¡¾ç€çœ‹åé¢ï¼Œç»“æœè½¦å¤´è¹­äººå®¶å¢™ä¸Šäº†ï¼Œå¼•å¾—äººå®¶å‡ºæ¥æ£€æŸ¥ã€‚&lt;br /&gt;&lt;br&gt;
å¥½ä¸å®¹æ˜“æ‰å¥½å¤´ï¼Œè·Ÿåˆ«çš„è½¦äº¤æ±‡ï¼Œä¸€é—ªèº²ï¼Œå™Œï¼Œåˆæ˜¯ä¸€å£°ï¼Œä¹‹å‰å·¦è¾¹ï¼Œè¿™æ¬¡å³è¾¹ã€‚&lt;br /&gt;&lt;br&gt;
ç»§ç»­å‰è¡Œï¼Œåæ¥æƒ³æƒ³ï¼Œå±…ç„¶å½“æ—¶å¿ƒæ€æ²¡å´©ã€‚&lt;br /&gt;&lt;br&gt;
ç”»é¾™å‰è¡Œï¼Œå¿—ç²å§å§å¿½ç„¶æ¥ä¸€å¥å³è½¬ç«‹åˆ»å·¦è½¬ï¼Œæˆ‘è¿™è·¯å£åˆ°åº•æ€ä¹ˆèµ°å•Šï¼Œé‚å†³å®šç›´æ¥å·¦è½¬ï¼Œè¿›äº†å·¦è½¬è½¦é“ç­‰çº¢ç¯ï¼Œå‘ç°å³è½¬åèµ°10ç±³æœç„¶æœ‰å·¦è½¬è·¯ï¼ŒWTFã€‚å·¦è½¬è½¦é“ç¡¬ç€å¤´çš®å·¦è½¬å®Œäº†ï¼Œç»ˆäºæ‰¾åˆ°ä¸€ä¸ªè·¯å£ç›´æ¥æ‰å¤´ï¼Œèµ°ä¸Šäº†åº·åº„å¤§é“ã€‚&lt;br /&gt;&lt;br&gt;
è½¬å®Œäº†çªç„¶é“è·¯å®½é˜”äº†èµ·æ¥ï¼Œè·¯ä¸Šä¹Ÿæ²¡å‡ è¾†è½¦ï¼Œäºæ˜¯let&#39;s goï¼Œ4æ¡£çš„å¹²æ´»ï¼Œè¿™æ„Ÿè§‰å°±æ˜¯ä¹Œé¾Ÿçˆ¬åˆ°äº†å…”å­èº«ä¸Šã€‚&lt;br /&gt;&lt;br&gt;
åˆ°æ ¡åï¼Œç­‰äº†å‡ ä¸ªé’Ÿå¤´ï¼Œä¸­é€”åˆå¼€ç€å‡ºå»ç»ƒç»ƒæ‰‹ï¼Œæ¥ä¸Šå¨ƒåè¿”ç¨‹çš„è·¯é€”ä¹Ÿç®—æœ‰æƒŠæ— é™©ï¼Œç»ˆäºå¹³å®‰çš„è¿é€å›å®¶ã€‚åº†å¹¸çš„æ˜¯è¿™ä¸€è·¯æ²¡æœ‰å€’è½¦å…¥åº“ã€ä¾§æ–¹åœè½¦ä¹‹ç±»çš„æŠ€æœ¯æ´»ã€‚ä¸‡å¹¸ã€‚&lt;/p&gt;
">ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/k8s-ji-qun-kua-jie-dian-pods-wu-fa-ping-tong/"" data-c="
          &lt;p&gt;é™¤äº†k8sè¦æ±‚çš„ç«¯å£è¦å¼€ï¼Œworker nodeä¸Šé¢çš„&lt;code&gt;8472/udpï¼ˆvxlan backendï¼‰&lt;/code&gt;ä¹Ÿå¾—å¼€ã€‚ï¼ˆå°½ç®¡å‚è€ƒé“¾æ¥é‡Œæ˜ç¡®çš„æ˜¯worker nodeè¦å¼€ï¼Œä½†masterä¼¼ä¹ä¹Ÿå¾—å¼€ï¼Œå¦åˆ™masteré‡Œé¢çš„corednsæ— æ³•ä¸ºworker nodeæœåŠ¡ï¼‰&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;ç”¨&lt;code&gt;nmcli&lt;/code&gt;æŸ¥çœ‹ï¼Œå‘ç°flannel ç”¨åˆ°çš„æ˜¯&lt;code&gt;vxlan backend&lt;/code&gt;ï¼Œå› æ­¤éœ€è¦æ‰“å¼€&lt;code&gt;8472/udp&lt;/code&gt;ã€‚&lt;br  /&gt;&lt;br&gt;
æ‰“å¼€åï¼Œå‘ç°Ubuntuçš„nodeå¯ä»¥è¢«pingé€šï¼ŒåŒæ—¶å¦‚æœä¸Šé¢è·‘ç€&lt;code&gt;httpd&lt;/code&gt;ï¼Œå…¶ä»–nodeä¹Ÿå¯ä»¥&lt;code&gt;curl&lt;/code&gt;åˆ°å†…å®¹ï¼›è€ŒCentOSåªèƒ½è¢«pingé€šï¼Œ&lt;code&gt;curl 10.244.2.19&lt;/code&gt;çš„æ—¶å€™ä¼šæ˜¾ç¤º&lt;code&gt;curl: (7) Failed to connect to 10.244.2.19 port 80: No route to host&lt;/code&gt;ã€‚&lt;br /&gt;&lt;br&gt;
æŸ¥äº†nå¤šèµ„æ–™ï¼Œå‡ ä¹éƒ½æ˜¯å…³é—­é˜²ç«å¢™ï¼Œå…³é—­åç¡®å®èƒ½è§£å†³ï¼Œä½†æˆ‘æƒ³è¿™ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­çš„åšæ³•ã€‚æœ€ç»ˆåœ¨è¿™ä½ä»å…„Louis Heçš„åšæ–‡&lt;a href=&#34;https://www.cnblogs.com/Dev0ps/p/11401530.html&#34;&gt;Kubernetesé›†ç¾¤å¼€å¯Firewall&lt;/a&gt;ä¸­æ‰¾åˆ°ç­”æ¡ˆ&lt;code&gt;add-masquerade&lt;/code&gt;ã€‚åŒæ—¶ä¹Ÿè°¢è°¢è®©æˆ‘æ‰¾åˆ°8472ç«¯å£çš„ä»å…„&lt;a href=&#34;https://www.codenong.com/39293441/&#34;&gt;å…³äºç½‘ç»œï¼šKubernetesé›†ç¾¤æ‰€éœ€çš„ç«¯å£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Ubuntu
sudo ufw allow 8472/udp #æå®š

# CentOS
sudo firewall-cmd --zone=public --add-port=8472/udp --permanent
sudo firewall-cmd --reload #è¿™æ­¥æå®Œåªèƒ½è¢«pingé€šï¼Œcurlæ—¶æ˜¯No route to hostï¼Œå¤´ç–¼æ­»äº†
sudo firewall-cmd --add-masquerade --permanent
sudo firewall-cmd --reload #è¿™æ‰æŠŠcurlä¹Ÿæ‰“é€šäº†ï¼Œæˆ‘å¤ªéš¾äº†
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.codenong.com/39293441/&#34;&gt;https://www.codenong.com/39293441/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/Dev0ps/p/11401530.html&#34;&gt;https://www.cnblogs.com/Dev0ps/p/11401530.html&lt;/a&gt;&lt;/p&gt;
">k8sé›†ç¾¤è·¨èŠ‚ç‚¹podsæ— æ³•pingé€šä»¥åŠæ— æ³•curl</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/sheng-lian-shan-sui-bi/"" data-c="
          &lt;p&gt;ä¸Šå‘¨å…­å»äº†è¶Ÿåœ£è²å±±ï¼Œé™ªäººæ•£å¿ƒï¼Œå°½ç®¡å¥½åƒåªæ˜¯æŠŠä»–å½“ä½œè½¦å¤«ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;å»ºè®®ä¹°è§‚å…‰è½¦çš„ç¥¨ï¼Œå¦åˆ™ä»å…¥å£åˆ°æ­£ç»çˆ¬å±±ç‚¹æœ‰7é‡Œåœ°ï¼Œèµ°ä¸ªå¾€è¿”å°±è¯¥æ‰“é“å›åºœäº†ã€‚&lt;br /&gt;&lt;br&gt;
ä¹‹å‰åªæ˜¯å¬äººè¯´è¿‡ï¼Œè¿™æ¬¡åˆ«äººæƒ³æ•£å¿ƒï¼Œäºæ˜¯æ¨èæ­¤åœ°ï¼Œæƒ³æ•£å¿ƒçš„å½“äº†å…¨ç¨‹å¸æœºã€‚ååœ¨è½¦ä¸Šå¾€å±±é‡Œå»æ˜¯è¶Šæ¥è¶Šå‡‰å¿«ï¼Œé€”ä¸­ä¹Ÿè§åˆ°äº†ååˆ†é™¡å³­çš„å±±ï¼Œæœç„¶æˆ¿å±±å°±æ˜¯å±±å¤šã€‚&lt;br /&gt;&lt;br&gt;
æ•£å¿ƒäººè…¿å—ä¼¤äº†ï¼Œå› æ­¤åˆ°äº†æ™¯åŒºåå°½é‡æä¸éœ€è¦ç”¨è…¿çš„é¡¹ç›®ï¼Œæ¯”å¦‚è§‚å…‰è½¦ã€ç¼†è½¦ï¼ˆå†…å¿ƒOSï¼šæ—¢ç„¶è…¿ä¸å¥½ï¼Œæ¥å±±ä¸Šå¹²å•¥ï¼‰ã€‚&lt;br /&gt;&lt;br&gt;
å…¶å®æœ¬äººæ˜¯ç¬¬ä¸€æ¬¡åç¼†è½¦ï¼Œç¨å¾®å¾€ä¸‹çœ‹çœ‹ï¼Œç¡®å®æœ‰ç‚¹è…¿è½¯ã€‚åŒæ—¶æƒ³èµ·æ„å¤§åˆ©çš„ä¸€é¦–æ°‘æ­Œï¼Œå°±å«ç¼†è½¦ï¼Œè®²çš„æ˜¯18å‡ å‡ å¹´çš„äº‹å„¿ï¼Œæœ‰ä¸ªè€æ¿æå±±åŒºæ—…æ¸¸é¡¹ç›®ï¼Œäºæ˜¯æäº†äººåŠ›ç¼†è½¦ï¼Œå¹¶ä¸”ä¸“é—¨æ‰¾ä½œæ›²å®¶å†™äº†ä¸ªæ›²å­ï¼Œå°±æ˜¯ç¼†è½¦ï¼Œå®é™…ä¸ŠåŸæ–‡çš„å‘éŸ³æ˜¯fu ni ku li fu ni ku laï¼Œæ¨¡æ‹Ÿç¼†è½¦çš„å£°éŸ³ï¼Œè¿™ä¸ªæ­Œæ›²æ›´å‡†ç¡®è¯´åº”è¯¥ç±»ä¼¼äºå’±ä»¬çš„åŠ³åŠ¨å·å­ï¼Œå¤§å®¶è¾¹å”±è¾¹ä½¿åŠ²æ‹‰ç»³å­ã€‚æ›²å­éå¸¸æ¬¢å¿«ï¼Œè¿›è¡Œæ›²çš„é‚£ç§æ„Ÿè§‰ï¼Œå¾ˆå¤šæ­Œå‰§æ¼”å‘˜éƒ½å”±è¿‡ï¼Œæ¯”å¦‚è‘—åçš„å¸•ç“¦ç½—è’‚ã€‚ä½†æˆ‘ç¬¬ä¸€æ¬¡å¬æ˜¯åœ¨èŠ’æœå°çš„å£°å…¥äººå¿ƒï¼Œä¸€éå°±å–œæ¬¢ä¸Šäº†ã€‚æˆ‘å¦ˆè§‰å¾—æœ‰äº›æ®µè½åƒæ˜¯é¬¼å­è¿›æ‘ã€‚&lt;br /&gt;&lt;br&gt;
ç¼†è½¦ä¸Šå±±åï¼Œç›´å¥”è§‚å…‰è½¦å¸æœºæ¨èçš„å¿…å»æ™¯ç‚¹ï¼Œä¸€ä¸ªå«åœ£è²å®å¡”ï¼Œä¸€ä¸ªå«è²å­å³°ã€‚åœ£è²å®å¡”å°±æ˜¯åäººç¿»å»ºçš„ä¸€ä¸ªå»ºç­‘ï¼Œæ¯å±‚éƒ½ç»˜åˆ¶äº†ä½›æ•™çš„æ•…äº‹ã€‚å…¶å®æ›´å–œæ¬¢çº¯çš„å¤å»ºç­‘ï¼Œæˆ–è€…ä»¥å¤ä¿®å¤çš„é‚£ç§ï¼Œå¯æƒœè¿™ä¸ªå®å¡”ä¹‹å‰å½»åº•å€’å¡Œäº†ã€‚å¡”æ—è¾¹çš„å±±ä¸Šè¿˜æœ‰é¢˜å­—ï¼Œå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯ä¹¦æ³•å®¶æ‰ä¼šé¢˜å­—ï¼Œå¯è¿™ä¸ªå­—æ€ä¹ˆçœ‹éƒ½è§‰å¾—æŒºå°å­¦ç”Ÿçš„ï¼ˆæ²¡æœ‰ä¾®è¾±å°å­¦ç”Ÿçš„æ„æ€ï¼‰ï¼Œä¸€ç›´ä¹Ÿè”æƒ³ä¸åˆ°æ˜¯å“ªä½å¤§å®¶çš„é£æ ¼ã€‚æ­£æš—è‡ªæ„Ÿå¹è§è¯†å¤ªå°‘ï¼Œå¿½å¬å¾—æ—äººç™¾åº¦çš„ç»“æœï¼Œé¢˜å­—äººæ­£æ˜¯å®å¡”ç¿»å»ºçš„å‡ºèµ„äººä¹‹ä¸€ï¼Œå¿ƒé‡Œçš„å¤§çŸ³å¤´ç»ˆäºè½åœ°ï¼Œçœ‹æ¥è‡ªå·±å®¡ç¾æ²¡å‡ºå¤§é—®é¢˜ã€‚æ—äººä¹Ÿæ€€åŒæ ·æ„Ÿè§‰ï¼Œå¤§å®¶éƒ½é‡Šç„¶äº†ã€‚å½“ç„¶å‡ºèµ„äººçš„åŠŸå¾·è‚¯å®šæ˜¯å¤§å¤§çš„ã€‚&lt;br /&gt;&lt;br&gt;
å®é™…ä¸Šä¸¤ä¸ªæ™¯ç‚¹å¸¦æ¥çš„æ„Ÿè§‰æ²¡æœ‰å¤ªéœ‡æ’¼ï¼Œä½†æ˜¯æ¸¸ç©è¿™ç§äº‹æƒ…ï¼Œè¿‡ç¨‹æ‰æ˜¯æ ¸å¿ƒã€‚ä¸­é—´è¿˜è·¯è¿‡ä¸€ä¸ªæ™¯ç‚¹å«å…«ä»™æ´ï¼Œå°±æ˜¯åœ¨å±±ä¸Šå‡¿ç©¿äº†ä¸ªæ´ï¼Œçœ‹æ´å£çš„å‘å‘æ´¼æ´¼ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯å‰äººä¸€å‡¿ä¸€æ–§çš„å¿ƒè¡€ï¼Œæ´å†…å‡‰æ°”åè¶³ï¼Œä¸”æ´é¡¶è¿˜æœ‰æ¸—æ°´æ»´ä¸‹ï¼Œæˆ‘ä»¬æ„Ÿå¹åº”è¯¥ç©¿æ£‰è¢„è¿›æ¥ã€‚åæ¥æ•£å¿ƒäººåœ¨æ´å¤–å¿½æ‚ åæ¥è€…ï¼Œè¯´æ´é‡Œç§Ÿå†›å¤§è¡£ã€‚ä¸€ä¸ªå‡ å²çš„å°ç”·å­©è¯´ä»€ä¹ˆä¹Ÿä¸è¿›å»ï¼Œè·Ÿçˆ¸å¦ˆè¯´é‡Œé¢å¯æ€•ï¼Œæˆ‘åœ¨æƒ³ä¼°è®¡ä»–ä»¬ä¸€å®¶å°±è¦å°±æ­¤æ‰“ä½äº†ï¼Œç»“æœå­©å­çˆ¸å¦ˆæƒ³äº†ä¸ªåŠæ³•ï¼ŒæŠŠå­©å­æŠ±ä¸Šè®©å­©å­è¶´è‚©å¤´æŒ¡ä½çœ¼ç›ï¼Œç›´æ¥å°±è¿›å»äº†ã€‚è¿™éƒ½è¡Œï¼Œå­©å­å°±æ˜¯å­©å­ã€‚&lt;br /&gt;&lt;br&gt;
ä¹‹åæˆ‘ä»¬æ‰¾äº†ä¸ªåƒ»é™å¤„åƒåˆé¥­ï¼Œè¯´å®è¯èƒŒäº†ä¸€è·¯ï¼Œçƒ§é¥¼ã€é¦™è‚ è¿˜æœ‰æ°´ï¼Œç´¯æ­»æˆ‘äº†ã€‚æˆ‘çˆ¸ä¹°çš„è¿™é¦™è‚ ä¹Ÿæœ‰ä¸ªæ€§ï¼Œå¤–é¢å¡‘æ–™çš®å‰¥å¼€ï¼Œé‡Œé¢å±…ç„¶è¿˜æœ‰ä¸€å±‚å¡‘æ–™è†œï¼Œæˆ‘è¿˜æ²¡å«å‡ºæ¥ï¼Œæ•£å¿ƒäººå·²ç»ä¸€å£å•ƒä¸‹å¹¶åä¸‹äº†ä¸€è§’å¡‘æ–™è†œã€‚è¿™è‚ æœ‰ä¸ªæ€§ï¼Œè¿™äººæ›´æœ‰ä¸ªæ€§ã€‚&lt;/p&gt;
">åœ£è²å±±éšç¬”</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/k8s-cao-zuo-bi-ji/"" data-c="
          &lt;p&gt;å®æ“é‡åˆ°é—®é¢˜å¥½å¤šï¼Œè®°å½•ä¸‹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;imageæ‹‰å–å¤±è´¥replicasè¢«å¼ƒç”¨&#34;&gt;imageæ‹‰å–å¤±è´¥ï¼Œreplicasè¢«å¼ƒç”¨&lt;/h1&gt;
&lt;h2 id=&#34;é—®é¢˜&#34;&gt;é—®é¢˜&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;# æ‰§è¡Œrunï¼Œæ˜¾ç¤ºreplicas has been deprecatedï¼Œå› æ­¤ä¸ç”Ÿæ•ˆï¼Œåªéƒ¨ç½²äº†1ä¸ªå®ä¾‹ 
kubectl run httpd-app --image=httpd --replicas=2
# æ£€æŸ¥podsè¿è¡Œæƒ…å†µï¼ŒREADYåˆ—æ˜¾ç¤ºæœªå°±ç»ª
kubectl get pods -n wide
# æ£€æŸ¥è¿è¡Œç»†èŠ‚ï¼Œä¸€ç›´æ˜¾ç¤ºpulling
kubectl describe pods httpd-app
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è§£å†³&#34;&gt;è§£å†³&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;åˆ é™¤ä¹‹å‰çš„éƒ¨ç½²ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl delete pods httpd-app
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åˆ›å»ºéƒ¨ç½²æ–‡ä»¶ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;cd ~/k8s
nano nginx.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ç²˜è´´ä¸‹é¢å†…å®¹è¿›nginx.yamlï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# API ç‰ˆæœ¬å·
apiVersion: apps/v1
# ç±»å‹ï¼Œå¦‚ï¼šPod/ReplicationController/Deployment/Service/Ingress
kind: Deployment
metadata:
  # Kind çš„åç§°
  name: nginx-app
spec:
  selector:
    matchLabels:
      # å®¹å™¨æ ‡ç­¾çš„åå­—ï¼Œå‘å¸ƒ Service æ—¶ï¼Œselector éœ€è¦å’Œè¿™é‡Œå¯¹åº”
      app: nginx
  # éƒ¨ç½²çš„å®ä¾‹æ•°é‡
  replicas: 2
  template:
    metadata:
      labels:
        app: nginx
    spec:
      # é…ç½®å®¹å™¨ï¼Œæ•°ç»„ç±»å‹ï¼Œè¯´æ˜å¯ä»¥é…ç½®å¤šä¸ªå®¹å™¨
      containers:
      # å®¹å™¨åç§°
      - name: nginx
        # å®¹å™¨é•œåƒ
        image: nginx:1.17
        # åªæœ‰é•œåƒä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šè¿›è¡Œé•œåƒæ‹‰å–
        imagePullPolicy: IfNotPresent
        ports:
        # Pod ç«¯å£
        - containerPort: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;åˆ›å»ºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -f nginx.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;æ£€æŸ¥ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl get deployments
kubectl describe deployment nginx-app
kubectl get replicaset
kubectl describe rs nginx-app-5d85b5fb59
kubectl get pods -o wide
kubectl describe pods nginx-app-5d85b5fb59-2ct5p
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;æš´éœ²æœåŠ¡ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl expose deployment nginx-app --port=80 --type=LoadBalancer
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;æŸ¥çœ‹æœåŠ¡çŠ¶æ€(æŸ¥çœ‹å¯¹å¤–çš„ç«¯å£)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;kubectl get services
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;nginx-app&lt;/code&gt;ä¸€ç›´å¤„äºpendingçŠ¶æ€ï¼Œåº”è¯¥æ˜¯typeè®¾ç½®ä¸º&lt;code&gt;LoadBalancer&lt;/code&gt;ï¼Œä½†æ²¡æœ‰äº‘æœåŠ¡å•†å’Œæœ¬åœ°æœåŠ¡æä¾›è¯¥åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/qq_43279371/article/details/107768713&#34;&gt;https://blog.csdn.net/qq_43279371/article/details/107768713&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/kenkao/article/details/86764788&#34;&gt;https://blog.csdn.net/kenkao/article/details/86764788&lt;/a&gt;&lt;/p&gt;
">k8sæ“ä½œç¬”è®°</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/pei-zhi-ubuntu-he-centos-qing-hua-yuan/"" data-c="
          &lt;p&gt;åŠ å¿«Ubuntuå’ŒCentOSè½¯ä»¶ä¸‹è½½é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;ubuntu&#34;&gt;Ubuntu&lt;/h1&gt;
&lt;p&gt;å¤‡ä»½æºé…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨vimæˆ–geditç¼–è¾‘source.listï¼Œç”¨ä¸‹é¢å†…å®¹æ›¿æ¢åŸæœ‰å†…å®¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse

# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜ï¼Œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;centos&#34;&gt;CentOS&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;path=&#39;/etc/yum.repos.d/&#39;
repos=(CentOS-AppStream.repo CentOS-Base.repo CentOS-centosplus.repo CentOS-Extras.repo CentOS-PowerTools.repo)
for repo in ${repos[@]}; do
sudo cp $path$repo $path$repo&#39;.bak&#39; #å¤‡ä»½æºé…ç½®æ–‡ä»¶
sudo sed -i &amp;quot;s/^mirrorlist/#&amp;amp;/; s/^#baseurl/baseurl/; s/http:\/\/mirror.centos.org\/\$contentdir/https:\/\/mirrors.tuna.tsinghua.edu.cn\/centos/&amp;quot; $path$repo #ä¿®æ”¹é…ç½®æ–‡ä»¶
done
# æ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜ï¼Œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ
sudo yum makecache
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/&#34;&gt;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/xiangxianghehe/article/details/105688062&#34;&gt;https://blog.csdn.net/xiangxianghehe/article/details/105688062&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://mirror.tuna.tsinghua.edu.cn/help/centos/&#34;&gt;https://mirror.tuna.tsinghua.edu.cn/help/centos/&lt;/a&gt;&lt;/p&gt;
">é…ç½®Ubuntuå’ŒCentOSæ¸…åæº</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/zai-centos-he-ubuntu-shang-an-zhuang-he-pei-zhi-docker/"" data-c="
          &lt;p&gt;æ•´ç†dockerå®‰è£…å¿ƒå¾—ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;centos&#34;&gt;CentOS&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;# ç§»é™¤æ—§ç‰ˆ
sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine
# è®¾ç½®é˜¿é‡Œäº‘ä»“åº“repository
sudo yum install -y yum-utils
sudo yum-config-manager \
    --add-repo \
   http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
# å®‰è£…containerd.io
sudo yum install -y https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm
# å®‰è£…docker
sudo yum install docker-ce docker-ce-cli
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ubuntu&#34;&gt;Ubuntu&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;# ç§»é™¤æ—§ç‰ˆ
sudo apt-get remove docker docker-engine docker.io containerd runc
# å®‰è£…ä¾èµ–è½¯ä»¶
sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
# æ·»åŠ ä¸­ç§‘å¤§DockerGPG KEY
curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
# æ·»åŠ ä¸­ç§‘å¤§ä»“åº“
sudo add-apt-repository &amp;quot;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
$(lsb_release -cs) stable&amp;quot;
# å®‰è£…docker
sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šæ“ä½œå®Œæ¯•åï¼Œç»§ç»­æ“ä½œä¸‹é¢é€šç”¨éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;é€šç”¨&#34;&gt;é€šç”¨&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;# å¯åŠ¨docker
sudo systemctl start docker
# åŠ å…¥å¼€æœºå¯åŠ¨
sudo systemctl enable docker
# å…è®¸å½“å‰ç”¨æˆ·ä½¿ç”¨docker
sudo usermod -aG docker ${USER}
su - $USER //ç«‹åˆ»ç”Ÿæ•ˆ
# é…ç½®å›½å†…åŠ é€Ÿå™¨ï¼ˆå¯æ˜¾è‘—å¢åŠ docker pullé•œåƒçš„æˆåŠŸç‡å’Œé€Ÿåº¦ï¼‰
sudo tee /etc/docker/daemon.json &amp;lt;&amp;lt;-&#39;EOF&#39;
{
  &amp;quot;registry-mirrors&amp;quot;: [
    &amp;quot;https://97g5u05j.mirror.aliyuncs.com&amp;quot;,
    &amp;quot;https://dockerhub.azk8s.cn&amp;quot;,
    &amp;quot;https://hub-mirror.c.163.com&amp;quot;,
    &amp;quot;https://docker.mirrors.ustc.edu.cn&amp;quot;
  ],
  &amp;quot;exec-opts&amp;quot;: [&amp;quot;native.cgroupdriver=systemd&amp;quot;],
  &amp;quot;log-driver&amp;quot;: &amp;quot;json-file&amp;quot;,
  &amp;quot;log-opts&amp;quot;: {
    &amp;quot;max-size&amp;quot;: &amp;quot;100m&amp;quot;
  },
  &amp;quot;storage-driver&amp;quot;: &amp;quot;overlay2&amp;quot;
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://docs.docker.com/engine/install/&#34;&gt;https://docs.docker.com/engine/install/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://developer.aliyun.com/article/763983&#34;&gt;https://developer.aliyun.com/article/763983&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/5a911f20d93e&#34;&gt;https://www.jianshu.com/p/5a911f20d93e&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/Alexhcf/article/details/106726860&#34;&gt;https://blog.csdn.net/Alexhcf/article/details/106726860&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/xuyaowen/p/usermod_session.html&#34;&gt;Linux ä¿®æ”¹ç”¨æˆ·ç»„åï¼Œå¦‚ä½•å…³é—­æ‰€æœ‰ X session ä¸‹ä½¿å¾—ç»„ç”Ÿæ•ˆï¼Ÿ&lt;/a&gt;&lt;/p&gt;
">åœ¨CentOSå’ŒUbuntuä¸Šå®‰è£…å’Œé…ç½®docker</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/ubuntu-he-centos-duan-kou-she-zhi/"" data-c="
          &lt;p&gt;è®°å½•ä¸‹ç«¯å£è®¾ç½®ï¼Œç”¨åˆ°å•¥è®°å½•å•¥ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;centos&#34;&gt;CentOS&lt;/h1&gt;
&lt;p&gt;æ ¸å¿ƒæŒ‡ä»¤&lt;code&gt;firewall-cmd&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --list-ports
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¼€å¯ç«¯å£&#34;&gt;å¼€å¯ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --zone=public --add-port=10250/tcp --permanent
sudo firewall-cmd --zone=public --add-port=30000-32767/tcp --permanent
//--zone: ä½œç”¨åŸŸ 
//--add-port=2181/tcp: è¦å¼€å¯çš„ç«¯å£å·ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£å·/é€šè®¯åè®® 
//--permanent: ä½¿ç«¯å£æ°¸ä¹…å¼€æ”¾ï¼Œå¦‚ä¸æ·»åŠ ï¼Œåˆ™è¡¨ç¤ºä¸´æ—¶æœ‰æ•ˆï¼Œå¼€æœºé‡å¯åä¾¿ä¼šå¤±æ•ˆ
//30000-32767ï¼Œç«¯å£åŒºé—´
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å…³é—­ç«¯å£&#34;&gt;å…³é—­ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --zone=public --remove-port=6443/tcp --permanent
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;reloadä»¥ä¾¿-permanenté…ç½®ç”Ÿæ•ˆ&#34;&gt;reloadä»¥ä¾¿--permanenté…ç½®ç”Ÿæ•ˆ&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ubuntu&#34;&gt;Ubuntu&lt;/h1&gt;
&lt;p&gt;æ ¸å¿ƒæŒ‡ä»¤&lt;code&gt;ufw&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;å¯ç”¨ufw&#34;&gt;å¯ç”¨ufw&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw enable
sudo ufw allow ssh
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£-2&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw status
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¼€å¯ç«¯å£-2&#34;&gt;å¼€å¯ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw allow 10250/tcp
sudo ufw allow 30000:32767/tcp
//30000:32767æ˜¯ç«¯å£åŒºé—´
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å…³é—­ç«¯å£-2&#34;&gt;å…³é—­ç«¯å£&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw delete allow 10250/tcp
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/Sungeek/p/8257681.html&#34;&gt;https://www.cnblogs.com/Sungeek/p/8257681.html&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/Sun_Hui_/article/details/103178840&#34;&gt;https://blog.csdn.net/Sun_Hui_/article/details/103178840&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.itcoder.tech/posts/how-to-setup-a-firewall-with-ufw-on-ubuntu-20-04/&#34;&gt;https://www.itcoder.tech/posts/how-to-setup-a-firewall-with-ufw-on-ubuntu-20-04/&lt;/a&gt;&lt;/p&gt;
">Ubuntuå’ŒCentOSç«¯å£è®¾ç½®</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/ubuntu-he-centos-xiu-gai-grub/"" data-c="
          &lt;p&gt;grubçš„ä¿®æ”¹ä½ç½®å’Œç”Ÿæ•ˆæ–¹æ³•ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;ä¿®æ”¹ä½ç½®&#34;&gt;ä¿®æ”¹ä½ç½®&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo vim /etc/default/grub
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ç”Ÿæ•ˆæ–¹æ³•&#34;&gt;ç”Ÿæ•ˆæ–¹æ³•&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;sudo grub2-mkconfig â€“o /etc/grub2.cfg  #CentOS
sudo update-grub2  #Ubuntu
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;troubleshooting&#34;&gt;Troubleshooting&lt;/h1&gt;
&lt;h2 id=&#34;æè¿°&#34;&gt;æè¿°&lt;/h2&gt;
&lt;p&gt;CentOSæŒ‰ä¸Šé¢æ“ä½œä¿®æ”¹&lt;code&gt;GRUB_TIMEOUT=0&lt;/code&gt;åï¼Œæ— è®ºæ€æ ·éƒ½ä¸ç”Ÿæ•ˆï¼Œæ— æ³•è·³è¿‡boot menuå€’è®¡æ—¶5ç§’çš„é­”å’’ã€‚å°è¯•è¿‡&lt;code&gt;GRUB_TIMEOUT_STYLE=&amp;quot;hidden&amp;quot; GRUB_HIDDEN_TIMEOUT_QUIET=true GRUB_ENABLE_BLSCFG=false&lt;/code&gt;ç­‰å„ç§é€‰é¡¹ï¼Œå‡æ— æ•ˆã€‚&lt;code&gt;sudo ls -l /boot/grub2/&lt;/code&gt;æŸ¥çœ‹&lt;code&gt;grub.cfg&lt;/code&gt;ï¼Œä¿®æ”¹æ—¶é—´çº¹ä¸æœªåŠ¨ï¼Œåˆç€ç©å„¿å‘¢ã€‚&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³&#34;&gt;è§£å†³&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;sudo vim /etc/grub2.cfg&lt;/code&gt;å‘ç°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; 63 if [ x$feature_timeout_style = xy ] ; then
 64   set timeout_style=menu
 65   set timeout=5
 66 # Fallback normal timeout code in case the timeout_style feature is
 67 # unavailable.
 68 else
 69   set timeout=5
 70 fi
 71 ### END /etc/grub.d/00_header ###
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ„Ÿè§‰é—®é¢˜å‡ºåœ¨&lt;code&gt;/etc/grub.d/00_header&lt;/code&gt;ï¼Œç ”ç©¶headeråŠå¤©ï¼Œæ²¡æ‡‚ğŸ˜… &lt;br /&gt;&lt;br&gt;
è€Œ&lt;code&gt;/etc/grub2.cfg&lt;/code&gt;å¼€ç¯‡å°±å†™ç€&lt;code&gt;# DO NOT EDIT THIS FILE&lt;/code&gt;ï¼Œå¯å®åœ¨æ²¡è¾™äº†ï¼Œè¯•ç€æ”¹äº†ä¸Šé¢65è¡Œçš„timeoutï¼Œç›´æ¥æ”¹æˆ0ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;65   set timeout=0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¿å­˜é€€å‡ºé‡å¯ï¼ŒæˆåŠŸäº†ã€‚è¿™éƒ½æ˜¯ä»€ä¹ˆé¬¼ã€‚ğŸ™ƒ&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/whatday/article/details/106123164&#34;&gt;https://blog.csdn.net/whatday/article/details/106123164&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/&#34;&gt;https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/&lt;/a&gt;&lt;/p&gt;
">Ubuntuå’ŒCentOSä¿®æ”¹grub</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/about/"" data-c="
          &lt;p&gt;ç¬¬ä¸€æ¬¡æ‹¥æœ‰è‡ªå·±çš„åšå®¢ï¼Œæ„Ÿè§‰å…´å¥‹ï¼ŒæŠ˜è…¾äº†åŠå¤©ï¼Œä¸»è¦æ˜¯ä¸ºäº†è‡ªå·±èƒ½æœ‰ä¸€ä¸ªè®°å½•å’Œåæ§½çš„åœ°æ–¹ã€‚æ›¾ç»ä¹Ÿåœ¨å…¶ä»–ç½‘ç«™åšè¿‡bloggerï¼Œç»“æœè¦ä¹ˆå…³å¼ è¦ä¹ˆæ¶ˆå¤±è¦ä¹ˆå¢™å¢™ï¼Œä¸€è¨€éš¾å°½ã€‚&lt;/p&gt;
">å…³äº</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://tomhht.github.io/post/zai-ubuntu-2004-shang-shi-yong-kubeadm-bu-shu-kubernetes-ji-qun/"" data-c="
          &lt;p&gt;æœ¬æ–‡ä¸»è¦æ˜¯è¸©å‘åæƒ³è®°å½•ä¸‹é¿å‘æ–¹æ³•ï¼Œå†…å®¹æ¶‰åŠKubernetes, Kubeadm, Kubectl, Kubelet, Ubuntu, CentOS, Flannel, Docker, é˜¿é‡Œäº‘ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;å†™ä½œèƒŒæ™¯&#34;&gt;å†™ä½œèƒŒæ™¯&lt;/h1&gt;
&lt;p&gt;åˆå­¦Kubernetesï¼Œè™½ç„¶ç½‘ä¸Šèµ„æºå¾ˆå¤šï¼Œä½†æ²¡ä¸€ä¸ªèƒ½å½»åº•æå®šï¼Œäºæ˜¯æ‚çƒ©ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œ&#34;&gt;å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œ&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;control nodeï¼ˆæ§åˆ¶èŠ‚ç‚¹ï¼‰ã€worker nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ éƒ½è¦åšè¿™äº›å‡†å¤‡å·¥ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æ£€æŸ¥å„ä¸»æœºé…ç½®&#34;&gt;æ£€æŸ¥å„ä¸»æœºé…ç½®&lt;/h2&gt;
&lt;h3 id=&#34;æ£€æŸ¥cpuå’Œå†…å­˜&#34;&gt;æ£€æŸ¥cpuå’Œå†…å­˜&lt;/h3&gt;
&lt;p&gt;æ— è®ºæ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯ç‰©ç†æœºï¼Œéƒ½è¦æ±‚&lt;strong&gt;cpuå†…æ ¸â‰¥2ï¼Œå†…å­˜â‰¥2G&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ£€æŸ¥ä¸»æœºåhostname&#34;&gt;æ£€æŸ¥ä¸»æœºåhostname&lt;/h3&gt;
&lt;p&gt;hostnameè¦æ±‚&lt;strong&gt;ä¸èƒ½æ˜¯ localhostï¼Œä¸”ä¸åŒ…å«ä¸‹åˆ’çº¿ã€å°æ•°ç‚¹ã€å¤§å†™å­—æ¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# æ£€æŸ¥hostname
hostname 
# ä¿®æ”¹ hostname
hostnamectl set-hostname åå­—
# æŸ¥çœ‹ä¿®æ”¹ç»“æœ
hostnamectl status
# è®¾ç½® hostname è§£æ
echo &amp;quot;127.0.0.1   $(hostname)&amp;quot; &amp;gt;&amp;gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è®¾ç½®å›ºå®šip&#34;&gt;è®¾ç½®å›ºå®šIP&lt;/h3&gt;
&lt;p&gt;å»ºè®®ä½¿ç”¨nmclié…ç½®ï¼Œå› ä¸ºè·¨å¹³å°ï¼ˆUbuntuå’ŒCentOSï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nmcli
//å¦‚æœæç¤ºæ²¡æœ‰å®‰è£…ï¼Œå…ˆæŒ‰ä¸‹é¢æ­¥éª¤å®‰è£…
# å®‰è£…nmcli
sudo yum install NetworkManager #CentOS
sudo apt-get install network-manager #Ubuntu
# æ£€æŸ¥nmcliæ˜¯å¦æ¥ç®¡äº†ç½‘ç»œç®¡ç†
nmcli g
//æ­£å¸¸æ˜¯æ˜¾ç¤ºç»¿è‰²çš„ä¿¡æ¯ã€‚å¦‚æœSTATEåˆ—æ˜¾ç¤ºdisconnectedï¼Œåˆ™Ubuntuè¦ä¿®æ”¹/etc/netplan/é‡Œçš„yamlæ–‡ä»¶ï¼Œåœ¨versionä¸‹é¢æ·»åŠ ä¸€è¡Œrenderer: NetworkManagerï¼Œä¿å­˜é€€å‡ºåæ‰§è¡Œsudo systemctl daemon-reload å’Œ sudo systemctl restart NetworkManager
# æŸ¥çœ‹å½“å‰é»˜è®¤ç½‘å¡å’Œipä¿¡æ¯
ip route show
ip a
//ip route show å‘½ä»¤ä¸­ï¼Œå¯ä»¥çŸ¥é“æœºå™¨çš„ç½‘å…³DNSå’Œé»˜è®¤ç½‘å¡ï¼Œå¦‚ default via 192.168.127.2 dev ens33ï¼Œviaåé¢çš„å†…å®¹ 192.168.127.2 å°±æ˜¯ç½‘å…³å’ŒDNSï¼Œdevåé¢çš„å†…å®¹ ens33 å°±æ˜¯é»˜è®¤ç½‘å¡
//ip a å‘½ä»¤ä¸­ï¼Œå¯æ˜¾ç¤ºé»˜è®¤ç½‘å¡çš„ IP åœ°å€ï¼ŒKubernetes å°†ä½¿ç”¨æ­¤ IP åœ°å€ä¸é›†ç¾¤å†…çš„å…¶ä»–èŠ‚ç‚¹é€šä¿¡ï¼Œå¦‚192.168.127.131
//æ‰€æœ‰èŠ‚ç‚¹ä¸Š Kubernetes æ‰€ä½¿ç”¨çš„ IP åœ°å€å¿…é¡»å¯ä»¥äº’é€šï¼ˆæ— éœ€ NAT æ˜ å°„ã€æ— å®‰å…¨ç»„æˆ–é˜²ç«å¢™éš”ç¦»ï¼‰
# è®¾ç½®å›ºå®šIPï¼Œç½‘å¡ã€ipåœ°å€ã€ç½‘å…³ã€DNSå¯å‚è€ƒä¸Šé¢çš„ä¿¡æ¯
sudo nmcli c mod ens33 \
ipv4.addresses 192.168.127.131/24 \
ipv4.method manual \
ipv4.gateway 192.168.127.2 \
ipv4.dns 192.168.127.2
# è®©é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ
sudo nmcli c up ens33
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è®¾ç½®iptables&#34;&gt;è®¾ç½®iptables&lt;/h2&gt;
&lt;p&gt;æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo modprobe br_netfilter
cat &amp;lt;&amp;lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
sudo sysctl --system
# å¦‚æœæƒ³æ£€æŸ¥é…ç½®ï¼Œå¯æ‰§è¡Œ
sysctl -n net.bridge.bridge-nf-call-iptables
sysctl -n net.bridge.bridge-nf-call-ip6tables
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ‰“å¼€ç«¯å£&#34;&gt;æ‰“å¼€ç«¯å£&lt;/h2&gt;
&lt;h3 id=&#34;ubuntuçš„å‡†å¤‡å·¥ä½œ&#34;&gt;Ubuntuçš„å‡†å¤‡å·¥ä½œ&lt;/h3&gt;
&lt;p&gt;å…ˆæ‰“å¼€Ubuntuè‡ªå¸¦çš„é˜²ç«å¢™ufwã€‚æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw enable
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œåæç¤ºå¯èƒ½æ–­å¼€è¿æ¥ï¼Œç›´æ¥yç»§ç»­ï¼Œåˆ«æ‹…å¿ƒï¼Œsshè¿æ¥ä¸ä¼šæ–­ã€‚&lt;br&gt;
å¦‚æœä½¿ç”¨sshè¿æ¥ï¼Œè¿˜éœ€è¦æ‰§è¡Œä¸‹é¢ä»£ç ï¼Œä»¥ä¾¿æ‰“å¼€sshè¿æ¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo ufw allow ssh
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æ‰“å¼€ç›¸åº”ç«¯å£&#34;&gt;æ‰“å¼€ç›¸åº”ç«¯å£&lt;/h3&gt;
&lt;p&gt;ä¾æ®æ‰€ä½¿ç”¨çš„ç³»ç»Ÿï¼ˆUbuntu / CentOSï¼‰ï¼Œæ‰§è¡Œç›¸åº”ä»£ç ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ§åˆ¶èŠ‚ç‚¹ Control-plane nodes&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# Ubuntu
sudo ufw allow 6443/tcp
sudo ufw allow 2379:2380/tcp
sudo ufw allow 10250:10252/tcp
sudo ufw allow 8472/udp #for flannelã€‚å¦‚æœä¸å¼€ï¼Œåˆ™corednsæ— æ³•ä¸ºworker nodesæœåŠ¡
//ä¸Šé¢ä»£ç ä¸­çš„å†’å·ä»£è¡¨ç«¯å£åŒºé—´ã€‚

# CentOS
sudo firewall-cmd --zone=public --add-port=6443/tcp --permanent
sudo firewall-cmd --zone=public --add-port=2379-2380/tcp --permanent
sudo firewall-cmd --zone=public --add-port=10250-10252/tcp --permanent
sudo firewall-cmd --zone=public --add-port=8472/udp --permanent #for flannelã€‚å¦‚æœä¸å¼€ï¼Œåˆ™corednsæ— æ³•ä¸ºworker nodesæœåŠ¡
sudo firewall-cmd --add-masquerade --permanent #for flannel NAT
sudo firewall-cmd --reload
sudo firewall-cmd --list-ports //æŸ¥çœ‹è®¾ç½®æ•ˆæœ
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å·¥ä½œèŠ‚ç‚¹ Worker nodes&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;# Ubuntu
sudo ufw allow 10250/tcp
sudo ufw allow 30000:32767/tcp
sudo ufw allow 8472/udp #for flannel

# CentOS
sudo firewall-cmd --zone=public --add-port=10250/tcp --permanent
sudo firewall-cmd --zone=public --add-port=30000-32767/tcp --permanent
sudo firewall-cmd --zone=public --add-port=8472/udp --permanent #for flannel
sudo firewall-cmd --add-masquerade --permanent #for flannel NAT
sudo firewall-cmd --reload
sudo firewall-cmd --list-ports //æŸ¥çœ‹è®¾ç½®æ•ˆæœ
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç¦ç”¨swap&#34;&gt;ç¦ç”¨swap&lt;/h2&gt;
&lt;p&gt;ç”±äºswapæ€§èƒ½ä½ä¸‹ï¼ŒKubeadmé»˜è®¤è¦æ±‚ç¦æ­¢ä½¿ç”¨swapã€‚æ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo swapoff -a  #ä¸´æ—¶ç¦ç”¨swap
sudo sed -i &#39;s/.*swap.*/#&amp;amp;/&#39; /etc/fstab  #æ°¸ä¹…ç¦ç”¨swap
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯é€šè¿‡&lt;code&gt;free -m&lt;/code&gt;æ¥æ£€æŸ¥ç¦ç”¨æ•ˆæœã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…docker&#34;&gt;å®‰è£…docker&lt;/h2&gt;
&lt;p&gt;è¯¦è§&lt;a href=&#34;/post/zai-centos-he-ubuntu-shang-an-zhuang-he-pei-zhi-docker&#34;&gt;dockerå®‰è£…å’Œé…ç½®&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;åˆ›å»ºk8sæ–‡ä»¶å¤¹&#34;&gt;åˆ›å»ºk8sæ–‡ä»¶å¤¹&lt;/h2&gt;
&lt;p&gt;å¯ç”¨æ¥å­˜æ”¾ç›¸å…³æ–‡ä»¶ã€‚æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir ~/k8s
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å®‰è£…kubeadm-kubeletå’Œkubectl&#34;&gt;å®‰è£…kubeadm, kubeletå’Œkubectl&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;control nodeï¼ˆæ§åˆ¶èŠ‚ç‚¹ï¼‰ã€worker nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ ä¸Šéƒ½å®‰è£…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Ubuntu&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get update &amp;amp;&amp;amp; sudo apt-get install -y apt-transport-https curl
curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -
cat &amp;lt;&amp;lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list
deb https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main
EOF
sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;CentOS&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=0
repo_gpgcheck=0
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
exclude=kubelet kubeadm kubectl
EOF

# Set SELinux in permissive mode (effectively disabling it)
sudo setenforce 0
sudo sed -i &#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39; /etc/selinux/config

sudo yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes

sudo systemctl enable --now kubelet
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;åœ¨control-nodeæ§åˆ¶èŠ‚ç‚¹ä¸Šç”¨kubeadmåˆ›å»ºé›†ç¾¤&#34;&gt;åœ¨control nodeæ§åˆ¶èŠ‚ç‚¹ä¸Šç”¨kubeadmåˆ›å»ºé›†ç¾¤&lt;/h1&gt;
&lt;h2 id=&#34;åˆå§‹åŒ–é›†ç¾¤&#34;&gt;åˆå§‹åŒ–é›†ç¾¤&lt;/h2&gt;
&lt;!-- - æ–¹æ³•ä¸€ï¼ˆæ¨èï¼Œèƒ½æˆåŠŸå°±å¾ˆå¹¸è¿ï¼‰--&gt;
&lt;pre&gt;&lt;code&gt;sudo kubeadm init --apiserver-advertise-address=ä½ çš„æœ¬æœºIP \
--pod-network-cidr=10.244.0.0/16 \
--kubernetes-version=v1.19.0 \
--image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers
...
...
kubeadm join 192.168.127.132:6443 --token 4pwz11.1m0u1k3ak3ibgx08 \
    --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°†è¾“å‡ºå†…å®¹ä¸­çš„&lt;code&gt;kubeadm join ...&lt;/code&gt;è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å…¶ä»–èŠ‚ç‚¹åŠ å…¥ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;!-- å¦‚æœå®‰è£…å¤±è´¥ï¼Œå†è¯•å‡ æ¬¡ï¼Œè¿˜ä¸è¡Œå°±å°è¯•æ–¹æ³•äºŒã€‚
å¦‚æœå®‰è£…æˆåŠŸï¼Œåˆ™è¾“å‡ºç±»ä¼¼ä¸‹é¢å†…å®¹ï¼Œå°†å†…å®¹ä¸­çš„`kubeadm join ...`å•ç‹¬ä¿å­˜å‡ºæ¥ï¼Œè¿™æ˜¯å…¶ä»–èŠ‚ç‚¹åŠ å…¥ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚è·³è¿‡æ–¹æ³•äºŒã€‚
å¦‚æœå®‰è£…é¡ºåˆ©ï¼Œ&lt;a href=&#34;#%E8%B5%8B%E4%BA%88%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8kubectl%E7%9A%84%E6%9D%83%E9%99%90&#34;&gt;ç‚¹è¿™é‡Œè·³è¿‡æ–¹æ³•äºŒ&lt;/a&gt;ã€‚
## åˆå§‹åŒ–é›†ç¾¤ - æ–¹æ³•äºŒï¼ˆåªåœ¨æ–¹æ³•ä¸€å¤±è´¥çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼‰
ç”±äºç§ç§åŸå› ï¼Œå›½å†…æ— æ³•ä»k8s.gcr.ioä¸‹è½½åˆ°kubeadméƒ¨ç½²æ‰€éœ€çš„æ–‡ä»¶ï¼Œä»¥ä¸‹æ–¹æ³•å°†é€šè¿‡é˜¿é‡Œäº‘è·å–ã€‚
### å‡†å¤‡å·¥ä½œ
#### æŸ¥çœ‹æ‰€éœ€é•œåƒ
```
kubeadm config images list
#ä¸‹é¢æ˜¯æ‰§è¡Œçš„ç»“æœ
k8s.gcr.io/kube-apiserver:v1.18.8
k8s.gcr.io/kube-controller-manager:v1.18.8
k8s.gcr.io/kube-scheduler:v1.18.8
k8s.gcr.io/kube-proxy:v1.18.8
k8s.gcr.io/pause:3.2
k8s.gcr.io/etcd:3.4.3-0
k8s.gcr.io/coredns:1.6.7
```
#### åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°æ‰¾åˆ°æ‰€éœ€é•œåƒ
1. [https://cr.console.aliyun.com/](https://cr.console.aliyun.com/)  å·¦ä¾§ç‚¹â€é•œåƒæœç´¢â€œ
2. åˆ†åˆ«æœç´¢â€kube-apiserverâ€œç­‰æ‰€æœ‰åç§°ï¼Œç‚¹å¼€æœç´¢åˆ°çš„é•œåƒï¼Œä¸€å®šæ‰¾åˆ°æ­£ç¡®çš„ç‰ˆæœ¬å·ï¼ˆå¦‚v1.18.8ï¼‰ï¼ˆæ—¥æœŸè¶Šæ–°çš„è¶Šå®¹æ˜“æ‰¾åˆ°ï¼‰ï¼Œå¤åˆ¶é¡µé¢ä¸­çš„â€å…¬ç½‘åœ°å€â€œ
#### pullé•œåƒã€æ‰“æ ‡ç­¾ã€ç§»é™¤æ— ç”¨é•œåƒ
1. pullé•œåƒ
```
KUBE_VERSION=v1.18.8
PAUSE_VERSION=3.2
ETCD_VERSION=3.4.3-0
CORE_DNS_VERSION=1.6.7
docker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-controller-manager:$KUBE_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-scheduler:$KUBE_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-proxy:$KUBE_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION
```
2. ç»™pullä¸‹æ¥çš„é•œåƒæ‰“æ ‡ç­¾
å› ä¸ºkubeadméƒ¨ç½²æ—¶ä¼šæ‰¾k8s.gcr.ioæ ‡ç­¾çš„é•œåƒï¼Œå› æ­¤éœ€è¦å°†ä¸Šä¸€æ­¥pullçš„é•œåƒæ‰“ä¸Šk8s.gcr.ioæ ‡ç­¾ã€‚
```
docker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION  k8s.gcr.io/kube-proxy:$KUBE_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-controller-manager:$KUBE_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-apiserver:$KUBE_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-scheduler:$KUBE_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION k8s.gcr.io/pause:$PAUSE_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION k8s.gcr.io/coredns:$CORE_DNS_VERSION
docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION k8s.gcr.io/etcd:$ETCD_VERSION
```
3. ç§»é™¤ä»é˜¿é‡Œäº‘pullä¸‹æ¥çš„é•œåƒ
```
docker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-controller-manager:$KUBE_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-scheduler:$KUBE_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-proxy:$KUBE_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION
docker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION
``` 
### éƒ¨ç½²
```
sudo kubeadm init --apiserver-advertise-address=ä½ çš„æœ¬æœºIP --pod-network-cidr=10.244.0.0/16  --kubernetes-version=v1.19.0
#æ‰§è¡Œåçš„è¾“å‡º
...
...
kubeadm join 192.168.127.132:6443 --token 4pwz11.1m0u1k3ak3ibgx08 \
    --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7
```--&gt;
&lt;h2 id=&#34;èµ‹äºˆå½“å‰ç”¨æˆ·ä½¿ç”¨kubectlçš„æƒé™&#34;&gt;èµ‹äºˆå½“å‰ç”¨æˆ·ä½¿ç”¨kubectlçš„æƒé™&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å®‰è£…ç½‘ç»œç»„ä»¶flannel&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/h2&gt;
&lt;h3 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h3&gt;
&lt;p&gt;ç”±äºç§ç§åŸå› ï¼Œæ— æ³•ç›´æ¥pullåˆ°ç½‘ç»œç»„ä»¶flannelçš„dockeré•œåƒï¼Œå› æ­¤éœ€å•ç‹¬ä¸‹è½½ã€‚&lt;br&gt;
https://github.com/coreos/flannel/releases/download/v0.12.0/flanneld-v0.12.0-amd64.docker&lt;br&gt;
ä¸‹è½½åæ”¾è¿›&lt;code&gt;~/k8s&lt;/code&gt;ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd ~/k8s
docker load &amp;lt; flanneld-v0.12.0-amd64.docker
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¼€å§‹å®‰è£…&#34;&gt;å¼€å§‹å®‰è£…&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
kubectl apply -f kube-flannel.yml
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ£€æŸ¥éƒ¨ç½²æƒ…å†µ&#34;&gt;æ£€æŸ¥éƒ¨ç½²æƒ…å†µ&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;kubectl get nodes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://tomhht.github.io/post-images/1598781753839.png&#34; alt=&#34;èŠ‚ç‚¹è¿è¡Œæƒ…å†µ&#34; loading=&#34;lazy&#34;&gt;     &lt;br /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pods -A
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://tomhht.github.io/post-images/1598781791291.png&#34; alt=&#34;Podsè¿è¡Œæƒ…å†µ&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é€šè¿‡&lt;code&gt;docker container ls&lt;/code&gt;ä¹Ÿå¯ä»¥çœ‹åˆ°podsé‡Œçš„å®¹å™¨è¿è¡Œæƒ…å†µã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‰“å¼€kubectlå’Œkubeadmçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½&#34;&gt;æ‰“å¼€kubectlå’Œkubeadmçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;echo &#39;source &amp;lt;(kubectl completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc
echo &#39;source &amp;lt;(kubeadm completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc
source ~/.bashrc #ä½¿é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šä¸ºcontrol nodeæ§åˆ¶èŠ‚ç‚¹çš„éƒ¨ç½²å…¨æµç¨‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;worker-nodeå·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤&#34;&gt;worker nodeå·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¡®è®¤åœ¨worker nodeä¸»æœºä¸Šå·²å®‰è£…äº†kubeadm, kubeletå’Œkubectlã€‚&lt;br&gt;
å¦‚æœªå®‰è£…ï¼Œå‚è€ƒ&lt;a href=&#34;#å®‰è£…kubeadm-kubeletå’Œkubectl&#34;&gt;å®‰è£…kubeadm, kubeletå’Œkubectl&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å®‰è£…ç½‘ç»œç»„ä»¶flannel-2&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨&lt;strong&gt;control node&lt;/strong&gt;ä¸Šå¯¼å‡ºflannelçš„dockeré•œåƒï¼Œå¹¶å¤åˆ¶åˆ°worker nodeï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æé†’ï¼š~/k8sç›®å½•åœ¨å„nodeä¸Šéƒ½æå‰å»ºå¥½&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;docker save quay.io/coreos/flannel:v0.12.0 &amp;gt; ~/k8s/flannel-v0.12.0.tar
scp ~k8s/flannel-v0.12.0.tar tom@192.168.127.133:~/k8s
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åœ¨&lt;strong&gt;worker node&lt;/strong&gt;ä¸Šå¯¼å…¥flannelçš„dockeré•œåƒï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;docker load &amp;lt; k8s/flannel-v0.12.0.tar
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- ## è½½å…¥control  nodeä¸Špullå¥½çš„é•œåƒ
1. åœ¨control nodeä¸Šï¼Œå¤‡ä»½å‡ºå…¨å¥—dockeré•œåƒï¼ˆå«kubeadmæ‰€éœ€é•œåƒ+ç½‘ç»œç»„ä»¶flannelé•œåƒï¼‰ï¼š
```
cd ~/k8s
docker save k8s.gcr.io/kube-proxy:v1.18.8 \
k8s.gcr.io/kube-apiserver:v1.18.8 \
k8s.gcr.io/kube-controller-manager:v1.18.8 \
k8s.gcr.io/kube-scheduler:v1.18.8 \
k8s.gcr.io/pause:3.2 \
k8s.gcr.io/coredns:1.6.7 \
k8s.gcr.io/etcd:3.4.3-0 \
quay.io/coreos/flannel:v0.12.0-amd64 &gt; k8s-imagesV1.18.8-flannelV0.12.0.tar
```
&gt; ä¹‹å‰è¸©å‘ï¼Œå·æ‡’ç”¨IMAGE IDåšçš„å¤‡ä»½ï¼Œç»“æœè½½å…¥ä»¥ånameå’Œtagå…¨éƒ½æ˜¯noneï¼Œè¿˜å¾—æ‰“nameå’Œtagä¸Šå»ï¼Œæ— æ¯”ç¹ç- _ -||
2. scpä¸Šé¢çš„å¤‡ä»½æ–‡ä»¶åˆ°å„ä¸ªworker nodeçš„`~/k8s`æ–‡ä»¶å¤¹é‡Œ
3. åœ¨worker nodeä¸Šè½½å…¥å¤‡ä»½æ–‡ä»¶ï¼š
```
cd ~/k8s
docker load &lt; k8s-imagesV1.18.8-flannelV0.12.0.tar
```
&gt; worker nodeå®é™…éœ€è¦çš„åªæœ‰3ä¸ªé•œåƒï¼Œåˆ†åˆ«æ˜¯`kube-proxy, pause, flannel`--&gt;
&lt;h2 id=&#34;åŠ å…¥é›†ç¾¤&#34;&gt;åŠ å…¥é›†ç¾¤&lt;/h2&gt;
&lt;p&gt;åœ¨worker nodeä¸Šï¼Œæ‰§è¡Œä¹‹å‰è®°å½•çš„&lt;code&gt;kubeadm join...&lt;/code&gt;ä»£ç ï¼Œç±»ä¼¼äºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo kubeadm join 192.168.127.132:6443 --token rddtz5.mz2v4ee96177eay5     --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœjoinæŒ‡ä»¤æ²¡è®°å½•ä¸‹æ¥ï¼Œæˆ–è€…é›†ç¾¤åˆ›å»ºå·²ç»è¶…è¿‡24å°æ—¶äº†ï¼Œé‚£ä¹ˆéœ€è¦é‡æ–°ç”ŸæˆjoinæŒ‡ä»¤ã€‚åœ¨&lt;strong&gt;control node&lt;/strong&gt;ä¸Šæ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubeadm token create --print-join-command
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤åˆ¶è¾“å‡ºçš„å†…å®¹å¹¶åœ¨&lt;strong&gt;worker node&lt;/strong&gt;ä¸Šæ‰§è¡Œå³å¯åŠ å…¥ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;æ£€æŸ¥éƒ¨ç½²ç»“æœ&#34;&gt;æ£€æŸ¥éƒ¨ç½²ç»“æœ&lt;/h1&gt;
&lt;p&gt;åœ¨control nodeä¸Šæ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get nodes -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://tomhht.github.io/post-images/1599032788153.png&#34; alt=&#34;é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯&#34; loading=&#34;lazy&#34;&gt; &lt;br /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pods -A -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://tomhht.github.io/post-images/1599032818248.png&#34; alt=&#34;é›†ç¾¤podsä¿¡æ¯&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚æœSTATUSä¸æ˜¯Runningï¼Œåˆ™æ’æŸ¥æ•…éšœç‚¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl describe pods -n kube-system kube-proxy-t2zbw
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;troubleshooting&#34;&gt;Troubleshooting&lt;/h1&gt;
&lt;h2 id=&#34;pull-imageå¤±è´¥&#34;&gt;pull imageå¤±è´¥&lt;/h2&gt;
&lt;p&gt;å¦‚æœ&lt;code&gt;kubectl get pods -n kube-system -o wide&lt;/code&gt;å‘ç°æŸä¸ªpodsè¿˜æ²¡readyï¼Œè€Œdockerä¹Ÿå·²ç»é…ç½®äº†å›½å†…åŠ é€Ÿå™¨ï¼Œé‚£ä¹ˆè¯•ç€é‡å¯dockerä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo systemctl restart docker.service
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;
&lt;a href=&#34;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/&#34;&gt;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/hellxz/p/use-kubeadm-init-kubernetes-cluster.html&#34;&gt;https://www.cnblogs.com/hellxz/p/use-kubeadm-init-kubernetes-cluster.html&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.kuboard.cn/install/install-k8s.html&#34;&gt;https://www.kuboard.cn/install/install-k8s.html&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/LeonardoYasuo/article/details/101483438&#34;&gt;https://blog.csdn.net/LeonardoYasuo/article/details/101483438&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/yinzhengjie/p/12258215.html&#34;&gt;https://www.cnblogs.com/yinzhengjie/p/12258215.html&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://developer.aliyun.com/article/763983&#34;&gt;https://developer.aliyun.com/article/763983&lt;/a&gt;&lt;/p&gt;
">åœ¨Ubuntu 20.04å’ŒCentOS 8ä¸Šä½¿ç”¨kubeadméƒ¨ç½²Kubernetesé›†ç¾¤</a>
      </div>
      
    </div>
  </div>
</div>
<script>
  // var escape = "[{&#34;content&#34;:&#34;&lt;p&gt;å¿«é€Ÿè®¿é—®é‡Œæœ‰ä¸ªDocumentsæ­»æ´»æ— æ³•å–æ¶ˆå›ºå®šï¼Œç‚¹äº†åˆè¯´ä¸å­˜åœ¨ï¼Œè®©åˆ åˆåˆ ä¸äº†ï¼Œleseã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;æ„Ÿè°¢å‚è€ƒé“¾æ¥çš„ä½œè€…ï¼Œè¯¥æ–¹æ³•æ•ˆè‹¥æ¡´é¼“ã€‚&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;æ³¨æ„äº‹é¡¹ï¼šè¯¥æ–¹æ³•ä¼šåˆ é™¤å¿«é€Ÿè®¿é—®é‡Œçš„æ‰€æœ‰å†…å®¹ï¼Œè€ƒè™‘æ¸…æ¥šå†åŠ¨æ‰‹ã€‚ï¼ˆæˆ‘çš„æœ¬æ¥å°±åªæœ‰æˆ‘çš„ç”µè„‘å’Œçƒ¦äººçš„é‚£é¡¹ï¼Œæ‰€ä»¥æœæ–­killï¼‰&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ol&gt;\n&lt;li&gt;æ‹·è´&lt;code&gt;%APPDATA%\\Microsoft\\Windows\\Recent\\AutomaticDestinations&lt;/code&gt;è‡³ è¿è¡Œ æˆ– æ–‡ä»¶å¤¹åœ°å€æ ï¼Œå›è½¦ï¼›&lt;/li&gt;\n&lt;li&gt;åˆ é™¤å…¶ä¸­æ–‡ä»¶&lt;code&gt;f01b4d95cf55d32a.automaticDestinations-ms&lt;/code&gt;ã€‚&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;DONEï¼Œæ•´ä¸ªä¸–ç•Œéƒ½æ¸…å‡€äº†ã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/yin0hao/article/details/88052343\&#34;&gt;Windows 10 å¿«é€Ÿè®¿é—®å¼‚å¸¸:æ— æ³•å–æ¶ˆå›ºå®š,çš„è§£å†³æ–¹æ³•&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;gan-diao-win10-wan-gu-bu-hua-de-mou-kuai-su-fang-wen-gu-ding-xiang&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;å¿«é€Ÿè®¿é—®é‡Œæœ‰ä¸ªDocumentsæ­»æ´»æ— æ³•å–æ¶ˆå›ºå®šï¼Œç‚¹äº†åˆè¯´ä¸å­˜åœ¨ï¼Œè®©åˆ åˆåˆ ä¸äº†ï¼Œleseã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;å¹²æ‰Win10é¡½å›ºä¸åŒ–çš„æŸå¿«é€Ÿè®¿é—®å›ºå®šé¡¹&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;å¿«é€Ÿè®¿é—®&#34;,&#34;slug&#34;:&#34;cjFtpCiKT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/cjFtpCiKT/&#34;},{&#34;name&#34;:&#34;å›ºå®šé¡¹&#34;,&#34;slug&#34;:&#34;rgLn904nQg&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/rgLn904nQg/&#34;},{&#34;name&#34;:&#34;åˆ é™¤&#34;,&#34;slug&#34;:&#34;SCrO3KRB6z&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/SCrO3KRB6z/&#34;},{&#34;name&#34;:&#34;win10&#34;,&#34;slug&#34;:&#34;1i227Aq-k&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/1i227Aq-k/&#34;}],&#34;date&#34;:&#34;2020-09-15 08:59:03&#34;,&#34;dateFormat&#34;:&#34;2020-09-15&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/gan-diao-win10-wan-gu-bu-hua-de-mou-kuai-su-fang-wen-gu-ding-xiang/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:33000,&#34;words&#34;:155,&#34;minutes&#34;:1},&#34;description&#34;:&#34;å¿«é€Ÿè®¿é—®é‡Œæœ‰ä¸ªDocumentsæ­»æ´»æ— æ³•å–æ¶ˆå›ºå®šï¼Œç‚¹äº†åˆè¯´ä¸å­˜åœ¨ï¼Œè®©åˆ åˆåˆ ä¸äº†ï¼Œleseã€‚\n\næ„Ÿè°¢å‚è€ƒé“¾æ¥çš„ä½œè€…ï¼Œè¯¥æ–¹æ³•æ•ˆè‹¥æ¡´é¼“ã€‚\n\næ³¨æ„äº‹é¡¹ï¼šè¯¥æ–¹æ³•ä¼šåˆ é™¤å¿«é€Ÿè®¿é—®é‡Œçš„æ‰€æœ‰å†…å®¹ï¼Œè€ƒè™‘æ¸…æ¥šå†åŠ¨æ‰‹ã€‚ï¼ˆæˆ‘çš„æœ¬æ¥å°±åªæœ‰æˆ‘çš„ç”µè„‘å’Œçƒ¦äººçš„é‚£é¡¹ï¼Œæ‰€ä»¥æœæ–­...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥çš„åŸå› æå¾—å®‰è£…èµ·æ¥å¤ªå¤æ‚äº†ï¼Œå¹¶ä¸”helmçš„prometheus operatorçš„charté¡¹ç›®è¿˜è¿ç§»è¿‡ï¼Œæ›´æœ‰ç‚¹äº‘é‡Œé›¾é‡Œã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;åˆ›å»ºä¸“ç”¨namespace\&#34;&gt;åˆ›å»ºä¸“ç”¨namespace&lt;/h1&gt;\n&lt;p&gt;å…ˆåˆ›å»ºä¸ªnamespaceæ¥ç”¨ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl create namespace monitoring\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;å•ç‹¬å®‰è£…crd\&#34;&gt;å•ç‹¬å®‰è£…CRD&lt;/h1&gt;\n&lt;p&gt;CRDå°±æ˜¯Custom Resource Definitionã€‚&lt;br&gt;\næœ¬æ¥åº”è¯¥æ˜¯&lt;code&gt;helm install kube-prometheus-stack&lt;/code&gt;çš„æ—¶å€™å°±èƒ½è£…ï¼Œbut as you know..&lt;br&gt;\né€šè¿‡ç§‘å­¦ä¸Šç½‘ï¼Œå…ˆä¸‹è½½yamlå†è¯´ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;# æ•´é½ç‚¹å„¿\nmkdir -p ~/helm/prometheus-operator\ncd ~/helm/prometheus-operator\n\n# ä¸‹è½½yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_alertmanagers.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_podmonitors.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_probes.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_prometheuses.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_prometheusrules.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_servicemonitors.yaml\ncurl -x http://192.168.127.1:58591 -fsSLO https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/master/example/prometheus-operator-crd/monitoring.coreos.com_thanosrulers.yaml\n\n# å®‰è£…\nkubectl apply -f .\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;å®‰è£…-kube-prometheus-stack\&#34;&gt;å®‰è£… kube-prometheus-stack&lt;/h1&gt;\n&lt;p&gt;kube-prometheus-stackåŸºäºprometheus-operatoråˆ¶ä½œï¼Œå¹¶é›†æˆäº†ä¾èµ–&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;stable/kube-state-metrics&lt;/li&gt;\n&lt;li&gt;stable/prometheus-node-exporter&lt;/li&gt;\n&lt;li&gt;grafana/grafana&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;# å®‰è£…\nhelm install kube-prometheus-stack prometheus-community/kube-prometheus-stack --set prometheusOperator.createCustomResource=false -n monitoring\n# æŸ¥çœ‹å®‰è£…æƒ…å†µ\nkubectl -n monitoring get deployments\nNAME                                       READY   UP-TO-DATE   AVAILABLE   AGE\nkube-prometheus-stack-grafana              1/1     1            1           4h30m\nkube-prometheus-stack-kube-state-metrics   1/1     1            1           4h30m\nkube-prometheus-stack-operator             1/1     1            1           4h30m\n\nkubectl -n monitoring get pods -owide\nNAME                                                        READY   STATUS    RESTARTS   AGE     IP                NODE           NOMINATED NODE   READINESS GATES\nalertmanager-kube-prometheus-stack-alertmanager-0           2/2     Running   2          4h14m   10.244.1.32       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-grafana-8b85d667c-5w8sn               2/2     Running   4          4h32m   10.244.2.23       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-kube-state-metrics-5cf575d8f8-6m7jt   1/1     Running   1          4h32m   10.244.1.33       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-operator-65fbd96bdb-9zhmz             2/2     Running   6          4h32m   10.244.2.21       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-68sxv        1/1     Running   2          4h32m   192.168.127.133   mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-864w9        1/1     Running   1          4h32m   192.168.127.132   ubuntuserver   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-nr274        1/1     Running   1          4h32m   192.168.127.134   mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nprometheus-kube-prometheus-stack-prometheus-0               3/3     Running   6          4h14m   10.244.2.22       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;é‡åˆ°é—®é¢˜å¾€åçœ‹ã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h1 id=\&#34;å®‰è£…è¿‡ç¨‹çš„troubleshooting\&#34;&gt;å®‰è£…è¿‡ç¨‹çš„Troubleshooting&lt;/h1&gt;\n&lt;p&gt;å®‰è£…è¿‡ç¨‹å„ç§æŠ¥é”™ï¼Œå½“ç„¶ä¸»è¦æ˜¯é•œåƒpullä¸ä¸‹æ¥ï¼Œå°¤å…¶æ˜¯&lt;code&gt;quay.io&lt;/code&gt;çš„é•œåƒã€‚(æˆ‘çš„æŒºå¥‡æ€ªï¼Œå±…ç„¶è‡ªå·±pullæˆåŠŸäº†å‡ ä¸ª&lt;code&gt;quay.io&lt;/code&gt;)&lt;/p&gt;\n&lt;h2 id=\&#34;æ’æŸ¥é—®é¢˜\&#34;&gt;æ’æŸ¥é—®é¢˜&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring describe pods prometheus-kube-prometheus-stack-prometheus-0\n\nEvents:\n  Type     Reason   Age                    From                  Message\n  ----     ------   ----                   ----                  -------\n  Normal   Pulling  60m (x4 over 83m)      kubelet, mini-centos  Pulling image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot;\n  Warning  Failed   58m (x4 over 79m)      kubelet, mini-centos  Failed to pull image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot;: rpc error: code = Unknown desc = context canceled\n  Warning  Failed   58m (x4 over 79m)      kubelet, mini-centos  Error: ErrImagePull\n  Normal   Pulling  58m (x5 over 100m)     kubelet, mini-centos  Pulling image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;\n  Normal   Pulled   47m                    kubelet, mini-centos  Successfully pulled image &amp;quot;quay.io/coreos/prometheus-config-reloader:v0.38.1&amp;quot; in 1m11.597994512s\n  Warning  Failed   22m (x11 over 83m)     kubelet, mini-centos  Error: ErrImagePull\n  Normal   BackOff  13m (x130 over 56m)    kubelet, mini-centos  Back-off pulling image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;\n  Warning  Failed   8m15s (x145 over 56m)  kubelet, mini-centos  Error: ImagePullBackOff\n  Warning  Failed   3m13s (x14 over 83m)   kubelet, mini-centos  Failed to pull image &amp;quot;quay.io/prometheus/prometheus:v2.18.2&amp;quot;: rpc error: code = Unknown desc = context canceled\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;è§£å†³\&#34;&gt;è§£å†³&lt;/h2&gt;\n&lt;p&gt;&lt;code&gt;google prometheus v2.18.2&lt;/code&gt;å±…ç„¶å‘ç°&lt;code&gt;docker hub&lt;/code&gt;é‡Œæœ‰ï¼Œäºæ˜¯åœ¨&lt;code&gt;mini-centos&lt;/code&gt;ä¸»æœºä¸Šï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;docker pull prom/prometheus:v2.18.2\nv2.18.2: Pulling from prom/prometheus\n0f8c40e1270f: Already exists \n626a2a3fee8c: Already exists \ndde61fbb486b: Already exists \n22b936665674: Downloading [=================================================&amp;gt; ]  20.66MB/20.76MB\nb9cb37b79bc0: Download complete \na14008f52cd5: Download complete \nc89901a55493: Waiting \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å°±å®šè¿™å„¿äº†ï¼Œé‚ç¥­èµ·é‡å¯dockerå¤§æ³•ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo systemctl restart docker\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;é‡å¯å®Œåï¼Œæ¥ç€ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;docker pull prom/prometheus:v2.18.2\nv2.18.2: Pulling from prom/prometheus\n0f8c40e1270f: Already exists \n626a2a3fee8c: Already exists \ndde61fbb486b: Already exists \n22b936665674: Pull complete \nb9cb37b79bc0: Pull complete \na14008f52cd5: Pull complete \nc89901a55493: Pull complete \n6caddd047c54: Pull complete \nddd1779460e5: Pull complete \nf65cc1a7f25d: Pull complete \n4be7bc9429a7: Pull complete \n2d296d78b122: Pull complete \nDigest: sha256:4d3303d1eb424e345cf48969bb7575d4d58472ad783ac41ea07fba92686f7ef5\nStatus: Downloaded newer image for prom/prometheus:v2.18.2\ndocker.io/prom/prometheus:v2.18.2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å†æ£€æŸ¥ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get pods -owide\nNAME                                                        READY   STATUS    RESTARTS   AGE     IP                NODE           NOMINATED NODE   READINESS GATES\nalertmanager-kube-prometheus-stack-alertmanager-0           2/2     Running   2          4h14m   10.244.1.32       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-grafana-8b85d667c-5w8sn               2/2     Running   4          4h32m   10.244.2.23       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-kube-state-metrics-5cf575d8f8-6m7jt   1/1     Running   1          4h32m   10.244.1.33       mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-operator-65fbd96bdb-9zhmz             2/2     Running   6          4h32m   10.244.2.21       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-68sxv        1/1     Running   2          4h32m   192.168.127.133   mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-864w9        1/1     Running   1          4h32m   192.168.127.132   ubuntuserver   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nkube-prometheus-stack-prometheus-node-exporter-nr274        1/1     Running   1          4h32m   192.168.127.134   mini-ubuntu    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\nprometheus-kube-prometheus-stack-prometheus-0               3/3     Running   6          4h14m   10.244.2.22       mini-centos    &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å…¨éƒ½readyäº†ã€‚&lt;br&gt;\nå¦‚æœ‰å…¶ä»–pullé—®é¢˜ï¼Œåº”è¯¥å¯ä»¥å¦‚æ³•ç‚®åˆ¶ã€‚&lt;/p&gt;\n&lt;h1 id=\&#34;æš´éœ²æœåŠ¡\&#34;&gt;æš´éœ²æœåŠ¡&lt;/h1&gt;\n&lt;h2 id=\&#34;æŸ¥çœ‹æœåŠ¡\&#34;&gt;æŸ¥çœ‹æœåŠ¡&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get svc\nNAME                                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE\nalertmanager-operated                            ClusterIP   None             &amp;lt;none&amp;gt;        9093/TCP,9094/TCP,9094/UDP   4h16m\nkube-prometheus-stack-alertmanager               ClusterIP   10.101.245.140   &amp;lt;none&amp;gt;        9093/TCP                     4h34m\nkube-prometheus-stack-grafana                    ClusterIP   10.106.193.98    &amp;lt;none&amp;gt;        80/TCP                       4h34m\nkube-prometheus-stack-kube-state-metrics         ClusterIP   10.108.208.70    &amp;lt;none&amp;gt;        8080/TCP                     4h34m\nkube-prometheus-stack-operator                   ClusterIP   10.110.217.187   &amp;lt;none&amp;gt;        8080/TCP,443/TCP             4h34m\nkube-prometheus-stack-prometheus                 ClusterIP   10.104.189.224   &amp;lt;none&amp;gt;        9090/TCP                     4h34m\nkube-prometheus-stack-prometheus-node-exporter   ClusterIP   10.102.189.12    &amp;lt;none&amp;gt;        9100/TCP                     4h34m\nprometheus-operated                              ClusterIP   None             &amp;lt;none&amp;gt;        9090/TCP                     4h16m\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ”¹nodeport\&#34;&gt;æ”¹NodePort&lt;/h2&gt;\n&lt;p&gt;æŠŠä¸‹é¢æœåŠ¡çš„typeæ”¹æˆNodePortï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring edit svc kube-prometheus-stack-prometheus\nkubectl -n monitoring edit svc kube-prometheus-stack-alertmanager\nkubectl -n monitoring edit svc kube-prometheus-stack-grafana\n\nkubectl -n monitoring get svc\nNAME                                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE\nalertmanager-operated                            ClusterIP   None             &amp;lt;none&amp;gt;        9093/TCP,9094/TCP,9094/UDP   4h51m\nkube-prometheus-stack-alertmanager               NodePort    10.101.245.140   &amp;lt;none&amp;gt;        9093:31386/TCP               5h9m\nkube-prometheus-stack-grafana                    NodePort    10.106.193.98    &amp;lt;none&amp;gt;        80:30835/TCP                 5h9m\nkube-prometheus-stack-kube-state-metrics         ClusterIP   10.108.208.70    &amp;lt;none&amp;gt;        8080/TCP                     5h9m\nkube-prometheus-stack-operator                   ClusterIP   10.110.217.187   &amp;lt;none&amp;gt;        8080/TCP,443/TCP             5h9m\nkube-prometheus-stack-prometheus                 NodePort    10.104.189.224   &amp;lt;none&amp;gt;        9090:30098/TCP               5h9m\nkube-prometheus-stack-prometheus-node-exporter   ClusterIP   10.102.189.12    &amp;lt;none&amp;gt;        9100/TCP                     5h9m\nprometheus-operated                              ClusterIP   None             &amp;lt;none&amp;gt;        9090/TCP                     4h51m\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;è®¿é—®prometheus\&#34;&gt;è®¿é—®prometheus&lt;/h1&gt;\n&lt;p&gt;æ‰“å¼€http://192.168.127.132:30098/targetsï¼Œä¸€éƒ¨åˆ†upä¸€éƒ¨åˆ†downï¼Œç‚¹Unhealthy&lt;br&gt;\n&lt;img src=\&#34;https://tomhht.github.io/post-images/1600245194725.png\&#34; alt=\&#34;unhealthy\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;è§£å†³downçš„éƒ¨åˆ†\&#34;&gt;è§£å†³downçš„éƒ¨åˆ†&lt;/h2&gt;\n&lt;h3 id=\&#34;etcdçš„down\&#34;&gt;etcdçš„down&lt;/h3&gt;\n&lt;blockquote&gt;\n&lt;p&gt;æäº†1.5å¤©ï¼Œæœåˆ°çš„å„ç§èµ„æ–™éƒ½æ— æ³•é€‚ç”¨ï¼Œç»“åˆå„å®¶ä¹‹è¨€ï¼Œå†æ— æ•°æ¬¡å°è¯•æ‰å‹‰å¼ºæœ‰ç»“æœã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/etcd.yaml\n# æ‰¾åˆ°\n- --listen-client-urls=https://127.0.0.1:2379,https://192.168.127.132:2379\n# ä¿®æ”¹ä¸º\n- --listen-client-urls=https://0.0.0.0:2379,http://0.0.0.0:2379\n# é‡å¯å…¨éƒ¨containerï¼ˆå®é™…ä¸Šæ˜¯åœæ­¢å‘½ä»¤ï¼Œk8sä¼šè‡ªåŠ¨å…¨éƒ¨å¯åŠ¨ï¼‰\ndocker stop $(docker ps -q)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;æŒºå¥‡è‘©çš„ä¸€ç‚¹æ˜¯ï¼Œdownå˜ä¸ºupåï¼Œæˆ‘åˆæ”¹å›åŸé…ç½®ï¼Œå†é‡å¯å…¨éƒ¨containerï¼Œä¾ç„¶ä¿æŒupçŠ¶æ€ï¼Œå­˜ç–‘ingã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&#34;kube-schedulerçš„down\&#34;&gt;kube-schedulerçš„down&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/kube-scheduler.yaml\n//æ”¹ä¸º- --bind-address=0.0.0.0\n//åˆ è¡Œ- --port=0\n//ç¨ç­‰å‡ ç§’å³å¯\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;è¿™ä¸ªè¦ç‰¹åˆ«æ„Ÿè°¢åº¦å¨˜å¸®æˆ‘æœåˆ°çš„&lt;a href=\&#34;https://llovewxm1314.blog.csdn.net/article/details/108458197\&#34;&gt;è§£å†³kubernetes:v1.18.6-1.19.0 get cs127.0.0.1 connection refusedé”™è¯¯&lt;/a&gt;ã€‚ä¸€ä¸ªportä½ è¯´ä½ é»˜è®¤ç­‰äº0å¹²å•¥ï¼Œä½ è‡ªå·±éƒ½unhealthyä½ è¯´prometheuså“ªå„¿èƒ½ç›‘æ§å¾—åˆ°ã€‚æ„Ÿè°¢åŸä½œè€…ï¼Œnä¸ªå°æ—¶åç»ˆäºç ´æ¡ˆã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&#34;kube-controller-managerçš„down\&#34;&gt;kube-controller-managerçš„down&lt;/h3&gt;\n&lt;p&gt;ä¿®æ”¹å¥—è·¯åŒkube-schedulerã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo vim /etc/kubernetes/manifests/kube-controller-manager.yaml\n//æ”¹ä¸º- --bind-address=0.0.0.0\n//åˆ è¡Œ- --port=0\n//ç¨ç­‰å‡ ç§’å³å¯\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;node-exporterçš„down\&#34;&gt;node-exporterçš„down&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring edit ds kube-prometheus-stack-prometheus-node-exporter\n//åˆ æ‰ hostNetwork: true ä¸€è¡Œ\n//ç¨ç­‰å‡ ç§’å³å¯\n//è¿˜æ²¡å°è¯•helmç»™å‚æ•°çš„æ–¹å¼ï¼Œæœ‰æœºä¼šè¯•è¯•override the hostNetwork setting using a values file with -f option\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;ç‰¹åˆ«æ„Ÿè°¢googleæ¥çš„&lt;a href=\&#34;https://vividcode.io/fix-context-deadline-exceeded-error-in-prometheus-operator/\&#34;&gt;Fix Context Deadline Exceeded Error in Prometheus Operator&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&#34;kube-proxyçš„downå°šæœªæå®š\&#34;&gt;kube-proxyçš„downï¼ˆå°šæœªæå®šï¼‰&lt;/h3&gt;\n&lt;p&gt;æš‚æ—¶è·³è¿‡ï¼Œå¿«å´©æºƒäº†ï¼ˆäººï¼‰ï¼Œä¸‹é¢çš„æ–¹æ³•ç”¨äº†æ ¹æœ¬ä¸è¡Œï¼Œgoogle bing baidué½ä¸Šé˜µï¼Œå‰å‰ååå¾—æäº†1å¤©ã€‚å¥½å¿ƒçš„å“ªä½ï¼Œè¯·å¸®å¿™ç•™è¨€æä¾›è§£å†³åŠæ³•ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;# å¯èƒ½ç”¨å¾—åˆ°çš„æŒ‡ä»¤\nkubectl -n kube-system edit cm kube-proxy  //æ”¹metricsBindAddress: ä¸º 0.0.0.0:10249\nkubectl delete pod -l k8s-app=kube-proxy -n kube-system\n// æŒ‰ä¸Šé¢çš„æ“ä½œï¼Œå®Œå…¨æ²¡æ•ˆæœï¼Œæ™•\nsudo netstat -ntlp | grep kube\nsudo ss -ntlp | grep kube\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;è¿™æ˜¯ç¬¬ä¸€ä¸ªå¼€å§‹æçš„ï¼Œç»“æœå…¶ä»–éƒ½æå®šäº†ï¼Œå®ƒè¿˜å²¿ç„¶ä¸åŠ¨ã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h1 id=\&#34;grafanaç¯‡ç« \&#34;&gt;Grafanaç¯‡ç« &lt;/h1&gt;\n&lt;p&gt;kube-prometheus-stacké‡Œå·²ç»è‡ªå¸¦Grafanaï¼Œå› æ­¤æ— éœ€å®‰è£…ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;è®¿é—®grafana\&#34;&gt;è®¿é—®grafana&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n monitoring get svc //æ‰¾åˆ°grafanaçš„ç«¯å£ï¼Œç„¶åæµè§ˆå™¨è®¿é—®http://IP:PORT\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;ç”¨æˆ·å/å¯†ç æ˜¯ï¼Ÿ&lt;/strong&gt;&lt;br&gt;\nä¸€å †è¯´&lt;code&gt;admin/admin&lt;/code&gt;çš„ï¼Œç„¶è€Œè¿™ä¸ªç¯å¢ƒä¸é€‚ç”¨ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;ç”¨æˆ·åï¼šadmin\nå¯†ç ï¼šprom-operator\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;ç‰¹åˆ«æ„Ÿè°¢&lt;a href=\&#34;https://devstack.in/2020/05/25/deploy-prometheus-operator-with-helm3-and-private-registry/\&#34;&gt;Deploy Prometheus Operator with Helm3 and Private Registry&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;&lt;strong&gt;æ¼‚äº®&lt;/strong&gt;&lt;br&gt;\n&lt;img src=\&#34;https://tomhht.github.io/post-images/1600249518889.png\&#34; alt=\&#34;UI\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;strong&gt;åœ¨Manageé‡Œéšä¾¿é€‰ä¸€ä¸ª&lt;/strong&gt;&lt;br&gt;\n&lt;img src=\&#34;https://tomhht.github.io/post-images/1600250887179.png\&#34; alt=\&#34;magic\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;https://tomhht.github.io/post-images/1600249787073.png\&#34; alt=\&#34;gorgeous\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack\&#34;&gt;https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://github.com/prometheus-operator/prometheus-operator\&#34;&gt;https://github.com/prometheus-operator/prometheus-operator&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://github.com/prometheus-operator/kube-prometheus\&#34;&gt;https://github.com/prometheus-operator/kube-prometheus&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.bookstack.cn/read/kubernetes-learning-0.2.0/docs-58.Prometheus%20Operator.md\&#34;&gt;https://www.bookstack.cn/read/kubernetes-learning-0.2.0/docs-58.Prometheus%20Operator.md&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.qikqiak.com/post/prometheus-operator-monitor-etcd/\&#34;&gt;https://www.qikqiak.com/post/prometheus-operator-monitor-etcd/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.fleeto.us/post/node-downtime/\&#34;&gt;https://blog.fleeto.us/post/node-downtime/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://llovewxm1314.blog.csdn.net/article/details/108458197\&#34;&gt;è§£å†³kubernetes:v1.18.6-1.19.0 get cs127.0.0.1 connection refusedé”™è¯¯&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://vividcode.io/fix-context-deadline-exceeded-error-in-prometheus-operator/\&#34;&gt;Fix Context Deadline Exceeded Error in Prometheus Operator&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://devstack.in/2020/05/25/deploy-prometheus-operator-with-helm3-and-private-registry/\&#34;&gt;Deploy Prometheus Operator with Helm3 and Private Registry&lt;/a&gt;&lt;br&gt;\nç¨åé˜…è¯»ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.qikqiak.com/post/k8s-hpa-usage/\&#34;&gt;Kubernetes HPA ä½¿ç”¨è¯¦è§£&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.51cto.com/14143894/2438026\&#34;&gt;Kubernetesè¿ç»´ä¹‹ä½¿ç”¨Prometheuså…¨æ–¹ä½ç›‘æ§K8S&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;an-zhuang-prometheus-operator&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥çš„åŸå› æå¾—å®‰è£…èµ·æ¥å¤ªå¤æ‚äº†ï¼Œå¹¶ä¸”helmçš„prometheus operatorçš„charté¡¹ç›®è¿˜è¿ç§»è¿‡ï¼Œæ›´æœ‰ç‚¹äº‘é‡Œé›¾é‡Œã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;helmå®‰è£…kube-prometheus-stack&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;helm&#34;,&#34;slug&#34;:&#34;wZ5maZQyf&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/wZ5maZQyf/&#34;},{&#34;name&#34;:&#34;prometheus&#34;,&#34;slug&#34;:&#34;PM-ekRSbhz&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/PM-ekRSbhz/&#34;},{&#34;name&#34;:&#34;prometheus operator&#34;,&#34;slug&#34;:&#34;9k4vb02qe6&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/9k4vb02qe6/&#34;},{&#34;name&#34;:&#34;kubernetes&#34;,&#34;slug&#34;:&#34;9iWQqlqnT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/9iWQqlqnT/&#34;},{&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;waCBSEanF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/waCBSEanF/&#34;}],&#34;date&#34;:&#34;2020-09-13 17:45:34&#34;,&#34;dateFormat&#34;:&#34;2020-09-13&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/an-zhuang-prometheus-operator/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;13 min read&#34;,&#34;time&#34;:740000,&#34;words&#34;:2269,&#34;minutes&#34;:13},&#34;description&#34;:&#34;ä¼—æ‰€å‘¨çŸ¥çš„åŸå› æå¾—å®‰è£…èµ·æ¥å¤ªå¤æ‚äº†ï¼Œå¹¶ä¸”helmçš„prometheus operatorçš„charté¡¹ç›®è¿˜è¿ç§»è¿‡ï¼Œæ›´æœ‰ç‚¹äº‘é‡Œé›¾é‡Œã€‚\n\nåˆ›å»ºä¸“ç”¨namespace\nå…ˆåˆ›å»ºä¸ªnamespaceæ¥ç”¨ã€‚\nkubectl create namespa...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BA%E4%B8%93%E7%94%A8namespace\&#34;&gt;åˆ›å»ºä¸“ç”¨namespace&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8D%95%E7%8B%AC%E5%AE%89%E8%A3%85crd\&#34;&gt;å•ç‹¬å®‰è£…CRD&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85-kube-prometheus-stack\&#34;&gt;å®‰è£… kube-prometheus-stack&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B%E7%9A%84troubleshooting\&#34;&gt;å®‰è£…è¿‡ç¨‹çš„Troubleshooting&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%92%E6%9F%A5%E9%97%AE%E9%A2%98\&#34;&gt;æ’æŸ¥é—®é¢˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E5%86%B3\&#34;&gt;è§£å†³&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9A%B4%E9%9C%B2%E6%9C%8D%E5%8A%A1\&#34;&gt;æš´éœ²æœåŠ¡&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1\&#34;&gt;æŸ¥çœ‹æœåŠ¡&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%94%B9nodeport\&#34;&gt;æ”¹NodePort&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BF%E9%97%AEprometheus\&#34;&gt;è®¿é—®prometheus&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E5%86%B3down%E7%9A%84%E9%83%A8%E5%88%86\&#34;&gt;è§£å†³downçš„éƒ¨åˆ†&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#etcd%E7%9A%84down\&#34;&gt;etcdçš„down&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#kube-scheduler%E7%9A%84down\&#34;&gt;kube-schedulerçš„down&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#kube-controller-manager%E7%9A%84down\&#34;&gt;kube-controller-managerçš„down&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#node-exporter%E7%9A%84down\&#34;&gt;node-exporterçš„down&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#kube-proxy%E7%9A%84down%E5%B0%9A%E6%9C%AA%E6%90%9E%E5%AE%9A\&#34;&gt;kube-proxyçš„downï¼ˆå°šæœªæå®šï¼‰&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#grafana%E7%AF%87%E7%AB%A0\&#34;&gt;Grafanaç¯‡ç« &lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BF%E9%97%AEgrafana\&#34;&gt;è®¿é—®grafana&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æœ€å°åŒ–å®‰è£…centos 8åçš„è®¾ç½®ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;æ›´æ¢å›½å†…æº\&#34;&gt;æ›´æ¢å›½å†…æº&lt;/h1&gt;\n&lt;p&gt;å‚è€ƒ&lt;a href=\&#34;/post/pei-zhi-ubuntu-he-centos-qing-hua-yuan\&#34;&gt;é…ç½®æ¸…åæº&lt;/a&gt;&lt;/p&gt;\n&lt;h1 id=\&#34;å®‰è£…epel\&#34;&gt;å®‰è£…epel&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo yum install epel-release\n# æ›´æ¢æ¸…åæº\nsudo sed -e &#39;s!^metalink=!#metalink=!g&#39; \\\n    -e &#39;s!^#baseurl=!baseurl=!g&#39; \\\n    -e &#39;s!//download\\.fedoraproject\\.org/pub!//mirrors.tuna.tsinghua.edu.cn!g&#39; \\\n    -e &#39;s!http://mirrors\\.tuna!https://mirrors.tuna!g&#39; \\\n    -i /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel-testing.repo\nsudo yum makecache\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;æ›´æ–°è½¯ä»¶\&#34;&gt;æ›´æ–°è½¯ä»¶&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;yum check-update\nsudo yum upgrade\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;è®¾ç½®æ—¶åŒºå’Œntp\&#34;&gt;è®¾ç½®æ—¶åŒºå’ŒNTP&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;timedatectl set-timezone Asia/Shanghai\nsudo yum install chrony\nsudo systemctl enable --now chronyd\ntimedatectl status\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;è‡ªåŠ¨è¡¥å…¨\&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo yum install bash-completion\nsource ~/.bashrc\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;å®‰è£…wget\&#34;&gt;å®‰è£…wget&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo yum -y install wget\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;å…¶ä»–æœ‰ç”¨çš„è®°å½•\&#34;&gt;å…¶ä»–æœ‰ç”¨çš„è®°å½•&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;# æ‰¾ç¨‹åºæ‰€å±çš„åŒ…\nyum whatprovides netstat\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/fengdejiyixx/p/11592417.html\&#34;&gt;Centoså’ŒUbuntuç³»ç»Ÿæœ€å°åŒ–å®‰è£…åŸºç¡€å‘½ä»¤&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://linuxconfig.org/ubuntu-20-04-server-installation\&#34;&gt;Ubuntu 20.04 Server Installation&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;zui-xiao-hua-an-zhuang-centos-hou-de-she-zhi&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æœ€å°åŒ–å®‰è£…centos 8åçš„è®¾ç½®ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;æœ€å°åŒ–å®‰è£…centoså’Œubuntuä¹‹åçš„é…ç½®&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;ubuntu&#34;,&#34;slug&#34;:&#34;kQqN5ubkh&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/kQqN5ubkh/&#34;},{&#34;name&#34;:&#34;yum&#34;,&#34;slug&#34;:&#34;61caeLjRp&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/61caeLjRp/&#34;},{&#34;name&#34;:&#34;dnf&#34;,&#34;slug&#34;:&#34;k6OySQa9SB&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/k6OySQa9SB/&#34;},{&#34;name&#34;:&#34;å›½å†…æº&#34;,&#34;slug&#34;:&#34;AVam_YHxdq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/AVam_YHxdq/&#34;},{&#34;name&#34;:&#34;é…ç½®&#34;,&#34;slug&#34;:&#34;Bwz1BaTtzi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Bwz1BaTtzi/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;}],&#34;date&#34;:&#34;2020-09-10 18:54:55&#34;,&#34;dateFormat&#34;:&#34;2020-09-10&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/zui-xiao-hua-an-zhuang-centos-hou-de-she-zhi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:53000,&#34;words&#34;:176,&#34;minutes&#34;:1},&#34;description&#34;:&#34;æœ€å°åŒ–å®‰è£…centos 8åçš„è®¾ç½®ã€‚\n\næ›´æ¢å›½å†…æº\nå‚è€ƒé…ç½®æ¸…åæº\nå®‰è£…epel\nsudo yum install epel-release\n# æ›´æ¢æ¸…åæº\nsudo sed -e &#39;s!^metalink=!#metalink=!g&#39; \\...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E6%BA%90\&#34;&gt;æ›´æ¢å›½å†…æº&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85epel\&#34;&gt;å®‰è£…epel&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9B%B4%E6%96%B0%E8%BD%AF%E4%BB%B6\&#34;&gt;æ›´æ–°è½¯ä»¶&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA%E5%92%8Cntp\&#34;&gt;è®¾ç½®æ—¶åŒºå’ŒNTP&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8\&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85wget\&#34;&gt;å®‰è£…wget&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B6%E4%BB%96%E6%9C%89%E7%94%A8%E7%9A%84%E8%AE%B0%E5%BD%95\&#34;&gt;å…¶ä»–æœ‰ç”¨çš„è®°å½•&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;å‘ç°libvirt/imagesä¸‹æœ‰ä¸ªqcow2æ–‡ä»¶æŒºå¤§ï¼Œäºæ˜¯æƒ³ç”¨virshå®‰å…¨åˆ æ‰ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;åˆ—å‡ºè™šæ‹Ÿæœº\&#34;&gt;åˆ—å‡ºè™šæ‹Ÿæœº&lt;/h1&gt;\n&lt;p&gt;å¼€å§‹æ²¡ç”¨sudoï¼Œç»“æœå•¥éƒ½æ²¡æœ‰ï¼Œæ˜æ˜è®°å¾—ä¹‹å‰æè¿‡ä¿©å‘¢ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo virsh list --all\n Id    Name                           State\n----------------------------------------------------\n -     vm1                            shut off\n -     vm2                            shut off\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;æ£€æŸ¥è™šæ‹Ÿæœºé…ç½®\&#34;&gt;æ£€æŸ¥è™šæ‹Ÿæœºé…ç½®&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo virsh dumpxml vm1 | grep &#39;source file&#39;\n    &amp;lt;source file=&#39;/var/lib/libvirt/images/cirros-0.5.1-x86_64-disk.img&#39;/&amp;gt;\n    &amp;lt;source file=&#39;/var/lib/libvirt/images/vm1.qcow2&#39;/&amp;gt; #è¦åˆ è¿™ä¸ª\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;ç¼–è¾‘é…ç½®\&#34;&gt;ç¼–è¾‘é…ç½®&lt;/h1&gt;\n&lt;p&gt;ç¡®ä¿è¯¥è™šæ‹Ÿæœºæœªè¿è¡Œã€‚åˆ é™¤é…ç½®ä¸­æŒ‚è½½&lt;code&gt;vm1.qcow2&lt;/code&gt;çš„æ®µè½ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo virsh edit vm1\n# åˆ é™¤è¿™æ®µ\n    &amp;lt;disk type=&#39;file&#39; device=&#39;disk&#39;&amp;gt;\n      &amp;lt;driver name=&#39;qemu&#39; type=&#39;qcow2&#39;/&amp;gt;\n      &amp;lt;source file=&#39;/var/lib/libvirt/images/vm1.qcow2&#39;/&amp;gt;\n      &amp;lt;target dev=&#39;hda&#39; bus=&#39;ide&#39;/&amp;gt;\n      &amp;lt;address type=&#39;drive&#39; controller=&#39;0&#39; bus=&#39;0&#39; target=&#39;0&#39; unit=&#39;1&#39;/&amp;gt;\n    &amp;lt;/disk&amp;gt; \n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;åˆ é™¤æ–‡ä»¶\&#34;&gt;åˆ é™¤æ–‡ä»¶&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo rm /var/lib/libvirt/images/vm1.qcow2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æå®šã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://huataihuang.gitbooks.io/cloud-atlas/content/virtual/kvm/startup/in_action/delete_a_running_vm_on_kvm.html\&#34;&gt;ä½¿ç”¨virshåˆ é™¤è¿è¡Œçš„KVM VM Â· Cloud Atlas&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.jianshu.com/p/5111134452a8\&#34;&gt;KVMç£ç›˜æ‰©å®¹å’Œæ·»åŠ &lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;shi-yong-virsh-shan-chu-kvm-xu-ni-ji&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;å‘ç°libvirt/imagesä¸‹æœ‰ä¸ªqcow2æ–‡ä»¶æŒºå¤§ï¼Œäºæ˜¯æƒ³ç”¨virshå®‰å…¨åˆ æ‰ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;ä½¿ç”¨virshåˆ é™¤kvmè™šæ‹Ÿæœº&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;virsh&#34;,&#34;slug&#34;:&#34;bUCnN5mej&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/bUCnN5mej/&#34;},{&#34;name&#34;:&#34;libvirt&#34;,&#34;slug&#34;:&#34;9_9Hadrd_e&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/9_9Hadrd_e/&#34;},{&#34;name&#34;:&#34;image&#34;,&#34;slug&#34;:&#34;j67cApQSbW&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/j67cApQSbW/&#34;},{&#34;name&#34;:&#34;kvm&#34;,&#34;slug&#34;:&#34;LEZftXqp1g&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/LEZftXqp1g/&#34;},{&#34;name&#34;:&#34;vm&#34;,&#34;slug&#34;:&#34;xUsIJSwbqY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/xUsIJSwbqY/&#34;},{&#34;name&#34;:&#34;åˆ é™¤&#34;,&#34;slug&#34;:&#34;SCrO3KRB6z&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/SCrO3KRB6z/&#34;},{&#34;name&#34;:&#34;delete&#34;,&#34;slug&#34;:&#34;RGCjJupI7z&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/RGCjJupI7z/&#34;},{&#34;name&#34;:&#34;remove&#34;,&#34;slug&#34;:&#34;NOWugYtRFw&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/NOWugYtRFw/&#34;},{&#34;name&#34;:&#34;è™šæ‹Ÿæœº&#34;,&#34;slug&#34;:&#34;tvA3wOlzOa&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/tvA3wOlzOa/&#34;},{&#34;name&#34;:&#34;ç¡¬ç›˜&#34;,&#34;slug&#34;:&#34;ruGPvEEk15&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/ruGPvEEk15/&#34;}],&#34;date&#34;:&#34;2020-09-10 14:21:16&#34;,&#34;dateFormat&#34;:&#34;2020-09-10&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/shi-yong-virsh-shan-chu-kvm-xu-ni-ji/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:63000,&#34;words&#34;:219,&#34;minutes&#34;:2},&#34;description&#34;:&#34;å‘ç°libvirt/imagesä¸‹æœ‰ä¸ªqcow2æ–‡ä»¶æŒºå¤§ï¼Œäºæ˜¯æƒ³ç”¨virshå®‰å…¨åˆ æ‰ã€‚\n\nåˆ—å‡ºè™šæ‹Ÿæœº\nå¼€å§‹æ²¡ç”¨sudoï¼Œç»“æœå•¥éƒ½æ²¡æœ‰ï¼Œæ˜æ˜è®°å¾—ä¹‹å‰æè¿‡ä¿©å‘¢ã€‚\nsudo virsh list --all\n Id    Name        ...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%97%E5%87%BA%E8%99%9A%E6%8B%9F%E6%9C%BA\&#34;&gt;åˆ—å‡ºè™šæ‹Ÿæœº&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%85%8D%E7%BD%AE\&#34;&gt;æ£€æŸ¥è™šæ‹Ÿæœºé…ç½®&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BC%96%E8%BE%91%E9%85%8D%E7%BD%AE\&#34;&gt;ç¼–è¾‘é…ç½®&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6\&#34;&gt;åˆ é™¤æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;å‘½ä»¤æŒºç®€å•ï¼Œå°±æ˜¯é€Ÿåº¦å¾ˆæ„Ÿäººã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;å®‰è£…\&#34;&gt;å®‰è£…&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo snap install helm --classic\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å®‰è£…è¿‡æ…¢çš„è§£å†³åŠæ³•è¿˜æ²¡å°è¯•ï¼Œå‚è€ƒé“¾æ¥å…ˆè®°å½•ä¸‹æ¥äº†ï¼Œå…ˆè°¢è°¢åŸä½œè€…ã€‚&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;æ®å®˜æ–¹è¯´æ˜ï¼ŒHelm 3å·²ç»ä¸éœ€è¦Tilleräº†ï¼Œæ‰€ä»¥å…¶ä»–å‚è€ƒèµ„æ–™ä¸Šå®‰è£…Tillerçš„æ­¥éª¤ç›´æ¥è·³è¿‡ã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h1 id=\&#34;é…ç½®\&#34;&gt;é…ç½®&lt;/h1&gt;\n&lt;h2 id=\&#34;è‡ªåŠ¨è¡¥å…¨\&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;echo &#39;source &amp;lt;(helm completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc\nsource ~/.bashrc #ä½¿é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://helm.sh/\&#34;&gt;Helmå®˜æ–¹&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://kuricat.com/gist/snap-install-too-slow-zmbjy\&#34;&gt;snap install è¿‡æ…¢ çš„è§£å†³æ–¹æ³• @Kurisu&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;zai-ubuntu-shang-yong-snap-an-zhuang-helm&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;å‘½ä»¤æŒºç®€å•ï¼Œå°±æ˜¯é€Ÿåº¦å¾ˆæ„Ÿäººã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;åœ¨Ubuntuä¸Šç”¨snapå®‰è£…Helm&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;snap&#34;,&#34;slug&#34;:&#34;NDIcn-UIx&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/NDIcn-UIx/&#34;},{&#34;name&#34;:&#34;Helm&#34;,&#34;slug&#34;:&#34;lWU6BYd7-O&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/lWU6BYd7-O/&#34;},{&#34;name&#34;:&#34;Tiller&#34;,&#34;slug&#34;:&#34;qSw6tN1oLG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qSw6tN1oLG/&#34;},{&#34;name&#34;:&#34;å®‰è£…&#34;,&#34;slug&#34;:&#34;Q8BfV1d_Wf&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Q8BfV1d_Wf/&#34;},{&#34;name&#34;:&#34;é…ç½®&#34;,&#34;slug&#34;:&#34;Bwz1BaTtzi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Bwz1BaTtzi/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;}],&#34;date&#34;:&#34;2020-09-07 16:45:29&#34;,&#34;dateFormat&#34;:&#34;2020-09-07&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/zai-ubuntu-shang-yong-snap-an-zhuang-helm/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:28000,&#34;words&#34;:121,&#34;minutes&#34;:1},&#34;description&#34;:&#34;å‘½ä»¤æŒºç®€å•ï¼Œå°±æ˜¯é€Ÿåº¦å¾ˆæ„Ÿäººã€‚\n\nå®‰è£…\nsudo snap install helm --classic\n\nå®‰è£…è¿‡æ…¢çš„è§£å†³åŠæ³•è¿˜æ²¡å°è¯•ï¼Œå‚è€ƒé“¾æ¥å…ˆè®°å½•ä¸‹æ¥äº†ï¼Œå…ˆè°¢è°¢åŸä½œè€…ã€‚\n\næ®å®˜æ–¹è¯´æ˜ï¼ŒHelm 3å·²ç»ä¸éœ€è¦Tilleräº†ï¼Œæ‰€ä»¥å…¶ä»–å‚è€ƒèµ„æ–™...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85\&#34;&gt;å®‰è£…&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%85%8D%E7%BD%AE\&#34;&gt;é…ç½®&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8\&#34;&gt;è‡ªåŠ¨è¡¥å…¨&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;å­¦ä¹ nfsçš„é…ç½®ï¼Œå¹¶æµ‹è¯•k8séƒ¨ç½²mysqlæŒ‚è½½nfsçš„æ–¹å¼ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;é…ç½®nfs\&#34;&gt;é…ç½®nfs&lt;/h1&gt;\n&lt;h2 id=\&#34;ubuntu\&#34;&gt;Ubuntu&lt;/h2&gt;\n&lt;p&gt;å…ˆå°†å‚è€ƒé“¾æ¥æ”¾è¿™å„¿ã€‚&lt;a href=\&#34;https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-20-04\&#34;&gt;How To Set Up an NFS Mount on Ubuntu 20.04&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;centos\&#34;&gt;CentOS&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&#34;https://qizhanming.com/blog/2018/08/08/how-to-install-nfs-on-centos-7\&#34;&gt;CentOS 7 ä¸‹ yum å®‰è£…å’Œé…ç½® NFS&lt;/a&gt;&lt;/p&gt;\n&lt;h1 id=\&#34;k8sæµ‹è¯•é‡åˆ°çš„é—®é¢˜\&#34;&gt;k8sæµ‹è¯•é‡åˆ°çš„é—®é¢˜&lt;/h1&gt;\n&lt;h2 id=\&#34;é•œåƒpullä¸ä¸‹æ¥\&#34;&gt;é•œåƒpullä¸ä¸‹æ¥&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;é—®é¢˜æè¿°&lt;/strong&gt;&lt;br&gt;\næµ‹è¯•mysqlæŒ‚è½½nfså¤±è´¥äº†næ¬¡ï¼Œä¸€å¼€å§‹æ˜¯é•œåƒpullä¸ä¸‹æ¥ã€‚&lt;br&gt;\n&lt;strong&gt;è§£å†³&lt;/strong&gt;&lt;br&gt;\nåæ¥æ·»åŠ é˜¿é‡Œäº‘åŠ é€Ÿå™¨åé‡å¯nodeä¸Šçš„docker &lt;code&gt;sudo systemctl restart docker.service&lt;/code&gt;è§£å†³äº†pullçš„é—®é¢˜ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;podé‡åˆ°backoffçš„é”™è¯¯\&#34;&gt;podé‡åˆ°backoffçš„é”™è¯¯&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;é—®é¢˜æè¿°&lt;/strong&gt;&lt;br&gt;\npullä¸‹æ¥äº†è¿˜æ˜¯è¿è¡Œå¤±è´¥ï¼Œpodæ€»æ˜¯æ˜¾ç¤ºbackoff &lt;code&gt;Back-off restarting failed container&lt;/code&gt;çš„é”™è¯¯ï¼Œé€šè¿‡&lt;code&gt;kubectl logs &amp;lt;mysql podçš„åå­—&amp;gt;&lt;/code&gt;å‘ç°&lt;code&gt;chown: changing ownership of &#39;/var/lib/mysql/&#39;: Operation not permitted&lt;/code&gt;é”™è¯¯ã€‚&lt;br&gt;\n&lt;strong&gt;è§£å†³&lt;/strong&gt;&lt;br&gt;\nnfsé…ç½®æ–‡ä»¶&lt;code&gt;/etc/exports&lt;/code&gt;é‡Œï¼ŒåŠ ä¸Šäº†&lt;code&gt;no_root_squash&lt;/code&gt;çš„é€‰é¡¹ã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-20-04\&#34;&gt;How To Set Up an NFS Mount on Ubuntu 20.04&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://qizhanming.com/blog/2018/08/08/how-to-install-nfs-on-centos-7\&#34;&gt;CentOS 7 ä¸‹ yum å®‰è£…å’Œé…ç½® NFS&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;pei-zhi-nfs&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;å­¦ä¹ nfsçš„é…ç½®ï¼Œå¹¶æµ‹è¯•k8séƒ¨ç½²mysqlæŒ‚è½½nfsçš„æ–¹å¼ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;k8sæµ‹è¯•mysqlæŒ‚è½½nfsé‡åˆ°çš„é—®é¢˜&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;mysql&#34;,&#34;slug&#34;:&#34;NmeeKMdHz&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/NmeeKMdHz/&#34;},{&#34;name&#34;:&#34;æƒé™&#34;,&#34;slug&#34;:&#34;0eAyztTBAO&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/0eAyztTBAO/&#34;},{&#34;name&#34;:&#34;Centos&#34;,&#34;slug&#34;:&#34;EKOGZrskK&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/EKOGZrskK/&#34;},{&#34;name&#34;:&#34;nfs&#34;,&#34;slug&#34;:&#34;RznBLK3Uuv&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/RznBLK3Uuv/&#34;},{&#34;name&#34;:&#34;kubernetes&#34;,&#34;slug&#34;:&#34;9iWQqlqnT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/9iWQqlqnT/&#34;},{&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;waCBSEanF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/waCBSEanF/&#34;},{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;}],&#34;date&#34;:&#34;2020-09-06 15:50:41&#34;,&#34;dateFormat&#34;:&#34;2020-09-06&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/pei-zhi-nfs/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:56000,&#34;words&#34;:218,&#34;minutes&#34;:1},&#34;description&#34;:&#34;å­¦ä¹ nfsçš„é…ç½®ï¼Œå¹¶æµ‹è¯•k8séƒ¨ç½²mysqlæŒ‚è½½nfsçš„æ–¹å¼ã€‚\n\né…ç½®nfs\nUbuntu\nå…ˆå°†å‚è€ƒé“¾æ¥æ”¾è¿™å„¿ã€‚How To Set Up an NFS Mount on Ubuntu 20.04\nCentOS\nCentOS 7 ä¸‹ yum...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%85%8D%E7%BD%AEnfs\&#34;&gt;é…ç½®nfs&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#ubuntu\&#34;&gt;Ubuntu&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#centos\&#34;&gt;CentOS&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#k8s%E6%B5%8B%E8%AF%95%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98\&#34;&gt;k8sæµ‹è¯•é‡åˆ°çš„é—®é¢˜&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%95%9C%E5%83%8Fpull%E4%B8%8D%E4%B8%8B%E6%9D%A5\&#34;&gt;é•œåƒpullä¸ä¸‹æ¥&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#pod%E9%81%87%E5%88%B0backoff%E7%9A%84%E9%94%99%E8%AF%AF\&#34;&gt;podé‡åˆ°backoffçš„é”™è¯¯&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬çš„busyboxä¼šå‡ºç°nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜ã€‚ä½¿ç”¨1.28.3ç‰ˆæœ¬å³å¯è§£å†³ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;ç—‡çŠ¶ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl run busybox --rm -it --image=busybox /bin/sh\n/ # nslookup httpd-svc\nServer:\t\t10.96.0.10\nAddress:\t10.96.0.10:53\n\n** server can&#39;t find httpd-svc.default.svc.cluster.local: NXDOMAIN\n\n*** Can&#39;t find httpd-svc.svc.cluster.local: No answer\n*** Can&#39;t find httpd-svc.cluster.local: No answer\n*** Can&#39;t find httpd-svc.default.svc.cluster.local: No answer\n*** Can&#39;t find httpd-svc.svc.cluster.local: No answer\n*** Can&#39;t find httpd-svc.cluster.local: No answer\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è§£å†³ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl run busybox --rm -it --image=busybox:1.28.3 /bin/sh\nIf you don&#39;t see a command prompt, try pressing enter.\n/ # nslookup httpd-svc\nServer:    10.96.0.10\nAddress 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      httpd-svc\nAddress 1: 10.108.142.200 httpd-svc.default.svc.cluster.local\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/vincenshen/p/9751193.html\&#34;&gt;https://www.cnblogs.com/vincenshen/p/9751193.html&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;kubernetes-busybox-nslookup-ti-shi-wu-fa-jie-xi-de-wen-ti&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬çš„busyboxä¼šå‡ºç°nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜ã€‚ä½¿ç”¨1.28.3ç‰ˆæœ¬å³å¯è§£å†³ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Kubernetes busybox nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;kubernetes&#34;,&#34;slug&#34;:&#34;9iWQqlqnT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/9iWQqlqnT/&#34;},{&#34;name&#34;:&#34;busybox&#34;,&#34;slug&#34;:&#34;pGSOA5-CqP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pGSOA5-CqP/&#34;},{&#34;name&#34;:&#34;nslookup&#34;,&#34;slug&#34;:&#34;if1OeykrkL&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/if1OeykrkL/&#34;},{&#34;name&#34;:&#34;issue&#34;,&#34;slug&#34;:&#34;aBL_wWn2jh&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/aBL_wWn2jh/&#34;},{&#34;name&#34;:&#34;é—®é¢˜&#34;,&#34;slug&#34;:&#34;jDEmr4zvgG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/jDEmr4zvgG/&#34;},{&#34;name&#34;:&#34;è§£æ&#34;,&#34;slug&#34;:&#34;iEfP63FFtR&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/iEfP63FFtR/&#34;},{&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;waCBSEanF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/waCBSEanF/&#34;}],&#34;date&#34;:&#34;2020-09-05 15:43:38&#34;,&#34;dateFormat&#34;:&#34;2020-09-05&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/kubernetes-busybox-nslookup-ti-shi-wu-fa-jie-xi-de-wen-ti/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:64000,&#34;words&#34;:189,&#34;minutes&#34;:2},&#34;description&#34;:&#34;ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬çš„busyboxä¼šå‡ºç°nslookupæç¤ºæ— æ³•è§£æçš„é—®é¢˜ã€‚ä½¿ç”¨1.28.3ç‰ˆæœ¬å³å¯è§£å†³ã€‚\n\nç—‡çŠ¶ï¼š\nkubectl run busybox --rm -it --image=busybox /bin/sh\n/ # nslooku...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æ‹¿äº†æœ¬å¤§åŠå¹´äº†ï¼Œæ˜¨å¤©ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;å¤ªåˆºæ¿€äº†ã€‚ç”»é¾™ã€å‰è¹­ã€æ²¹åˆç¦»é—¨ï¼Œåº”æœ‰å°½æœ‰ã€‚ç§‘ä¸‰è€ƒäº†3æ¬¡æ‰è¿‡ï¼Œè€ƒè¿‡åæŠ½å¥–ä¸­äº†ä¸€ä¸ªé™ªç»ƒæœºä¼šï¼Œè·Ÿç€æ•™ç»ƒå¼€äº†è¶Ÿæ˜“å¿ï¼ˆåŒç»ƒçš„è¿˜æœ‰å…¶ä»–å­¦å‘˜ï¼‰ã€‚è¿™å°±æ˜¯ä¹‹å‰å…¨éƒ¨çš„å¼€è½¦ç»å†äº†ã€‚&lt;br /&gt;&lt;br&gt;\næ˜¨å¤©å› ä¸ºè¦æ¥ä¾„å­ï¼Œå­¦æ ¡åœ¨ä¸€ä¸ªé¸Ÿä¸æ‹‰å±çš„åœ°æ–¹ï¼Œçº¦ä¸åˆ°è½¦ï¼Œæ‰€ä»¥ç¡¬ç€å¤´çš®æŠŠå®¶é‡Œçš„è½¦å¼€å‡ºæ¥äº†ã€‚é¦–å…ˆæ‰¾åœ°æ–¹æ‰å¤´ï¼Œå…‰é¡¾ç€çœ‹åé¢ï¼Œç»“æœè½¦å¤´è¹­äººå®¶å¢™ä¸Šäº†ï¼Œå¼•å¾—äººå®¶å‡ºæ¥æ£€æŸ¥ã€‚&lt;br /&gt;&lt;br&gt;\nå¥½ä¸å®¹æ˜“æ‰å¥½å¤´ï¼Œè·Ÿåˆ«çš„è½¦äº¤æ±‡ï¼Œä¸€é—ªèº²ï¼Œå™Œï¼Œåˆæ˜¯ä¸€å£°ï¼Œä¹‹å‰å·¦è¾¹ï¼Œè¿™æ¬¡å³è¾¹ã€‚&lt;br /&gt;&lt;br&gt;\nç»§ç»­å‰è¡Œï¼Œåæ¥æƒ³æƒ³ï¼Œå±…ç„¶å½“æ—¶å¿ƒæ€æ²¡å´©ã€‚&lt;br /&gt;&lt;br&gt;\nç”»é¾™å‰è¡Œï¼Œå¿—ç²å§å§å¿½ç„¶æ¥ä¸€å¥å³è½¬ç«‹åˆ»å·¦è½¬ï¼Œæˆ‘è¿™è·¯å£åˆ°åº•æ€ä¹ˆèµ°å•Šï¼Œé‚å†³å®šç›´æ¥å·¦è½¬ï¼Œè¿›äº†å·¦è½¬è½¦é“ç­‰çº¢ç¯ï¼Œå‘ç°å³è½¬åèµ°10ç±³æœç„¶æœ‰å·¦è½¬è·¯ï¼ŒWTFã€‚å·¦è½¬è½¦é“ç¡¬ç€å¤´çš®å·¦è½¬å®Œäº†ï¼Œç»ˆäºæ‰¾åˆ°ä¸€ä¸ªè·¯å£ç›´æ¥æ‰å¤´ï¼Œèµ°ä¸Šäº†åº·åº„å¤§é“ã€‚&lt;br /&gt;&lt;br&gt;\nè½¬å®Œäº†çªç„¶é“è·¯å®½é˜”äº†èµ·æ¥ï¼Œè·¯ä¸Šä¹Ÿæ²¡å‡ è¾†è½¦ï¼Œäºæ˜¯let&#39;s goï¼Œ4æ¡£çš„å¹²æ´»ï¼Œè¿™æ„Ÿè§‰å°±æ˜¯ä¹Œé¾Ÿçˆ¬åˆ°äº†å…”å­èº«ä¸Šã€‚&lt;br /&gt;&lt;br&gt;\nåˆ°æ ¡åï¼Œç­‰äº†å‡ ä¸ªé’Ÿå¤´ï¼Œä¸­é€”åˆå¼€ç€å‡ºå»ç»ƒç»ƒæ‰‹ï¼Œæ¥ä¸Šå¨ƒåè¿”ç¨‹çš„è·¯é€”ä¹Ÿç®—æœ‰æƒŠæ— é™©ï¼Œç»ˆäºå¹³å®‰çš„è¿é€å›å®¶ã€‚åº†å¹¸çš„æ˜¯è¿™ä¸€è·¯æ²¡æœ‰å€’è½¦å…¥åº“ã€ä¾§æ–¹åœè½¦ä¹‹ç±»çš„æŠ€æœ¯æ´»ã€‚ä¸‡å¹¸ã€‚&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;di-yi-ci-zheng-shi-kai-che&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æ‹¿äº†æœ¬å¤§åŠå¹´äº†ï¼Œæ˜¨å¤©ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;å¼€è½¦&#34;,&#34;slug&#34;:&#34;H65lpTSQ_&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/H65lpTSQ_/&#34;},{&#34;name&#34;:&#34;ç¬¬ä¸€æ¬¡&#34;,&#34;slug&#34;:&#34;r0iZcLdHQh&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/r0iZcLdHQh/&#34;},{&#34;name&#34;:&#34;æƒŠé™©&#34;,&#34;slug&#34;:&#34;LvxBwvofUe&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/LvxBwvofUe/&#34;},{&#34;name&#34;:&#34;åˆºæ¿€&#34;,&#34;slug&#34;:&#34;nLGCexIFLh&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/nLGCexIFLh/&#34;},{&#34;name&#34;:&#34;journel&#34;,&#34;slug&#34;:&#34;JASWMsZcXM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/JASWMsZcXM/&#34;},{&#34;name&#34;:&#34;éšç¬”&#34;,&#34;slug&#34;:&#34;vVcJap5Pi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/vVcJap5Pi/&#34;},{&#34;name&#34;:&#34;æ—¥è®°&#34;,&#34;slug&#34;:&#34;mU8w5MS9OO&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mU8w5MS9OO/&#34;}],&#34;date&#34;:&#34;2020-09-05 13:44:19&#34;,&#34;dateFormat&#34;:&#34;2020-09-05&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/di-yi-ci-zheng-shi-kai-che/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:81000,&#34;words&#34;:401,&#34;minutes&#34;:2},&#34;description&#34;:&#34;æ‹¿äº†æœ¬å¤§åŠå¹´äº†ï¼Œæ˜¨å¤©ç¬¬ä¸€æ¬¡æ­£å¼å¼€è½¦ã€‚\n\nå¤ªåˆºæ¿€äº†ã€‚ç”»é¾™ã€å‰è¹­ã€æ²¹åˆç¦»é—¨ï¼Œåº”æœ‰å°½æœ‰ã€‚ç§‘ä¸‰è€ƒäº†3æ¬¡æ‰è¿‡ï¼Œè€ƒè¿‡åæŠ½å¥–ä¸­äº†ä¸€ä¸ªé™ªç»ƒæœºä¼šï¼Œè·Ÿç€æ•™ç»ƒå¼€äº†è¶Ÿæ˜“å¿ï¼ˆåŒç»ƒçš„è¿˜æœ‰å…¶ä»–å­¦å‘˜ï¼‰ã€‚è¿™å°±æ˜¯ä¹‹å‰å…¨éƒ¨çš„å¼€è½¦ç»å†äº†ã€‚\næ˜¨å¤©å› ä¸ºè¦æ¥ä¾„å­ï¼Œå­¦æ ¡åœ¨ä¸€ä¸ªé¸Ÿä¸æ‹‰å±çš„åœ°...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;é™¤äº†k8sè¦æ±‚çš„ç«¯å£è¦å¼€ï¼Œworker nodeä¸Šé¢çš„&lt;code&gt;8472/udpï¼ˆvxlan backendï¼‰&lt;/code&gt;ä¹Ÿå¾—å¼€ã€‚ï¼ˆå°½ç®¡å‚è€ƒé“¾æ¥é‡Œæ˜ç¡®çš„æ˜¯worker nodeè¦å¼€ï¼Œä½†masterä¼¼ä¹ä¹Ÿå¾—å¼€ï¼Œå¦åˆ™masteré‡Œé¢çš„corednsæ— æ³•ä¸ºworker nodeæœåŠ¡ï¼‰&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;ç”¨&lt;code&gt;nmcli&lt;/code&gt;æŸ¥çœ‹ï¼Œå‘ç°flannel ç”¨åˆ°çš„æ˜¯&lt;code&gt;vxlan backend&lt;/code&gt;ï¼Œå› æ­¤éœ€è¦æ‰“å¼€&lt;code&gt;8472/udp&lt;/code&gt;ã€‚&lt;br  /&gt;&lt;br&gt;\næ‰“å¼€åï¼Œå‘ç°Ubuntuçš„nodeå¯ä»¥è¢«pingé€šï¼ŒåŒæ—¶å¦‚æœä¸Šé¢è·‘ç€&lt;code&gt;httpd&lt;/code&gt;ï¼Œå…¶ä»–nodeä¹Ÿå¯ä»¥&lt;code&gt;curl&lt;/code&gt;åˆ°å†…å®¹ï¼›è€ŒCentOSåªèƒ½è¢«pingé€šï¼Œ&lt;code&gt;curl 10.244.2.19&lt;/code&gt;çš„æ—¶å€™ä¼šæ˜¾ç¤º&lt;code&gt;curl: (7) Failed to connect to 10.244.2.19 port 80: No route to host&lt;/code&gt;ã€‚&lt;br /&gt;&lt;br&gt;\næŸ¥äº†nå¤šèµ„æ–™ï¼Œå‡ ä¹éƒ½æ˜¯å…³é—­é˜²ç«å¢™ï¼Œå…³é—­åç¡®å®èƒ½è§£å†³ï¼Œä½†æˆ‘æƒ³è¿™ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­çš„åšæ³•ã€‚æœ€ç»ˆåœ¨è¿™ä½ä»å…„Louis Heçš„åšæ–‡&lt;a href=\&#34;https://www.cnblogs.com/Dev0ps/p/11401530.html\&#34;&gt;Kubernetesé›†ç¾¤å¼€å¯Firewall&lt;/a&gt;ä¸­æ‰¾åˆ°ç­”æ¡ˆ&lt;code&gt;add-masquerade&lt;/code&gt;ã€‚åŒæ—¶ä¹Ÿè°¢è°¢è®©æˆ‘æ‰¾åˆ°8472ç«¯å£çš„ä»å…„&lt;a href=\&#34;https://www.codenong.com/39293441/\&#34;&gt;å…³äºç½‘ç»œï¼šKubernetesé›†ç¾¤æ‰€éœ€çš„ç«¯å£&lt;/a&gt;ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;# Ubuntu\nsudo ufw allow 8472/udp #æå®š\n\n# CentOS\nsudo firewall-cmd --zone=public --add-port=8472/udp --permanent\nsudo firewall-cmd --reload #è¿™æ­¥æå®Œåªèƒ½è¢«pingé€šï¼Œcurlæ—¶æ˜¯No route to hostï¼Œå¤´ç–¼æ­»äº†\nsudo firewall-cmd --add-masquerade --permanent\nsudo firewall-cmd --reload #è¿™æ‰æŠŠcurlä¹Ÿæ‰“é€šäº†ï¼Œæˆ‘å¤ªéš¾äº†\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.codenong.com/39293441/\&#34;&gt;https://www.codenong.com/39293441/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/Dev0ps/p/11401530.html\&#34;&gt;https://www.cnblogs.com/Dev0ps/p/11401530.html&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;k8s-ji-qun-kua-jie-dian-pods-wu-fa-ping-tong&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;é™¤äº†k8sè¦æ±‚çš„ç«¯å£è¦å¼€ï¼Œworker nodeä¸Šé¢çš„&lt;code&gt;8472/udpï¼ˆvxlan backendï¼‰&lt;/code&gt;ä¹Ÿå¾—å¼€ã€‚ï¼ˆå°½ç®¡å‚è€ƒé“¾æ¥é‡Œæ˜ç¡®çš„æ˜¯worker nodeè¦å¼€ï¼Œä½†masterä¼¼ä¹ä¹Ÿå¾—å¼€ï¼Œå¦åˆ™masteré‡Œé¢çš„corednsæ— æ³•ä¸ºworker nodeæœåŠ¡ï¼‰&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;k8sé›†ç¾¤è·¨èŠ‚ç‚¹podsæ— æ³•pingé€šä»¥åŠæ— æ³•curl&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;node&#34;,&#34;slug&#34;:&#34;ktPWlgDOF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/ktPWlgDOF/&#34;},{&#34;name&#34;:&#34;master&#34;,&#34;slug&#34;:&#34;oqB9teWmFq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/oqB9teWmFq/&#34;},{&#34;name&#34;:&#34;worker&#34;,&#34;slug&#34;:&#34;ZoV7NucWOu&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/ZoV7NucWOu/&#34;},{&#34;name&#34;:&#34;coredns&#34;,&#34;slug&#34;:&#34;4P-c28hZd&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/4P-c28hZd/&#34;},{&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;waCBSEanF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/waCBSEanF/&#34;},{&#34;name&#34;:&#34;é›†ç¾¤&#34;,&#34;slug&#34;:&#34;naHmaZ_HMS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/naHmaZ_HMS/&#34;},{&#34;name&#34;:&#34;cluster&#34;,&#34;slug&#34;:&#34;yE4fTs2PIS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/yE4fTs2PIS/&#34;},{&#34;name&#34;:&#34;pod&#34;,&#34;slug&#34;:&#34;FAeA3gxSv-&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/FAeA3gxSv-/&#34;},{&#34;name&#34;:&#34;deployment&#34;,&#34;slug&#34;:&#34;GPRVeyKbA2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/GPRVeyKbA2/&#34;},{&#34;name&#34;:&#34;curl&#34;,&#34;slug&#34;:&#34;7vahxDiu2H&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/7vahxDiu2H/&#34;},{&#34;name&#34;:&#34;ping&#34;,&#34;slug&#34;:&#34;0bvHxHIt3f&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/0bvHxHIt3f/&#34;},{&#34;name&#34;:&#34;firewall&#34;,&#34;slug&#34;:&#34;8I-WOs8AEy&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/8I-WOs8AEy/&#34;},{&#34;name&#34;:&#34;utw&#34;,&#34;slug&#34;:&#34;mxbKCZJxae&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mxbKCZJxae/&#34;},{&#34;name&#34;:&#34;ç«¯å£&#34;,&#34;slug&#34;:&#34;guNk0JsrG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/guNk0JsrG/&#34;},{&#34;name&#34;:&#34;port&#34;,&#34;slug&#34;:&#34;nU_jlBkSws&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/nU_jlBkSws/&#34;},{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;Kubernetes&#34;,&#34;slug&#34;:&#34;2myAgZVX1&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/2myAgZVX1/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;}],&#34;date&#34;:&#34;2020-09-03 18:33:25&#34;,&#34;dateFormat&#34;:&#34;2020-09-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/k8s-ji-qun-kua-jie-dian-pods-wu-fa-ping-tong/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:77000,&#34;words&#34;:304,&#34;minutes&#34;:2},&#34;description&#34;:&#34;é™¤äº†k8sè¦æ±‚çš„ç«¯å£è¦å¼€ï¼Œworker nodeä¸Šé¢çš„8472/udpï¼ˆvxlan backendï¼‰ä¹Ÿå¾—å¼€ã€‚ï¼ˆå°½ç®¡å‚è€ƒé“¾æ¥é‡Œæ˜ç¡®çš„æ˜¯worker nodeè¦å¼€ï¼Œä½†masterä¼¼ä¹ä¹Ÿå¾—å¼€ï¼Œå¦åˆ™masteré‡Œé¢çš„corednsæ— æ³•ä¸ºworker...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;ä¸Šå‘¨å…­å»äº†è¶Ÿåœ£è²å±±ï¼Œé™ªäººæ•£å¿ƒï¼Œå°½ç®¡å¥½åƒåªæ˜¯æŠŠä»–å½“ä½œè½¦å¤«ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;å»ºè®®ä¹°è§‚å…‰è½¦çš„ç¥¨ï¼Œå¦åˆ™ä»å…¥å£åˆ°æ­£ç»çˆ¬å±±ç‚¹æœ‰7é‡Œåœ°ï¼Œèµ°ä¸ªå¾€è¿”å°±è¯¥æ‰“é“å›åºœäº†ã€‚&lt;br /&gt;&lt;br&gt;\nä¹‹å‰åªæ˜¯å¬äººè¯´è¿‡ï¼Œè¿™æ¬¡åˆ«äººæƒ³æ•£å¿ƒï¼Œäºæ˜¯æ¨èæ­¤åœ°ï¼Œæƒ³æ•£å¿ƒçš„å½“äº†å…¨ç¨‹å¸æœºã€‚ååœ¨è½¦ä¸Šå¾€å±±é‡Œå»æ˜¯è¶Šæ¥è¶Šå‡‰å¿«ï¼Œé€”ä¸­ä¹Ÿè§åˆ°äº†ååˆ†é™¡å³­çš„å±±ï¼Œæœç„¶æˆ¿å±±å°±æ˜¯å±±å¤šã€‚&lt;br /&gt;&lt;br&gt;\næ•£å¿ƒäººè…¿å—ä¼¤äº†ï¼Œå› æ­¤åˆ°äº†æ™¯åŒºåå°½é‡æä¸éœ€è¦ç”¨è…¿çš„é¡¹ç›®ï¼Œæ¯”å¦‚è§‚å…‰è½¦ã€ç¼†è½¦ï¼ˆå†…å¿ƒOSï¼šæ—¢ç„¶è…¿ä¸å¥½ï¼Œæ¥å±±ä¸Šå¹²å•¥ï¼‰ã€‚&lt;br /&gt;&lt;br&gt;\nå…¶å®æœ¬äººæ˜¯ç¬¬ä¸€æ¬¡åç¼†è½¦ï¼Œç¨å¾®å¾€ä¸‹çœ‹çœ‹ï¼Œç¡®å®æœ‰ç‚¹è…¿è½¯ã€‚åŒæ—¶æƒ³èµ·æ„å¤§åˆ©çš„ä¸€é¦–æ°‘æ­Œï¼Œå°±å«ç¼†è½¦ï¼Œè®²çš„æ˜¯18å‡ å‡ å¹´çš„äº‹å„¿ï¼Œæœ‰ä¸ªè€æ¿æå±±åŒºæ—…æ¸¸é¡¹ç›®ï¼Œäºæ˜¯æäº†äººåŠ›ç¼†è½¦ï¼Œå¹¶ä¸”ä¸“é—¨æ‰¾ä½œæ›²å®¶å†™äº†ä¸ªæ›²å­ï¼Œå°±æ˜¯ç¼†è½¦ï¼Œå®é™…ä¸ŠåŸæ–‡çš„å‘éŸ³æ˜¯fu ni ku li fu ni ku laï¼Œæ¨¡æ‹Ÿç¼†è½¦çš„å£°éŸ³ï¼Œè¿™ä¸ªæ­Œæ›²æ›´å‡†ç¡®è¯´åº”è¯¥ç±»ä¼¼äºå’±ä»¬çš„åŠ³åŠ¨å·å­ï¼Œå¤§å®¶è¾¹å”±è¾¹ä½¿åŠ²æ‹‰ç»³å­ã€‚æ›²å­éå¸¸æ¬¢å¿«ï¼Œè¿›è¡Œæ›²çš„é‚£ç§æ„Ÿè§‰ï¼Œå¾ˆå¤šæ­Œå‰§æ¼”å‘˜éƒ½å”±è¿‡ï¼Œæ¯”å¦‚è‘—åçš„å¸•ç“¦ç½—è’‚ã€‚ä½†æˆ‘ç¬¬ä¸€æ¬¡å¬æ˜¯åœ¨èŠ’æœå°çš„å£°å…¥äººå¿ƒï¼Œä¸€éå°±å–œæ¬¢ä¸Šäº†ã€‚æˆ‘å¦ˆè§‰å¾—æœ‰äº›æ®µè½åƒæ˜¯é¬¼å­è¿›æ‘ã€‚&lt;br /&gt;&lt;br&gt;\nç¼†è½¦ä¸Šå±±åï¼Œç›´å¥”è§‚å…‰è½¦å¸æœºæ¨èçš„å¿…å»æ™¯ç‚¹ï¼Œä¸€ä¸ªå«åœ£è²å®å¡”ï¼Œä¸€ä¸ªå«è²å­å³°ã€‚åœ£è²å®å¡”å°±æ˜¯åäººç¿»å»ºçš„ä¸€ä¸ªå»ºç­‘ï¼Œæ¯å±‚éƒ½ç»˜åˆ¶äº†ä½›æ•™çš„æ•…äº‹ã€‚å…¶å®æ›´å–œæ¬¢çº¯çš„å¤å»ºç­‘ï¼Œæˆ–è€…ä»¥å¤ä¿®å¤çš„é‚£ç§ï¼Œå¯æƒœè¿™ä¸ªå®å¡”ä¹‹å‰å½»åº•å€’å¡Œäº†ã€‚å¡”æ—è¾¹çš„å±±ä¸Šè¿˜æœ‰é¢˜å­—ï¼Œå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯ä¹¦æ³•å®¶æ‰ä¼šé¢˜å­—ï¼Œå¯è¿™ä¸ªå­—æ€ä¹ˆçœ‹éƒ½è§‰å¾—æŒºå°å­¦ç”Ÿçš„ï¼ˆæ²¡æœ‰ä¾®è¾±å°å­¦ç”Ÿçš„æ„æ€ï¼‰ï¼Œä¸€ç›´ä¹Ÿè”æƒ³ä¸åˆ°æ˜¯å“ªä½å¤§å®¶çš„é£æ ¼ã€‚æ­£æš—è‡ªæ„Ÿå¹è§è¯†å¤ªå°‘ï¼Œå¿½å¬å¾—æ—äººç™¾åº¦çš„ç»“æœï¼Œé¢˜å­—äººæ­£æ˜¯å®å¡”ç¿»å»ºçš„å‡ºèµ„äººä¹‹ä¸€ï¼Œå¿ƒé‡Œçš„å¤§çŸ³å¤´ç»ˆäºè½åœ°ï¼Œçœ‹æ¥è‡ªå·±å®¡ç¾æ²¡å‡ºå¤§é—®é¢˜ã€‚æ—äººä¹Ÿæ€€åŒæ ·æ„Ÿè§‰ï¼Œå¤§å®¶éƒ½é‡Šç„¶äº†ã€‚å½“ç„¶å‡ºèµ„äººçš„åŠŸå¾·è‚¯å®šæ˜¯å¤§å¤§çš„ã€‚&lt;br /&gt;&lt;br&gt;\nå®é™…ä¸Šä¸¤ä¸ªæ™¯ç‚¹å¸¦æ¥çš„æ„Ÿè§‰æ²¡æœ‰å¤ªéœ‡æ’¼ï¼Œä½†æ˜¯æ¸¸ç©è¿™ç§äº‹æƒ…ï¼Œè¿‡ç¨‹æ‰æ˜¯æ ¸å¿ƒã€‚ä¸­é—´è¿˜è·¯è¿‡ä¸€ä¸ªæ™¯ç‚¹å«å…«ä»™æ´ï¼Œå°±æ˜¯åœ¨å±±ä¸Šå‡¿ç©¿äº†ä¸ªæ´ï¼Œçœ‹æ´å£çš„å‘å‘æ´¼æ´¼ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯å‰äººä¸€å‡¿ä¸€æ–§çš„å¿ƒè¡€ï¼Œæ´å†…å‡‰æ°”åè¶³ï¼Œä¸”æ´é¡¶è¿˜æœ‰æ¸—æ°´æ»´ä¸‹ï¼Œæˆ‘ä»¬æ„Ÿå¹åº”è¯¥ç©¿æ£‰è¢„è¿›æ¥ã€‚åæ¥æ•£å¿ƒäººåœ¨æ´å¤–å¿½æ‚ åæ¥è€…ï¼Œè¯´æ´é‡Œç§Ÿå†›å¤§è¡£ã€‚ä¸€ä¸ªå‡ å²çš„å°ç”·å­©è¯´ä»€ä¹ˆä¹Ÿä¸è¿›å»ï¼Œè·Ÿçˆ¸å¦ˆè¯´é‡Œé¢å¯æ€•ï¼Œæˆ‘åœ¨æƒ³ä¼°è®¡ä»–ä»¬ä¸€å®¶å°±è¦å°±æ­¤æ‰“ä½äº†ï¼Œç»“æœå­©å­çˆ¸å¦ˆæƒ³äº†ä¸ªåŠæ³•ï¼ŒæŠŠå­©å­æŠ±ä¸Šè®©å­©å­è¶´è‚©å¤´æŒ¡ä½çœ¼ç›ï¼Œç›´æ¥å°±è¿›å»äº†ã€‚è¿™éƒ½è¡Œï¼Œå­©å­å°±æ˜¯å­©å­ã€‚&lt;br /&gt;&lt;br&gt;\nä¹‹åæˆ‘ä»¬æ‰¾äº†ä¸ªåƒ»é™å¤„åƒåˆé¥­ï¼Œè¯´å®è¯èƒŒäº†ä¸€è·¯ï¼Œçƒ§é¥¼ã€é¦™è‚ è¿˜æœ‰æ°´ï¼Œç´¯æ­»æˆ‘äº†ã€‚æˆ‘çˆ¸ä¹°çš„è¿™é¦™è‚ ä¹Ÿæœ‰ä¸ªæ€§ï¼Œå¤–é¢å¡‘æ–™çš®å‰¥å¼€ï¼Œé‡Œé¢å±…ç„¶è¿˜æœ‰ä¸€å±‚å¡‘æ–™è†œï¼Œæˆ‘è¿˜æ²¡å«å‡ºæ¥ï¼Œæ•£å¿ƒäººå·²ç»ä¸€å£å•ƒä¸‹å¹¶åä¸‹äº†ä¸€è§’å¡‘æ–™è†œã€‚è¿™è‚ æœ‰ä¸ªæ€§ï¼Œè¿™äººæ›´æœ‰ä¸ªæ€§ã€‚&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;sheng-lian-shan-sui-bi&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;ä¸Šå‘¨å…­å»äº†è¶Ÿåœ£è²å±±ï¼Œé™ªäººæ•£å¿ƒï¼Œå°½ç®¡å¥½åƒåªæ˜¯æŠŠä»–å½“ä½œè½¦å¤«ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;åœ£è²å±±éšç¬”&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;éšç¬”&#34;,&#34;slug&#34;:&#34;vVcJap5Pi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/vVcJap5Pi/&#34;},{&#34;name&#34;:&#34;æ—¥è®°&#34;,&#34;slug&#34;:&#34;mU8w5MS9OO&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mU8w5MS9OO/&#34;},{&#34;name&#34;:&#34;journal&#34;,&#34;slug&#34;:&#34;ejOgYFlYcd&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/ejOgYFlYcd/&#34;},{&#34;name&#34;:&#34;æ¸¸è®°&#34;,&#34;slug&#34;:&#34;wP0dWoTcod&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/wP0dWoTcod/&#34;},{&#34;name&#34;:&#34;åœ£è²å±±&#34;,&#34;slug&#34;:&#34;hYtK2OUdp&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/hYtK2OUdp/&#34;},{&#34;name&#34;:&#34;éƒŠæ¸¸&#34;,&#34;slug&#34;:&#34;XND26UythC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/XND26UythC/&#34;},{&#34;name&#34;:&#34;æ•£å¿ƒ&#34;,&#34;slug&#34;:&#34;QgK8_fIsEU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/QgK8_fIsEU/&#34;},{&#34;name&#34;:&#34;ç¼†è½¦&#34;,&#34;slug&#34;:&#34;knK15BJeDj&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/knK15BJeDj/&#34;},{&#34;name&#34;:&#34;è§‚å…‰è½¦&#34;,&#34;slug&#34;:&#34;KD74sZYvHK&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/KD74sZYvHK/&#34;},{&#34;name&#34;:&#34;è€å­&#34;,&#34;slug&#34;:&#34;bbNdAvIFcC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/bbNdAvIFcC/&#34;},{&#34;name&#34;:&#34;é™¡å³­&#34;,&#34;slug&#34;:&#34;0Yqv2YqYXn&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/0Yqv2YqYXn/&#34;},{&#34;name&#34;:&#34;äººå°‘&#34;,&#34;slug&#34;:&#34;AcwXp59em0&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/AcwXp59em0/&#34;},{&#34;name&#34;:&#34;é“æ•™&#34;,&#34;slug&#34;:&#34;zCIZXoeJU-&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/zCIZXoeJU-/&#34;}],&#34;date&#34;:&#34;2020-09-03 14:39:26&#34;,&#34;dateFormat&#34;:&#34;2020-09-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/sheng-lian-shan-sui-bi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:183000,&#34;words&#34;:910,&#34;minutes&#34;:4},&#34;description&#34;:&#34;ä¸Šå‘¨å…­å»äº†è¶Ÿåœ£è²å±±ï¼Œé™ªäººæ•£å¿ƒï¼Œå°½ç®¡å¥½åƒåªæ˜¯æŠŠä»–å½“ä½œè½¦å¤«ã€‚\n\nå»ºè®®ä¹°è§‚å…‰è½¦çš„ç¥¨ï¼Œå¦åˆ™ä»å…¥å£åˆ°æ­£ç»çˆ¬å±±ç‚¹æœ‰7é‡Œåœ°ï¼Œèµ°ä¸ªå¾€è¿”å°±è¯¥æ‰“é“å›åºœäº†ã€‚\nä¹‹å‰åªæ˜¯å¬äººè¯´è¿‡ï¼Œè¿™æ¬¡åˆ«äººæƒ³æ•£å¿ƒï¼Œäºæ˜¯æ¨èæ­¤åœ°ï¼Œæƒ³æ•£å¿ƒçš„å½“äº†å…¨ç¨‹å¸æœºã€‚ååœ¨è½¦ä¸Šå¾€å±±é‡Œå»æ˜¯è¶Šæ¥è¶Šå‡‰å¿«ï¼Œé€”ä¸­...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;å®æ“é‡åˆ°é—®é¢˜å¥½å¤šï¼Œè®°å½•ä¸‹ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;imageæ‹‰å–å¤±è´¥replicasè¢«å¼ƒç”¨\&#34;&gt;imageæ‹‰å–å¤±è´¥ï¼Œreplicasè¢«å¼ƒç”¨&lt;/h1&gt;\n&lt;h2 id=\&#34;é—®é¢˜\&#34;&gt;é—®é¢˜&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;# æ‰§è¡Œrunï¼Œæ˜¾ç¤ºreplicas has been deprecatedï¼Œå› æ­¤ä¸ç”Ÿæ•ˆï¼Œåªéƒ¨ç½²äº†1ä¸ªå®ä¾‹ \nkubectl run httpd-app --image=httpd --replicas=2\n# æ£€æŸ¥podsè¿è¡Œæƒ…å†µï¼ŒREADYåˆ—æ˜¾ç¤ºæœªå°±ç»ª\nkubectl get pods -n wide\n# æ£€æŸ¥è¿è¡Œç»†èŠ‚ï¼Œä¸€ç›´æ˜¾ç¤ºpulling\nkubectl describe pods httpd-app\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;è§£å†³\&#34;&gt;è§£å†³&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;åˆ é™¤ä¹‹å‰çš„éƒ¨ç½²ï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;kubectl delete pods httpd-app\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;åˆ›å»ºéƒ¨ç½²æ–‡ä»¶ï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;cd ~/k8s\nnano nginx.yaml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;ç²˜è´´ä¸‹é¢å†…å®¹è¿›nginx.yamlï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;# API ç‰ˆæœ¬å·\napiVersion: apps/v1\n# ç±»å‹ï¼Œå¦‚ï¼šPod/ReplicationController/Deployment/Service/Ingress\nkind: Deployment\nmetadata:\n  # Kind çš„åç§°\n  name: nginx-app\nspec:\n  selector:\n    matchLabels:\n      # å®¹å™¨æ ‡ç­¾çš„åå­—ï¼Œå‘å¸ƒ Service æ—¶ï¼Œselector éœ€è¦å’Œè¿™é‡Œå¯¹åº”\n      app: nginx\n  # éƒ¨ç½²çš„å®ä¾‹æ•°é‡\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      # é…ç½®å®¹å™¨ï¼Œæ•°ç»„ç±»å‹ï¼Œè¯´æ˜å¯ä»¥é…ç½®å¤šä¸ªå®¹å™¨\n      containers:\n      # å®¹å™¨åç§°\n      - name: nginx\n        # å®¹å™¨é•œåƒ\n        image: nginx:1.17\n        # åªæœ‰é•œåƒä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šè¿›è¡Œé•œåƒæ‹‰å–\n        imagePullPolicy: IfNotPresent\n        ports:\n        # Pod ç«¯å£\n        - containerPort: 80\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;4\&#34;&gt;\n&lt;li&gt;åˆ›å»ºï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;kubectl apply -f nginx.yaml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;5\&#34;&gt;\n&lt;li&gt;æ£€æŸ¥ï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get deployments\nkubectl describe deployment nginx-app\nkubectl get replicaset\nkubectl describe rs nginx-app-5d85b5fb59\nkubectl get pods -o wide\nkubectl describe pods nginx-app-5d85b5fb59-2ct5p\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;6\&#34;&gt;\n&lt;li&gt;æš´éœ²æœåŠ¡ï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;kubectl expose deployment nginx-app --port=80 --type=LoadBalancer\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;7\&#34;&gt;\n&lt;li&gt;æŸ¥çœ‹æœåŠ¡çŠ¶æ€(æŸ¥çœ‹å¯¹å¤–çš„ç«¯å£)&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get services\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;nginx-app&lt;/code&gt;ä¸€ç›´å¤„äºpendingçŠ¶æ€ï¼Œåº”è¯¥æ˜¯typeè®¾ç½®ä¸º&lt;code&gt;LoadBalancer&lt;/code&gt;ï¼Œä½†æ²¡æœ‰äº‘æœåŠ¡å•†å’Œæœ¬åœ°æœåŠ¡æä¾›è¯¥åŠŸèƒ½ã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/qq_43279371/article/details/107768713\&#34;&gt;https://blog.csdn.net/qq_43279371/article/details/107768713&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/kenkao/article/details/86764788\&#34;&gt;https://blog.csdn.net/kenkao/article/details/86764788&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;k8s-cao-zuo-bi-ji&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;å®æ“é‡åˆ°é—®é¢˜å¥½å¤šï¼Œè®°å½•ä¸‹ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;k8sæ“ä½œç¬”è®°&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2020-09-02 17:00:52&#34;,&#34;dateFormat&#34;:&#34;2020-09-02&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/k8s-cao-zuo-bi-ji/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:98000,&#34;words&#34;:361,&#34;minutes&#34;:2},&#34;description&#34;:&#34;å®æ“é‡åˆ°é—®é¢˜å¥½å¤šï¼Œè®°å½•ä¸‹ã€‚\n\nimageæ‹‰å–å¤±è´¥ï¼Œreplicasè¢«å¼ƒç”¨\né—®é¢˜\n# æ‰§è¡Œrunï¼Œæ˜¾ç¤ºreplicas has been deprecatedï¼Œå› æ­¤ä¸ç”Ÿæ•ˆï¼Œåªéƒ¨ç½²äº†1ä¸ªå®ä¾‹ \nkubectl run httpd-app --i...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#image%E6%8B%89%E5%8F%96%E5%A4%B1%E8%B4%A5replicas%E8%A2%AB%E5%BC%83%E7%94%A8\&#34;&gt;imageæ‹‰å–å¤±è´¥ï¼Œreplicasè¢«å¼ƒç”¨&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%97%AE%E9%A2%98\&#34;&gt;é—®é¢˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E5%86%B3\&#34;&gt;è§£å†³&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;åŠ å¿«Ubuntuå’ŒCentOSè½¯ä»¶ä¸‹è½½é€Ÿåº¦ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;ubuntu\&#34;&gt;Ubuntu&lt;/h1&gt;\n&lt;p&gt;å¤‡ä»½æºé…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä½¿ç”¨vimæˆ–geditç¼–è¾‘source.listï¼Œç”¨ä¸‹é¢å†…å®¹æ›¿æ¢åŸæœ‰å†…å®¹ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse\n\n# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨\n# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜ï¼Œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo apt-get update\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;centos\&#34;&gt;CentOS&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;path=&#39;/etc/yum.repos.d/&#39;\nrepos=(CentOS-AppStream.repo CentOS-Base.repo CentOS-centosplus.repo CentOS-Extras.repo CentOS-PowerTools.repo)\nfor repo in ${repos[@]}; do\nsudo cp $path$repo $path$repo&#39;.bak&#39; #å¤‡ä»½æºé…ç½®æ–‡ä»¶\nsudo sed -i &amp;quot;s/^mirrorlist/#&amp;amp;/; s/^#baseurl/baseurl/; s/http:\\/\\/mirror.centos.org\\/\\$contentdir/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/centos/&amp;quot; $path$repo #ä¿®æ”¹é…ç½®æ–‡ä»¶\ndone\n# æ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜ï¼Œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ\nsudo yum makecache\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/\&#34;&gt;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/xiangxianghehe/article/details/105688062\&#34;&gt;https://blog.csdn.net/xiangxianghehe/article/details/105688062&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://mirror.tuna.tsinghua.edu.cn/help/centos/\&#34;&gt;https://mirror.tuna.tsinghua.edu.cn/help/centos/&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;pei-zhi-ubuntu-he-centos-qing-hua-yuan&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;åŠ å¿«Ubuntuå’ŒCentOSè½¯ä»¶ä¸‹è½½é€Ÿåº¦ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;é…ç½®Ubuntuå’ŒCentOSæ¸…åæº&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;åŠ é€Ÿ&#34;,&#34;slug&#34;:&#34;-7LE7Ga8N&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/-7LE7Ga8N/&#34;},{&#34;name&#34;:&#34;æº&#34;,&#34;slug&#34;:&#34;hxgTAOH_N6&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/hxgTAOH_N6/&#34;},{&#34;name&#34;:&#34;å›½å†…æº&#34;,&#34;slug&#34;:&#34;AVam_YHxdq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/AVam_YHxdq/&#34;},{&#34;name&#34;:&#34;æ¸…åæº&#34;,&#34;slug&#34;:&#34;xl0sLn8kCY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/xl0sLn8kCY/&#34;},{&#34;name&#34;:&#34;tsinghua&#34;,&#34;slug&#34;:&#34;8ea4TbNf-K&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/8ea4TbNf-K/&#34;},{&#34;name&#34;:&#34;tuna&#34;,&#34;slug&#34;:&#34;AKueiIe07M&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/AKueiIe07M/&#34;},{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;}],&#34;date&#34;:&#34;2020-09-01 19:56:40&#34;,&#34;dateFormat&#34;:&#34;2020-09-01&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/pei-zhi-ubuntu-he-centos-qing-hua-yuan/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:117000,&#34;words&#34;:365,&#34;minutes&#34;:2},&#34;description&#34;:&#34;åŠ å¿«Ubuntuå’ŒCentOSè½¯ä»¶ä¸‹è½½é€Ÿåº¦ã€‚\n\nUbuntu\nå¤‡ä»½æºé…ç½®æ–‡ä»¶ï¼š\nsudo cp /etc/apt/sources.list /etc/apt/sources.list.bak\n\nä½¿ç”¨vimæˆ–geditç¼–è¾‘source.lis...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#ubuntu\&#34;&gt;Ubuntu&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#centos\&#34;&gt;CentOS&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æ•´ç†dockerå®‰è£…å¿ƒå¾—ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;centos\&#34;&gt;CentOS&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;# ç§»é™¤æ—§ç‰ˆ\nsudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n# è®¾ç½®é˜¿é‡Œäº‘ä»“åº“repository\nsudo yum install -y yum-utils\nsudo yum-config-manager \\\n    --add-repo \\\n   http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n# å®‰è£…containerd.io\nsudo yum install -y https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm\n# å®‰è£…docker\nsudo yum install docker-ce docker-ce-cli\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;ubuntu\&#34;&gt;Ubuntu&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;# ç§»é™¤æ—§ç‰ˆ\nsudo apt-get remove docker docker-engine docker.io containerd runc\n# å®‰è£…ä¾èµ–è½¯ä»¶\nsudo apt-get update\nsudo apt-get install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg-agent \\\n    software-properties-common\n# æ·»åŠ ä¸­ç§‘å¤§DockerGPG KEY\ncurl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -\n# æ·»åŠ ä¸­ç§‘å¤§ä»“åº“\nsudo add-apt-repository &amp;quot;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \\\n$(lsb_release -cs) stable&amp;quot;\n# å®‰è£…docker\nsudo apt update\nsudo apt install docker-ce docker-ce-cli containerd.io\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»¥ä¸Šæ“ä½œå®Œæ¯•åï¼Œç»§ç»­æ“ä½œä¸‹é¢é€šç”¨éƒ¨åˆ†ã€‚&lt;/p&gt;\n&lt;h1 id=\&#34;é€šç”¨\&#34;&gt;é€šç”¨&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;# å¯åŠ¨docker\nsudo systemctl start docker\n# åŠ å…¥å¼€æœºå¯åŠ¨\nsudo systemctl enable docker\n# å…è®¸å½“å‰ç”¨æˆ·ä½¿ç”¨docker\nsudo usermod -aG docker ${USER}\nsu - $USER //ç«‹åˆ»ç”Ÿæ•ˆ\n# é…ç½®å›½å†…åŠ é€Ÿå™¨ï¼ˆå¯æ˜¾è‘—å¢åŠ docker pullé•œåƒçš„æˆåŠŸç‡å’Œé€Ÿåº¦ï¼‰\nsudo tee /etc/docker/daemon.json &amp;lt;&amp;lt;-&#39;EOF&#39;\n{\n  &amp;quot;registry-mirrors&amp;quot;: [\n    &amp;quot;https://97g5u05j.mirror.aliyuncs.com&amp;quot;,\n    &amp;quot;https://dockerhub.azk8s.cn&amp;quot;,\n    &amp;quot;https://hub-mirror.c.163.com&amp;quot;,\n    &amp;quot;https://docker.mirrors.ustc.edu.cn&amp;quot;\n  ],\n  &amp;quot;exec-opts&amp;quot;: [&amp;quot;native.cgroupdriver=systemd&amp;quot;],\n  &amp;quot;log-driver&amp;quot;: &amp;quot;json-file&amp;quot;,\n  &amp;quot;log-opts&amp;quot;: {\n    &amp;quot;max-size&amp;quot;: &amp;quot;100m&amp;quot;\n  },\n  &amp;quot;storage-driver&amp;quot;: &amp;quot;overlay2&amp;quot;\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://docs.docker.com/engine/install/\&#34;&gt;https://docs.docker.com/engine/install/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://developer.aliyun.com/article/763983\&#34;&gt;https://developer.aliyun.com/article/763983&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.jianshu.com/p/5a911f20d93e\&#34;&gt;https://www.jianshu.com/p/5a911f20d93e&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/Alexhcf/article/details/106726860\&#34;&gt;https://blog.csdn.net/Alexhcf/article/details/106726860&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/xuyaowen/p/usermod_session.html\&#34;&gt;Linux ä¿®æ”¹ç”¨æˆ·ç»„åï¼Œå¦‚ä½•å…³é—­æ‰€æœ‰ X session ä¸‹ä½¿å¾—ç»„ç”Ÿæ•ˆï¼Ÿ&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;zai-centos-he-ubuntu-shang-an-zhuang-he-pei-zhi-docker&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æ•´ç†dockerå®‰è£…å¿ƒå¾—ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;åœ¨CentOSå’ŒUbuntuä¸Šå®‰è£…å’Œé…ç½®docker&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;å®‰è£…&#34;,&#34;slug&#34;:&#34;Q8BfV1d_Wf&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Q8BfV1d_Wf/&#34;},{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;é…ç½®&#34;,&#34;slug&#34;:&#34;Bwz1BaTtzi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Bwz1BaTtzi/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;},{&#34;name&#34;:&#34;Docker&#34;,&#34;slug&#34;:&#34;RkYw1lQ_qY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/RkYw1lQ_qY/&#34;},{&#34;name&#34;:&#34;Aliyun&#34;,&#34;slug&#34;:&#34;LQERLoeDmq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/LQERLoeDmq/&#34;},{&#34;name&#34;:&#34;é˜¿é‡Œäº‘&#34;,&#34;slug&#34;:&#34;CDrtFP3hgt&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/CDrtFP3hgt/&#34;}],&#34;date&#34;:&#34;2020-09-01 18:06:21&#34;,&#34;dateFormat&#34;:&#34;2020-09-01&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/zai-centos-he-ubuntu-shang-an-zhuang-he-pei-zhi-docker/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:138000,&#34;words&#34;:428,&#34;minutes&#34;:3},&#34;description&#34;:&#34;æ•´ç†dockerå®‰è£…å¿ƒå¾—ã€‚\n\nCentOS\n# ç§»é™¤æ—§ç‰ˆ\nsudo yum remove docker \\\n                  docker-client \\\n                  docker-client-...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#centos\&#34;&gt;CentOS&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#ubuntu\&#34;&gt;Ubuntu&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%80%9A%E7%94%A8\&#34;&gt;é€šç”¨&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;è®°å½•ä¸‹ç«¯å£è®¾ç½®ï¼Œç”¨åˆ°å•¥è®°å½•å•¥ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;centos\&#34;&gt;CentOS&lt;/h1&gt;\n&lt;p&gt;æ ¸å¿ƒæŒ‡ä»¤&lt;code&gt;firewall-cmd&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£\&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --list-ports\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å¼€å¯ç«¯å£\&#34;&gt;å¼€å¯ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --zone=public --add-port=10250/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=30000-32767/tcp --permanent\n//--zone: ä½œç”¨åŸŸ \n//--add-port=2181/tcp: è¦å¼€å¯çš„ç«¯å£å·ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£å·/é€šè®¯åè®® \n//--permanent: ä½¿ç«¯å£æ°¸ä¹…å¼€æ”¾ï¼Œå¦‚ä¸æ·»åŠ ï¼Œåˆ™è¡¨ç¤ºä¸´æ—¶æœ‰æ•ˆï¼Œå¼€æœºé‡å¯åä¾¿ä¼šå¤±æ•ˆ\n//30000-32767ï¼Œç«¯å£åŒºé—´\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å…³é—­ç«¯å£\&#34;&gt;å…³é—­ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --zone=public --remove-port=6443/tcp --permanent\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;reloadä»¥ä¾¿-permanenté…ç½®ç”Ÿæ•ˆ\&#34;&gt;reloadä»¥ä¾¿--permanenté…ç½®ç”Ÿæ•ˆ&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo firewall-cmd --reload\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;ubuntu\&#34;&gt;Ubuntu&lt;/h1&gt;\n&lt;p&gt;æ ¸å¿ƒæŒ‡ä»¤&lt;code&gt;ufw&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;å¯ç”¨ufw\&#34;&gt;å¯ç”¨ufw&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw enable\nsudo ufw allow ssh\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£-2\&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw status\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å¼€å¯ç«¯å£-2\&#34;&gt;å¼€å¯ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw allow 10250/tcp\nsudo ufw allow 30000:32767/tcp\n//30000:32767æ˜¯ç«¯å£åŒºé—´\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å…³é—­ç«¯å£-2\&#34;&gt;å…³é—­ç«¯å£&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw delete allow 10250/tcp\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/Sungeek/p/8257681.html\&#34;&gt;https://www.cnblogs.com/Sungeek/p/8257681.html&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/Sun_Hui_/article/details/103178840\&#34;&gt;https://blog.csdn.net/Sun_Hui_/article/details/103178840&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.itcoder.tech/posts/how-to-setup-a-firewall-with-ufw-on-ubuntu-20-04/\&#34;&gt;https://www.itcoder.tech/posts/how-to-setup-a-firewall-with-ufw-on-ubuntu-20-04/&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;ubuntu-he-centos-duan-kou-she-zhi&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;è®°å½•ä¸‹ç«¯å£è®¾ç½®ï¼Œç”¨åˆ°å•¥è®°å½•å•¥ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Ubuntuå’ŒCentOSç«¯å£è®¾ç½®&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;ç«¯å£&#34;,&#34;slug&#34;:&#34;guNk0JsrG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/guNk0JsrG/&#34;},{&#34;name&#34;:&#34;port&#34;,&#34;slug&#34;:&#34;nU_jlBkSws&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/nU_jlBkSws/&#34;},{&#34;name&#34;:&#34;ufw&#34;,&#34;slug&#34;:&#34;IBSMukFxes&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/IBSMukFxes/&#34;},{&#34;name&#34;:&#34;firewalld&#34;,&#34;slug&#34;:&#34;M75-gGzjYj&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/M75-gGzjYj/&#34;},{&#34;name&#34;:&#34;firewall-cmd&#34;,&#34;slug&#34;:&#34;3Sy8n-oU5d&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/3Sy8n-oU5d/&#34;},{&#34;name&#34;:&#34;iptables&#34;,&#34;slug&#34;:&#34;OXPcFg0jmJ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/OXPcFg0jmJ/&#34;},{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;}],&#34;date&#34;:&#34;2020-08-31 17:53:59&#34;,&#34;dateFormat&#34;:&#34;2020-08-31&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/ubuntu-he-centos-duan-kou-she-zhi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:67000,&#34;words&#34;:236,&#34;minutes&#34;:2},&#34;description&#34;:&#34;è®°å½•ä¸‹ç«¯å£è®¾ç½®ï¼Œç”¨åˆ°å•¥è®°å½•å•¥ã€‚\n\nCentOS\næ ¸å¿ƒæŒ‡ä»¤firewall-cmd\næŸ¥çœ‹å·²å¼€æ”¾ç«¯å£\nsudo firewall-cmd --list-ports\n\nå¼€å¯ç«¯å£\nsudo firewall-cmd --zone=public --...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#centos\&#34;&gt;CentOS&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9F%A5%E7%9C%8B%E5%B7%B2%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3\&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%90%AF%E7%AB%AF%E5%8F%A3\&#34;&gt;å¼€å¯ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B3%E9%97%AD%E7%AB%AF%E5%8F%A3\&#34;&gt;å…³é—­ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#reload%E4%BB%A5%E4%BE%BF-permanent%E9%85%8D%E7%BD%AE%E7%94%9F%E6%95%88\&#34;&gt;reloadä»¥ä¾¿--permanenté…ç½®ç”Ÿæ•ˆ&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#ubuntu\&#34;&gt;Ubuntu&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%90%AF%E7%94%A8ufw\&#34;&gt;å¯ç”¨ufw&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9F%A5%E7%9C%8B%E5%B7%B2%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3-2\&#34;&gt;æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%90%AF%E7%AB%AF%E5%8F%A3-2\&#34;&gt;å¼€å¯ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B3%E9%97%AD%E7%AB%AF%E5%8F%A3-2\&#34;&gt;å…³é—­ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;grubçš„ä¿®æ”¹ä½ç½®å’Œç”Ÿæ•ˆæ–¹æ³•ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;ä¿®æ”¹ä½ç½®\&#34;&gt;ä¿®æ”¹ä½ç½®&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo vim /etc/default/grub\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;ç”Ÿæ•ˆæ–¹æ³•\&#34;&gt;ç”Ÿæ•ˆæ–¹æ³•&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;sudo grub2-mkconfig â€“o /etc/grub2.cfg  #CentOS\nsudo update-grub2  #Ubuntu\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;troubleshooting\&#34;&gt;Troubleshooting&lt;/h1&gt;\n&lt;h2 id=\&#34;æè¿°\&#34;&gt;æè¿°&lt;/h2&gt;\n&lt;p&gt;CentOSæŒ‰ä¸Šé¢æ“ä½œä¿®æ”¹&lt;code&gt;GRUB_TIMEOUT=0&lt;/code&gt;åï¼Œæ— è®ºæ€æ ·éƒ½ä¸ç”Ÿæ•ˆï¼Œæ— æ³•è·³è¿‡boot menuå€’è®¡æ—¶5ç§’çš„é­”å’’ã€‚å°è¯•è¿‡&lt;code&gt;GRUB_TIMEOUT_STYLE=&amp;quot;hidden&amp;quot; GRUB_HIDDEN_TIMEOUT_QUIET=true GRUB_ENABLE_BLSCFG=false&lt;/code&gt;ç­‰å„ç§é€‰é¡¹ï¼Œå‡æ— æ•ˆã€‚&lt;code&gt;sudo ls -l /boot/grub2/&lt;/code&gt;æŸ¥çœ‹&lt;code&gt;grub.cfg&lt;/code&gt;ï¼Œä¿®æ”¹æ—¶é—´çº¹ä¸æœªåŠ¨ï¼Œåˆç€ç©å„¿å‘¢ã€‚&lt;br /&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;è§£å†³\&#34;&gt;è§£å†³&lt;/h2&gt;\n&lt;p&gt;&lt;code&gt;sudo vim /etc/grub2.cfg&lt;/code&gt;å‘ç°ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt; 63 if [ x$feature_timeout_style = xy ] ; then\n 64   set timeout_style=menu\n 65   set timeout=5\n 66 # Fallback normal timeout code in case the timeout_style feature is\n 67 # unavailable.\n 68 else\n 69   set timeout=5\n 70 fi\n 71 ### END /etc/grub.d/00_header ###\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ„Ÿè§‰é—®é¢˜å‡ºåœ¨&lt;code&gt;/etc/grub.d/00_header&lt;/code&gt;ï¼Œç ”ç©¶headeråŠå¤©ï¼Œæ²¡æ‡‚ğŸ˜… &lt;br /&gt;&lt;br&gt;\nè€Œ&lt;code&gt;/etc/grub2.cfg&lt;/code&gt;å¼€ç¯‡å°±å†™ç€&lt;code&gt;# DO NOT EDIT THIS FILE&lt;/code&gt;ï¼Œå¯å®åœ¨æ²¡è¾™äº†ï¼Œè¯•ç€æ”¹äº†ä¸Šé¢65è¡Œçš„timeoutï¼Œç›´æ¥æ”¹æˆ0ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;65   set timeout=0\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä¿å­˜é€€å‡ºé‡å¯ï¼ŒæˆåŠŸäº†ã€‚è¿™éƒ½æ˜¯ä»€ä¹ˆé¬¼ã€‚ğŸ™ƒ&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/whatday/article/details/106123164\&#34;&gt;https://blog.csdn.net/whatday/article/details/106123164&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/\&#34;&gt;https://www.techbrown.com/change-default-grub2-entries-timeout-centos-7/&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;ubuntu-he-centos-xiu-gai-grub&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;grubçš„ä¿®æ”¹ä½ç½®å’Œç”Ÿæ•ˆæ–¹æ³•ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Ubuntuå’ŒCentOSä¿®æ”¹grub&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Linux&#34;,&#34;slug&#34;:&#34;mTyB0fhtc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/mTyB0fhtc/&#34;},{&#34;name&#34;:&#34;Grub&#34;,&#34;slug&#34;:&#34;SaVkQAc9U4&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/SaVkQAc9U4/&#34;},{&#34;name&#34;:&#34;é…ç½®&#34;,&#34;slug&#34;:&#34;Bwz1BaTtzi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/Bwz1BaTtzi/&#34;},{&#34;name&#34;:&#34;å¼€æœº&#34;,&#34;slug&#34;:&#34;SziKjUrpjt&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/SziKjUrpjt/&#34;},{&#34;name&#34;:&#34;å¯åŠ¨é¡¹&#34;,&#34;slug&#34;:&#34;rBmg59Vjxj&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/rBmg59Vjxj/&#34;},{&#34;name&#34;:&#34;å¯åŠ¨æ—¶é—´&#34;,&#34;slug&#34;:&#34;cWawItHFUb&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/cWawItHFUb/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;}],&#34;date&#34;:&#34;2020-08-31 11:19:33&#34;,&#34;dateFormat&#34;:&#34;2020-08-31&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/ubuntu-he-centos-xiu-gai-grub/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:72000,&#34;words&#34;:254,&#34;minutes&#34;:2},&#34;description&#34;:&#34;grubçš„ä¿®æ”¹ä½ç½®å’Œç”Ÿæ•ˆæ–¹æ³•ã€‚\n\nä¿®æ”¹ä½ç½®\nsudo vim /etc/default/grub\n\nç”Ÿæ•ˆæ–¹æ³•\nsudo grub2-mkconfig â€“o /etc/grub2.cfg  #CentOS\nsudo update-grub2 ...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BF%AE%E6%94%B9%E4%BD%8D%E7%BD%AE\&#34;&gt;ä¿®æ”¹ä½ç½®&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%94%9F%E6%95%88%E6%96%B9%E6%B3%95\&#34;&gt;ç”Ÿæ•ˆæ–¹æ³•&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#troubleshooting\&#34;&gt;Troubleshooting&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8F%8F%E8%BF%B0\&#34;&gt;æè¿°&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E5%86%B3\&#34;&gt;è§£å†³&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;ç¬¬ä¸€æ¬¡æ‹¥æœ‰è‡ªå·±çš„åšå®¢ï¼Œæ„Ÿè§‰å…´å¥‹ï¼ŒæŠ˜è…¾äº†åŠå¤©ï¼Œä¸»è¦æ˜¯ä¸ºäº†è‡ªå·±èƒ½æœ‰ä¸€ä¸ªè®°å½•å’Œåæ§½çš„åœ°æ–¹ã€‚æ›¾ç»ä¹Ÿåœ¨å…¶ä»–ç½‘ç«™åšè¿‡bloggerï¼Œç»“æœè¦ä¹ˆå…³å¼ è¦ä¹ˆæ¶ˆå¤±è¦ä¹ˆå¢™å¢™ï¼Œä¸€è¨€éš¾å°½ã€‚&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;about&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;å…³äº&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;å…³äº&#34;,&#34;slug&#34;:&#34;_YTMFN_lm&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/_YTMFN_lm/&#34;},{&#34;name&#34;:&#34;about&#34;,&#34;slug&#34;:&#34;cVh0paDPKo&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/cVh0paDPKo/&#34;}],&#34;date&#34;:&#34;2020-08-28 17:32:03&#34;,&#34;dateFormat&#34;:&#34;2020-08-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/about/&#34;,&#34;hideInList&#34;:true,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:13000,&#34;words&#34;:67,&#34;minutes&#34;:1},&#34;description&#34;:&#34;ç¬¬ä¸€æ¬¡æ‹¥æœ‰è‡ªå·±çš„åšå®¢ï¼Œæ„Ÿè§‰å…´å¥‹ï¼ŒæŠ˜è…¾äº†åŠå¤©ï¼Œä¸»è¦æ˜¯ä¸ºäº†è‡ªå·±èƒ½æœ‰ä¸€ä¸ªè®°å½•å’Œåæ§½çš„åœ°æ–¹ã€‚æ›¾ç»ä¹Ÿåœ¨å…¶ä»–ç½‘ç«™åšè¿‡bloggerï¼Œç»“æœè¦ä¹ˆå…³å¼ è¦ä¹ˆæ¶ˆå¤±è¦ä¹ˆå¢™å¢™ï¼Œä¸€è¨€éš¾å°½ã€‚\n&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æœ¬æ–‡ä¸»è¦æ˜¯è¸©å‘åæƒ³è®°å½•ä¸‹é¿å‘æ–¹æ³•ï¼Œå†…å®¹æ¶‰åŠKubernetes, Kubeadm, Kubectl, Kubelet, Ubuntu, CentOS, Flannel, Docker, é˜¿é‡Œäº‘ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&#34;å†™ä½œèƒŒæ™¯\&#34;&gt;å†™ä½œèƒŒæ™¯&lt;/h1&gt;\n&lt;p&gt;åˆå­¦Kubernetesï¼Œè™½ç„¶ç½‘ä¸Šèµ„æºå¾ˆå¤šï¼Œä½†æ²¡ä¸€ä¸ªèƒ½å½»åº•æå®šï¼Œäºæ˜¯æ‚çƒ©ä¸€ä¸‹ã€‚&lt;/p&gt;\n&lt;h1 id=\&#34;å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œ\&#34;&gt;å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œ&lt;/h1&gt;\n&lt;blockquote&gt;\n&lt;p&gt;control nodeï¼ˆæ§åˆ¶èŠ‚ç‚¹ï¼‰ã€worker nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ éƒ½è¦åšè¿™äº›å‡†å¤‡å·¥ä½œã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2 id=\&#34;æ£€æŸ¥å„ä¸»æœºé…ç½®\&#34;&gt;æ£€æŸ¥å„ä¸»æœºé…ç½®&lt;/h2&gt;\n&lt;h3 id=\&#34;æ£€æŸ¥cpuå’Œå†…å­˜\&#34;&gt;æ£€æŸ¥cpuå’Œå†…å­˜&lt;/h3&gt;\n&lt;p&gt;æ— è®ºæ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯ç‰©ç†æœºï¼Œéƒ½è¦æ±‚&lt;strong&gt;cpuå†…æ ¸â‰¥2ï¼Œå†…å­˜â‰¥2G&lt;/strong&gt;ã€‚&lt;/p&gt;\n&lt;h3 id=\&#34;æ£€æŸ¥ä¸»æœºåhostname\&#34;&gt;æ£€æŸ¥ä¸»æœºåhostname&lt;/h3&gt;\n&lt;p&gt;hostnameè¦æ±‚&lt;strong&gt;ä¸èƒ½æ˜¯ localhostï¼Œä¸”ä¸åŒ…å«ä¸‹åˆ’çº¿ã€å°æ•°ç‚¹ã€å¤§å†™å­—æ¯&lt;/strong&gt;ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;# æ£€æŸ¥hostname\nhostname \n# ä¿®æ”¹ hostname\nhostnamectl set-hostname åå­—\n# æŸ¥çœ‹ä¿®æ”¹ç»“æœ\nhostnamectl status\n# è®¾ç½® hostname è§£æ\necho &amp;quot;127.0.0.1   $(hostname)&amp;quot; &amp;gt;&amp;gt; /etc/hosts\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;è®¾ç½®å›ºå®šip\&#34;&gt;è®¾ç½®å›ºå®šIP&lt;/h3&gt;\n&lt;p&gt;å»ºè®®ä½¿ç”¨nmclié…ç½®ï¼Œå› ä¸ºè·¨å¹³å°ï¼ˆUbuntuå’ŒCentOSï¼‰ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;nmcli\n//å¦‚æœæç¤ºæ²¡æœ‰å®‰è£…ï¼Œå…ˆæŒ‰ä¸‹é¢æ­¥éª¤å®‰è£…\n# å®‰è£…nmcli\nsudo yum install NetworkManager #CentOS\nsudo apt-get install network-manager #Ubuntu\n# æ£€æŸ¥nmcliæ˜¯å¦æ¥ç®¡äº†ç½‘ç»œç®¡ç†\nnmcli g\n//æ­£å¸¸æ˜¯æ˜¾ç¤ºç»¿è‰²çš„ä¿¡æ¯ã€‚å¦‚æœSTATEåˆ—æ˜¾ç¤ºdisconnectedï¼Œåˆ™Ubuntuè¦ä¿®æ”¹/etc/netplan/é‡Œçš„yamlæ–‡ä»¶ï¼Œåœ¨versionä¸‹é¢æ·»åŠ ä¸€è¡Œrenderer: NetworkManagerï¼Œä¿å­˜é€€å‡ºåæ‰§è¡Œsudo systemctl daemon-reload å’Œ sudo systemctl restart NetworkManager\n# æŸ¥çœ‹å½“å‰é»˜è®¤ç½‘å¡å’Œipä¿¡æ¯\nip route show\nip a\n//ip route show å‘½ä»¤ä¸­ï¼Œå¯ä»¥çŸ¥é“æœºå™¨çš„ç½‘å…³DNSå’Œé»˜è®¤ç½‘å¡ï¼Œå¦‚ default via 192.168.127.2 dev ens33ï¼Œviaåé¢çš„å†…å®¹ 192.168.127.2 å°±æ˜¯ç½‘å…³å’ŒDNSï¼Œdevåé¢çš„å†…å®¹ ens33 å°±æ˜¯é»˜è®¤ç½‘å¡\n//ip a å‘½ä»¤ä¸­ï¼Œå¯æ˜¾ç¤ºé»˜è®¤ç½‘å¡çš„ IP åœ°å€ï¼ŒKubernetes å°†ä½¿ç”¨æ­¤ IP åœ°å€ä¸é›†ç¾¤å†…çš„å…¶ä»–èŠ‚ç‚¹é€šä¿¡ï¼Œå¦‚192.168.127.131\n//æ‰€æœ‰èŠ‚ç‚¹ä¸Š Kubernetes æ‰€ä½¿ç”¨çš„ IP åœ°å€å¿…é¡»å¯ä»¥äº’é€šï¼ˆæ— éœ€ NAT æ˜ å°„ã€æ— å®‰å…¨ç»„æˆ–é˜²ç«å¢™éš”ç¦»ï¼‰\n# è®¾ç½®å›ºå®šIPï¼Œç½‘å¡ã€ipåœ°å€ã€ç½‘å…³ã€DNSå¯å‚è€ƒä¸Šé¢çš„ä¿¡æ¯\nsudo nmcli c mod ens33 \\\nipv4.addresses 192.168.127.131/24 \\\nipv4.method manual \\\nipv4.gateway 192.168.127.2 \\\nipv4.dns 192.168.127.2\n# è®©é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ\nsudo nmcli c up ens33\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;è®¾ç½®iptables\&#34;&gt;è®¾ç½®iptables&lt;/h2&gt;\n&lt;p&gt;æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo modprobe br_netfilter\ncat &amp;lt;&amp;lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\nsudo sysctl --system\n# å¦‚æœæƒ³æ£€æŸ¥é…ç½®ï¼Œå¯æ‰§è¡Œ\nsysctl -n net.bridge.bridge-nf-call-iptables\nsysctl -n net.bridge.bridge-nf-call-ip6tables\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ‰“å¼€ç«¯å£\&#34;&gt;æ‰“å¼€ç«¯å£&lt;/h2&gt;\n&lt;h3 id=\&#34;ubuntuçš„å‡†å¤‡å·¥ä½œ\&#34;&gt;Ubuntuçš„å‡†å¤‡å·¥ä½œ&lt;/h3&gt;\n&lt;p&gt;å…ˆæ‰“å¼€Ubuntuè‡ªå¸¦çš„é˜²ç«å¢™ufwã€‚æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw enable\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ‰§è¡Œåæç¤ºå¯èƒ½æ–­å¼€è¿æ¥ï¼Œç›´æ¥yç»§ç»­ï¼Œåˆ«æ‹…å¿ƒï¼Œsshè¿æ¥ä¸ä¼šæ–­ã€‚&lt;br&gt;\nå¦‚æœä½¿ç”¨sshè¿æ¥ï¼Œè¿˜éœ€è¦æ‰§è¡Œä¸‹é¢ä»£ç ï¼Œä»¥ä¾¿æ‰“å¼€sshè¿æ¥ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo ufw allow ssh\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;æ‰“å¼€ç›¸åº”ç«¯å£\&#34;&gt;æ‰“å¼€ç›¸åº”ç«¯å£&lt;/h3&gt;\n&lt;p&gt;ä¾æ®æ‰€ä½¿ç”¨çš„ç³»ç»Ÿï¼ˆUbuntu / CentOSï¼‰ï¼Œæ‰§è¡Œç›¸åº”ä»£ç ã€‚&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;æ§åˆ¶èŠ‚ç‚¹ Control-plane nodes&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;# Ubuntu\nsudo ufw allow 6443/tcp\nsudo ufw allow 2379:2380/tcp\nsudo ufw allow 10250:10252/tcp\nsudo ufw allow 8472/udp #for flannelã€‚å¦‚æœä¸å¼€ï¼Œåˆ™corednsæ— æ³•ä¸ºworker nodesæœåŠ¡\n//ä¸Šé¢ä»£ç ä¸­çš„å†’å·ä»£è¡¨ç«¯å£åŒºé—´ã€‚\n\n# CentOS\nsudo firewall-cmd --zone=public --add-port=6443/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=2379-2380/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=10250-10252/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=8472/udp --permanent #for flannelã€‚å¦‚æœä¸å¼€ï¼Œåˆ™corednsæ— æ³•ä¸ºworker nodesæœåŠ¡\nsudo firewall-cmd --add-masquerade --permanent #for flannel NAT\nsudo firewall-cmd --reload\nsudo firewall-cmd --list-ports //æŸ¥çœ‹è®¾ç½®æ•ˆæœ\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;å·¥ä½œèŠ‚ç‚¹ Worker nodes&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;# Ubuntu\nsudo ufw allow 10250/tcp\nsudo ufw allow 30000:32767/tcp\nsudo ufw allow 8472/udp #for flannel\n\n# CentOS\nsudo firewall-cmd --zone=public --add-port=10250/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=30000-32767/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=8472/udp --permanent #for flannel\nsudo firewall-cmd --add-masquerade --permanent #for flannel NAT\nsudo firewall-cmd --reload\nsudo firewall-cmd --list-ports //æŸ¥çœ‹è®¾ç½®æ•ˆæœ\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;ç¦ç”¨swap\&#34;&gt;ç¦ç”¨swap&lt;/h2&gt;\n&lt;p&gt;ç”±äºswapæ€§èƒ½ä½ä¸‹ï¼ŒKubeadmé»˜è®¤è¦æ±‚ç¦æ­¢ä½¿ç”¨swapã€‚æ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo swapoff -a  #ä¸´æ—¶ç¦ç”¨swap\nsudo sed -i &#39;s/.*swap.*/#&amp;amp;/&#39; /etc/fstab  #æ°¸ä¹…ç¦ç”¨swap\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å¯é€šè¿‡&lt;code&gt;free -m&lt;/code&gt;æ¥æ£€æŸ¥ç¦ç”¨æ•ˆæœã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;å®‰è£…docker\&#34;&gt;å®‰è£…docker&lt;/h2&gt;\n&lt;p&gt;è¯¦è§&lt;a href=\&#34;/post/zai-centos-he-ubuntu-shang-an-zhuang-he-pei-zhi-docker\&#34;&gt;dockerå®‰è£…å’Œé…ç½®&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;åˆ›å»ºk8sæ–‡ä»¶å¤¹\&#34;&gt;åˆ›å»ºk8sæ–‡ä»¶å¤¹&lt;/h2&gt;\n&lt;p&gt;å¯ç”¨æ¥å­˜æ”¾ç›¸å…³æ–‡ä»¶ã€‚æ‰§è¡Œä¸‹é¢ä»£ç ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mkdir ~/k8s\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;å®‰è£…kubeadm-kubeletå’Œkubectl\&#34;&gt;å®‰è£…kubeadm, kubeletå’Œkubectl&lt;/h1&gt;\n&lt;blockquote&gt;\n&lt;p&gt;control nodeï¼ˆæ§åˆ¶èŠ‚ç‚¹ï¼‰ã€worker nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ ä¸Šéƒ½å®‰è£…ã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;&lt;strong&gt;Ubuntu&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo apt-get update &amp;amp;&amp;amp; sudo apt-get install -y apt-transport-https curl\ncurl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -\ncat &amp;lt;&amp;lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list\ndeb https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main\nEOF\nsudo apt-get update\nsudo apt-get install -y kubelet kubeadm kubectl\nsudo apt-mark hold kubelet kubeadm kubectl\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;CentOS&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nexclude=kubelet kubeadm kubectl\nEOF\n\n# Set SELinux in permissive mode (effectively disabling it)\nsudo setenforce 0\nsudo sed -i &#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39; /etc/selinux/config\n\nsudo yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes\n\nsudo systemctl enable --now kubelet\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;åœ¨control-nodeæ§åˆ¶èŠ‚ç‚¹ä¸Šç”¨kubeadmåˆ›å»ºé›†ç¾¤\&#34;&gt;åœ¨control nodeæ§åˆ¶èŠ‚ç‚¹ä¸Šç”¨kubeadmåˆ›å»ºé›†ç¾¤&lt;/h1&gt;\n&lt;h2 id=\&#34;åˆå§‹åŒ–é›†ç¾¤\&#34;&gt;åˆå§‹åŒ–é›†ç¾¤&lt;/h2&gt;\n&lt;!-- - æ–¹æ³•ä¸€ï¼ˆæ¨èï¼Œèƒ½æˆåŠŸå°±å¾ˆå¹¸è¿ï¼‰--&gt;\n&lt;pre&gt;&lt;code&gt;sudo kubeadm init --apiserver-advertise-address=ä½ çš„æœ¬æœºIP \\\n--pod-network-cidr=10.244.0.0/16 \\\n--kubernetes-version=v1.19.0 \\\n--image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers\n...\n...\nkubeadm join 192.168.127.132:6443 --token 4pwz11.1m0u1k3ak3ibgx08 \\\n    --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7   \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å°†è¾“å‡ºå†…å®¹ä¸­çš„&lt;code&gt;kubeadm join ...&lt;/code&gt;è®°å½•ä¸‹æ¥ï¼Œè¿™æ˜¯å…¶ä»–èŠ‚ç‚¹åŠ å…¥ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚&lt;/p&gt;\n&lt;!-- å¦‚æœå®‰è£…å¤±è´¥ï¼Œå†è¯•å‡ æ¬¡ï¼Œè¿˜ä¸è¡Œå°±å°è¯•æ–¹æ³•äºŒã€‚\nå¦‚æœå®‰è£…æˆåŠŸï¼Œåˆ™è¾“å‡ºç±»ä¼¼ä¸‹é¢å†…å®¹ï¼Œå°†å†…å®¹ä¸­çš„`kubeadm join ...`å•ç‹¬ä¿å­˜å‡ºæ¥ï¼Œè¿™æ˜¯å…¶ä»–èŠ‚ç‚¹åŠ å…¥ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚è·³è¿‡æ–¹æ³•äºŒã€‚\nå¦‚æœå®‰è£…é¡ºåˆ©ï¼Œ&lt;a href=\&#34;#%E8%B5%8B%E4%BA%88%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8kubectl%E7%9A%84%E6%9D%83%E9%99%90\&#34;&gt;ç‚¹è¿™é‡Œè·³è¿‡æ–¹æ³•äºŒ&lt;/a&gt;ã€‚\n## åˆå§‹åŒ–é›†ç¾¤ - æ–¹æ³•äºŒï¼ˆåªåœ¨æ–¹æ³•ä¸€å¤±è´¥çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼‰\nç”±äºç§ç§åŸå› ï¼Œå›½å†…æ— æ³•ä»k8s.gcr.ioä¸‹è½½åˆ°kubeadméƒ¨ç½²æ‰€éœ€çš„æ–‡ä»¶ï¼Œä»¥ä¸‹æ–¹æ³•å°†é€šè¿‡é˜¿é‡Œäº‘è·å–ã€‚\n### å‡†å¤‡å·¥ä½œ\n#### æŸ¥çœ‹æ‰€éœ€é•œåƒ\n```\nkubeadm config images list\n#ä¸‹é¢æ˜¯æ‰§è¡Œçš„ç»“æœ\nk8s.gcr.io/kube-apiserver:v1.18.8\nk8s.gcr.io/kube-controller-manager:v1.18.8\nk8s.gcr.io/kube-scheduler:v1.18.8\nk8s.gcr.io/kube-proxy:v1.18.8\nk8s.gcr.io/pause:3.2\nk8s.gcr.io/etcd:3.4.3-0\nk8s.gcr.io/coredns:1.6.7\n```\n#### åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°æ‰¾åˆ°æ‰€éœ€é•œåƒ\n1. [https://cr.console.aliyun.com/](https://cr.console.aliyun.com/)  å·¦ä¾§ç‚¹â€é•œåƒæœç´¢â€œ\n2. åˆ†åˆ«æœç´¢â€kube-apiserverâ€œç­‰æ‰€æœ‰åç§°ï¼Œç‚¹å¼€æœç´¢åˆ°çš„é•œåƒï¼Œä¸€å®šæ‰¾åˆ°æ­£ç¡®çš„ç‰ˆæœ¬å·ï¼ˆå¦‚v1.18.8ï¼‰ï¼ˆæ—¥æœŸè¶Šæ–°çš„è¶Šå®¹æ˜“æ‰¾åˆ°ï¼‰ï¼Œå¤åˆ¶é¡µé¢ä¸­çš„â€å…¬ç½‘åœ°å€â€œ\n#### pullé•œåƒã€æ‰“æ ‡ç­¾ã€ç§»é™¤æ— ç”¨é•œåƒ\n1. pullé•œåƒ\n```\nKUBE_VERSION=v1.18.8\nPAUSE_VERSION=3.2\nETCD_VERSION=3.4.3-0\nCORE_DNS_VERSION=1.6.7\ndocker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-controller-manager:$KUBE_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-scheduler:$KUBE_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-proxy:$KUBE_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION\ndocker pull registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION\n```\n2. ç»™pullä¸‹æ¥çš„é•œåƒæ‰“æ ‡ç­¾\nå› ä¸ºkubeadméƒ¨ç½²æ—¶ä¼šæ‰¾k8s.gcr.ioæ ‡ç­¾çš„é•œåƒï¼Œå› æ­¤éœ€è¦å°†ä¸Šä¸€æ­¥pullçš„é•œåƒæ‰“ä¸Šk8s.gcr.ioæ ‡ç­¾ã€‚\n```\ndocker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION  k8s.gcr.io/kube-proxy:$KUBE_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-controller-manager:$KUBE_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-apiserver:$KUBE_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION k8s.gcr.io/kube-scheduler:$KUBE_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION k8s.gcr.io/pause:$PAUSE_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION k8s.gcr.io/coredns:$CORE_DNS_VERSION\ndocker tag registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION k8s.gcr.io/etcd:$ETCD_VERSION\n```\n3. ç§»é™¤ä»é˜¿é‡Œäº‘pullä¸‹æ¥çš„é•œåƒ\n```\ndocker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-apiserver:$KUBE_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-controller-manager:$KUBE_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-scheduler:$KUBE_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/wyc_google_containers/kube-proxy:$KUBE_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/pause:$PAUSE_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:$CORE_DNS_VERSION\ndocker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:$ETCD_VERSION\n``` \n### éƒ¨ç½²\n```\nsudo kubeadm init --apiserver-advertise-address=ä½ çš„æœ¬æœºIP --pod-network-cidr=10.244.0.0/16  --kubernetes-version=v1.19.0\n#æ‰§è¡Œåçš„è¾“å‡º\n...\n...\nkubeadm join 192.168.127.132:6443 --token 4pwz11.1m0u1k3ak3ibgx08 \\\n    --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7\n```--&gt;\n&lt;h2 id=\&#34;èµ‹äºˆå½“å‰ç”¨æˆ·ä½¿ç”¨kubectlçš„æƒé™\&#34;&gt;èµ‹äºˆå½“å‰ç”¨æˆ·ä½¿ç”¨kubectlçš„æƒé™&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å®‰è£…ç½‘ç»œç»„ä»¶flannel\&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/h2&gt;\n&lt;h3 id=\&#34;å‡†å¤‡å·¥ä½œ\&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h3&gt;\n&lt;p&gt;ç”±äºç§ç§åŸå› ï¼Œæ— æ³•ç›´æ¥pullåˆ°ç½‘ç»œç»„ä»¶flannelçš„dockeré•œåƒï¼Œå› æ­¤éœ€å•ç‹¬ä¸‹è½½ã€‚&lt;br&gt;\nhttps://github.com/coreos/flannel/releases/download/v0.12.0/flanneld-v0.12.0-amd64.docker&lt;br&gt;\nä¸‹è½½åæ”¾è¿›&lt;code&gt;~/k8s&lt;/code&gt;ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;cd ~/k8s\ndocker load &amp;lt; flanneld-v0.12.0-amd64.docker\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;å¼€å§‹å®‰è£…\&#34;&gt;å¼€å§‹å®‰è£…&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\nkubectl apply -f kube-flannel.yml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ£€æŸ¥éƒ¨ç½²æƒ…å†µ\&#34;&gt;æ£€æŸ¥éƒ¨ç½²æƒ…å†µ&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get nodes\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://tomhht.github.io/post-images/1598781753839.png\&#34; alt=\&#34;èŠ‚ç‚¹è¿è¡Œæƒ…å†µ\&#34; loading=\&#34;lazy\&#34;&gt;     &lt;br /&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get pods -A\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://tomhht.github.io/post-images/1598781791291.png\&#34; alt=\&#34;Podsè¿è¡Œæƒ…å†µ\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\né€šè¿‡&lt;code&gt;docker container ls&lt;/code&gt;ä¹Ÿå¯ä»¥çœ‹åˆ°podsé‡Œçš„å®¹å™¨è¿è¡Œæƒ…å†µã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;æ‰“å¼€kubectlå’Œkubeadmçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½\&#34;&gt;æ‰“å¼€kubectlå’Œkubeadmçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;echo &#39;source &amp;lt;(kubectl completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc\necho &#39;source &amp;lt;(kubeadm completion bash)&#39; &amp;gt;&amp;gt;~/.bashrc\nsource ~/.bashrc #ä½¿é…ç½®ç«‹åˆ»ç”Ÿæ•ˆ\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»¥ä¸Šä¸ºcontrol nodeæ§åˆ¶èŠ‚ç‚¹çš„éƒ¨ç½²å…¨æµç¨‹ã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&#34;worker-nodeå·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤\&#34;&gt;worker nodeå·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤&lt;/h1&gt;\n&lt;blockquote&gt;\n&lt;p&gt;ç¡®è®¤åœ¨worker nodeä¸»æœºä¸Šå·²å®‰è£…äº†kubeadm, kubeletå’Œkubectlã€‚&lt;br&gt;\nå¦‚æœªå®‰è£…ï¼Œå‚è€ƒ&lt;a href=\&#34;#å®‰è£…kubeadm-kubeletå’Œkubectl\&#34;&gt;å®‰è£…kubeadm, kubeletå’Œkubectl&lt;/a&gt;ã€‚&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2 id=\&#34;å®‰è£…ç½‘ç»œç»„ä»¶flannel-2\&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;åœ¨&lt;strong&gt;control node&lt;/strong&gt;ä¸Šå¯¼å‡ºflannelçš„dockeré•œåƒï¼Œå¹¶å¤åˆ¶åˆ°worker nodeï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;blockquote&gt;\n&lt;p&gt;æé†’ï¼š~/k8sç›®å½•åœ¨å„nodeä¸Šéƒ½æå‰å»ºå¥½&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;pre&gt;&lt;code&gt;docker save quay.io/coreos/flannel:v0.12.0 &amp;gt; ~/k8s/flannel-v0.12.0.tar\nscp ~k8s/flannel-v0.12.0.tar tom@192.168.127.133:~/k8s\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;åœ¨&lt;strong&gt;worker node&lt;/strong&gt;ä¸Šå¯¼å…¥flannelçš„dockeré•œåƒï¼š&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;docker load &amp;lt; k8s/flannel-v0.12.0.tar\n&lt;/code&gt;&lt;/pre&gt;\n&lt;!-- ## è½½å…¥control  nodeä¸Špullå¥½çš„é•œåƒ\n1. åœ¨control nodeä¸Šï¼Œå¤‡ä»½å‡ºå…¨å¥—dockeré•œåƒï¼ˆå«kubeadmæ‰€éœ€é•œåƒ+ç½‘ç»œç»„ä»¶flannelé•œåƒï¼‰ï¼š\n```\ncd ~/k8s\ndocker save k8s.gcr.io/kube-proxy:v1.18.8 \\\nk8s.gcr.io/kube-apiserver:v1.18.8 \\\nk8s.gcr.io/kube-controller-manager:v1.18.8 \\\nk8s.gcr.io/kube-scheduler:v1.18.8 \\\nk8s.gcr.io/pause:3.2 \\\nk8s.gcr.io/coredns:1.6.7 \\\nk8s.gcr.io/etcd:3.4.3-0 \\\nquay.io/coreos/flannel:v0.12.0-amd64 &gt; k8s-imagesV1.18.8-flannelV0.12.0.tar\n```\n&gt; ä¹‹å‰è¸©å‘ï¼Œå·æ‡’ç”¨IMAGE IDåšçš„å¤‡ä»½ï¼Œç»“æœè½½å…¥ä»¥ånameå’Œtagå…¨éƒ½æ˜¯noneï¼Œè¿˜å¾—æ‰“nameå’Œtagä¸Šå»ï¼Œæ— æ¯”ç¹ç- _ -||\n2. scpä¸Šé¢çš„å¤‡ä»½æ–‡ä»¶åˆ°å„ä¸ªworker nodeçš„`~/k8s`æ–‡ä»¶å¤¹é‡Œ\n3. åœ¨worker nodeä¸Šè½½å…¥å¤‡ä»½æ–‡ä»¶ï¼š\n```\ncd ~/k8s\ndocker load &lt; k8s-imagesV1.18.8-flannelV0.12.0.tar\n```\n&gt; worker nodeå®é™…éœ€è¦çš„åªæœ‰3ä¸ªé•œåƒï¼Œåˆ†åˆ«æ˜¯`kube-proxy, pause, flannel`--&gt;\n&lt;h2 id=\&#34;åŠ å…¥é›†ç¾¤\&#34;&gt;åŠ å…¥é›†ç¾¤&lt;/h2&gt;\n&lt;p&gt;åœ¨worker nodeä¸Šï¼Œæ‰§è¡Œä¹‹å‰è®°å½•çš„&lt;code&gt;kubeadm join...&lt;/code&gt;ä»£ç ï¼Œç±»ä¼¼äºï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo kubeadm join 192.168.127.132:6443 --token rddtz5.mz2v4ee96177eay5     --discovery-token-ca-cert-hash sha256:671404c4f80afe5d06d8eefcd5acc6049c4d84f1ebf1091b09bc180ea44e79b7\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å¦‚æœjoinæŒ‡ä»¤æ²¡è®°å½•ä¸‹æ¥ï¼Œæˆ–è€…é›†ç¾¤åˆ›å»ºå·²ç»è¶…è¿‡24å°æ—¶äº†ï¼Œé‚£ä¹ˆéœ€è¦é‡æ–°ç”ŸæˆjoinæŒ‡ä»¤ã€‚åœ¨&lt;strong&gt;control node&lt;/strong&gt;ä¸Šæ‰§è¡Œï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubeadm token create --print-join-command\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å¤åˆ¶è¾“å‡ºçš„å†…å®¹å¹¶åœ¨&lt;strong&gt;worker node&lt;/strong&gt;ä¸Šæ‰§è¡Œå³å¯åŠ å…¥ã€‚&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&#34;æ£€æŸ¥éƒ¨ç½²ç»“æœ\&#34;&gt;æ£€æŸ¥éƒ¨ç½²ç»“æœ&lt;/h1&gt;\n&lt;p&gt;åœ¨control nodeä¸Šæ‰§è¡Œï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get nodes -o wide\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://tomhht.github.io/post-images/1599032788153.png\&#34; alt=\&#34;é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯\&#34; loading=\&#34;lazy\&#34;&gt; &lt;br /&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl get pods -A -o wide\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://tomhht.github.io/post-images/1599032818248.png\&#34; alt=\&#34;é›†ç¾¤podsä¿¡æ¯\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nå¦‚æœSTATUSä¸æ˜¯Runningï¼Œåˆ™æ’æŸ¥æ•…éšœç‚¹ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl describe pods -n kube-system kube-proxy-t2zbw\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;troubleshooting\&#34;&gt;Troubleshooting&lt;/h1&gt;\n&lt;h2 id=\&#34;pull-imageå¤±è´¥\&#34;&gt;pull imageå¤±è´¥&lt;/h2&gt;\n&lt;p&gt;å¦‚æœ&lt;code&gt;kubectl get pods -n kube-system -o wide&lt;/code&gt;å‘ç°æŸä¸ªpodsè¿˜æ²¡readyï¼Œè€Œdockerä¹Ÿå·²ç»é…ç½®äº†å›½å†…åŠ é€Ÿå™¨ï¼Œé‚£ä¹ˆè¯•ç€é‡å¯dockerä¸€ä¸‹ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo systemctl restart docker.service\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;br&gt;\n&lt;a href=\&#34;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/\&#34;&gt;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/hellxz/p/use-kubeadm-init-kubernetes-cluster.html\&#34;&gt;https://www.cnblogs.com/hellxz/p/use-kubeadm-init-kubernetes-cluster.html&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.kuboard.cn/install/install-k8s.html\&#34;&gt;https://www.kuboard.cn/install/install-k8s.html&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://blog.csdn.net/LeonardoYasuo/article/details/101483438\&#34;&gt;https://blog.csdn.net/LeonardoYasuo/article/details/101483438&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://www.cnblogs.com/yinzhengjie/p/12258215.html\&#34;&gt;https://www.cnblogs.com/yinzhengjie/p/12258215.html&lt;/a&gt;&lt;br&gt;\n&lt;a href=\&#34;https://developer.aliyun.com/article/763983\&#34;&gt;https://developer.aliyun.com/article/763983&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;zai-ubuntu-2004-shang-shi-yong-kubeadm-bu-shu-kubernetes-ji-qun&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æœ¬æ–‡ä¸»è¦æ˜¯è¸©å‘åæƒ³è®°å½•ä¸‹é¿å‘æ–¹æ³•ï¼Œå†…å®¹æ¶‰åŠKubernetes, Kubeadm, Kubectl, Kubelet, Ubuntu, CentOS, Flannel, Docker, é˜¿é‡Œäº‘ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;åœ¨Ubuntu 20.04å’ŒCentOS 8ä¸Šä½¿ç”¨kubeadméƒ¨ç½²Kubernetesé›†ç¾¤&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Kubernetes&#34;,&#34;slug&#34;:&#34;2myAgZVX1&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/2myAgZVX1/&#34;},{&#34;name&#34;:&#34;Kubeadm&#34;,&#34;slug&#34;:&#34;o7K32AxyIA&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/o7K32AxyIA/&#34;},{&#34;name&#34;:&#34;Kubectl&#34;,&#34;slug&#34;:&#34;xGRD-5em-T&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/xGRD-5em-T/&#34;},{&#34;name&#34;:&#34;Kubelet&#34;,&#34;slug&#34;:&#34;et2DIyRaOM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/et2DIyRaOM/&#34;},{&#34;name&#34;:&#34;Ubuntu&#34;,&#34;slug&#34;:&#34;pelgqi16au&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/pelgqi16au/&#34;},{&#34;name&#34;:&#34;CentOS&#34;,&#34;slug&#34;:&#34;qjvKbAF653&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/qjvKbAF653/&#34;},{&#34;name&#34;:&#34;Flannel&#34;,&#34;slug&#34;:&#34;2W4Ff5s-rE&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/2W4Ff5s-rE/&#34;},{&#34;name&#34;:&#34;Docker&#34;,&#34;slug&#34;:&#34;RkYw1lQ_qY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/RkYw1lQ_qY/&#34;},{&#34;name&#34;:&#34;Aliyun&#34;,&#34;slug&#34;:&#34;LQERLoeDmq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/LQERLoeDmq/&#34;},{&#34;name&#34;:&#34;é˜¿é‡Œäº‘&#34;,&#34;slug&#34;:&#34;CDrtFP3hgt&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://tomhht.github.io/tag/CDrtFP3hgt/&#34;}],&#34;date&#34;:&#34;2020-08-27 18:40:02&#34;,&#34;dateFormat&#34;:&#34;2020-08-27&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://tomhht.github.io/post/zai-ubuntu-2004-shang-shi-yong-kubeadm-bu-shu-kubernetes-ji-qun/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:534000,&#34;words&#34;:1871,&#34;minutes&#34;:9},&#34;description&#34;:&#34;æœ¬æ–‡ä¸»è¦æ˜¯è¸©å‘åæƒ³è®°å½•ä¸‹é¿å‘æ–¹æ³•ï¼Œå†…å®¹æ¶‰åŠKubernetes, Kubeadm, Kubectl, Kubelet, Ubuntu, CentOS, Flannel, Docker, é˜¿é‡Œäº‘ã€‚\n\nå†™ä½œèƒŒæ™¯\nåˆå­¦Kubernetesï¼Œè™½ç„¶ç½‘...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%86%99%E4%BD%9C%E8%83%8C%E6%99%AF\&#34;&gt;å†™ä½œèƒŒæ™¯&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œ&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5%E5%90%84%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE\&#34;&gt;æ£€æŸ¥å„ä¸»æœºé…ç½®&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5cpu%E5%92%8C%E5%86%85%E5%AD%98\&#34;&gt;æ£€æŸ¥cpuå’Œå†…å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5%E4%B8%BB%E6%9C%BA%E5%90%8Dhostname\&#34;&gt;æ£€æŸ¥ä¸»æœºåhostname&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BE%E7%BD%AE%E5%9B%BA%E5%AE%9Aip\&#34;&gt;è®¾ç½®å›ºå®šIP&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BE%E7%BD%AEiptables\&#34;&gt;è®¾ç½®iptables&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%89%93%E5%BC%80%E7%AB%AF%E5%8F%A3\&#34;&gt;æ‰“å¼€ç«¯å£&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#ubuntu%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;Ubuntuçš„å‡†å¤‡å·¥ä½œ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%89%93%E5%BC%80%E7%9B%B8%E5%BA%94%E7%AB%AF%E5%8F%A3\&#34;&gt;æ‰“å¼€ç›¸åº”ç«¯å£&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A6%81%E7%94%A8swap\&#34;&gt;ç¦ç”¨swap&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85docker\&#34;&gt;å®‰è£…docker&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BAk8s%E6%96%87%E4%BB%B6%E5%A4%B9\&#34;&gt;åˆ›å»ºk8sæ–‡ä»¶å¤¹&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85kubeadm-kubelet%E5%92%8Ckubectl\&#34;&gt;å®‰è£…kubeadm, kubeletå’Œkubectl&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%9C%A8control-node%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%E4%B8%8A%E7%94%A8kubeadm%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4\&#34;&gt;åœ¨control nodeæ§åˆ¶èŠ‚ç‚¹ä¸Šç”¨kubeadmåˆ›å»ºé›†ç¾¤&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%9B%86%E7%BE%A4\&#34;&gt;åˆå§‹åŒ–é›†ç¾¤&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%B5%8B%E4%BA%88%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8kubectl%E7%9A%84%E6%9D%83%E9%99%90\&#34;&gt;èµ‹äºˆå½“å‰ç”¨æˆ·ä½¿ç”¨kubectlçš„æƒé™&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6flannel\&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85\&#34;&gt;å¼€å§‹å®‰è£…&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5%E9%83%A8%E7%BD%B2%E6%83%85%E5%86%B5\&#34;&gt;æ£€æŸ¥éƒ¨ç½²æƒ…å†µ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%89%93%E5%BC%80kubectl%E5%92%8Ckubeadm%E7%9A%84%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8%E5%8A%9F%E8%83%BD\&#34;&gt;æ‰“å¼€kubectlå’Œkubeadmçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#worker-node%E5%B7%A5%E4%BD%9C%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4\&#34;&gt;worker nodeå·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6flannel-2\&#34;&gt;å®‰è£…ç½‘ç»œç»„ä»¶flannel&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4\&#34;&gt;åŠ å…¥é›†ç¾¤&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%9F%A5%E9%83%A8%E7%BD%B2%E7%BB%93%E6%9E%9C\&#34;&gt;æ£€æŸ¥éƒ¨ç½²ç»“æœ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#troubleshooting\&#34;&gt;Troubleshooting&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#pull-image%E5%A4%B1%E8%B4%A5\&#34;&gt;pull imageå¤±è´¥&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;}]";
  // var json = escape.substr(1, escape.length - 2);
  // var datas = json.split(',');
  // for (let i=0; i < datas.length; i++) {
  //   let item = datas[i];
  //   let attrs = item.split('34;:&#34')
  //   debugger
  //   console.log(datas[i])
  // }
  let escapeMap = new Map();
  escapeMap.set('&#34;', '"');
  escapeMap.set('&gt;', '>');
  escapeMap.set('&#39;', "'");
  escapeMap.set('&lt;', '<');
  escapeMap.set('&quot;', '"');
  escapeMap.set('&amp;', '&');
</script> -->


</html>